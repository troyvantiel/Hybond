---------------------------------------------------------------------------
CHARMM22.0.b  Release           April     22, 1991
CHARMM22.0.b1 Release           September 30, 1991
CHARMM22      Release           January    1, 1992
     c22g1    Release           February  15, 1992
     c22g2    Release           July       7, 1992

CHARMM23.0
     c23a1    Developmental     August    15, 1992
     c23a2    Developmental     October   25, 1992
     c23f     Developmental     March      1, 1993
     c23f1    Developmental     March     15, 1993
     c23f2    Developmental     August    15, 1993
     c23f3    Release           February   1, 1994
     c23f4    Release           August    15, 1994
     c23f5    Release           March     15, 1995

CHARMM 24.0
     c24a1    Developmental     February  15, 1994
     c24x1    Evaluation        February  15, 1994
     c24a2    Developmental     August    15, 1994
     c24a3    Developmental     March     15, 1995
     c24b1    Release           August    15, 1995
     c24b2    Release           February  15, 1996
     c24g1    Release           August    15, 1996
     c24g2    Release           February  15, 1997

CHARMM 25.0
     c25a0    Developmental     August    15, 1995
     c25a1    Developmental     February  15, 1996
     c25a2    Developmental     August    15, 1996
     c25a3    Developmental     February  15, 1997
     c25b1    Release           August    15, 1997
     c25b2    Release           February  15, 1998

CHARMM 26.0
     c26a1    Developmental     August    15, 1997
     c26a2    Developmental     February  15, 1998
     c26b1    Release           September 30, 1998
     c26b2    Release           February  15, 1999

CHARMM 27.0
     c27a1    Developmental     September 30, 1998
     c27a2    Developmental     February  15, 1999
     c27b1    Release           August    15, 1999
     c27b2    Release           February  15, 2000
     c27b3    Release           August    15, 2000
     c27b4    Release           February  15, 2001

CHARMM 28.0
     c28a1    Developmental     August    15, 1999
     c28a2    Developmental     February  15, 2000
     c28a3    Developmental     August    15, 2000
     c28a4    Developmental     February  15, 2001
     c28b1    Release           August    15, 2001
     c28b2    Release           February  15, 2002

CHARMM 29.0
     c29a1    Developmental     August    15, 2001
     c29a2    Developmental     April     15, 2002
     c29b1    Release           August    15, 2002
     c29b2    Release           February  15, 2003

CHARMM 30.0
     c30a1    Developmental     August    15, 2002
     c30a2    Developmental     February  15, 2003
     c30a2x   Evaluation        February  15, 2003
     c30b1    Release           August    15, 2003
     c30b2    Release           February  15, 2004

CHARMM 31.0
     c31a1    Developmental     August    15, 2003
     c31a2    Developmental     February  15, 2004
     c31b1    Release           August    15, 2004
     c31b2    Release           February  15, 2005

CHARMM 32.0
     c32a1    Developmental     August    15, 2004
     c32a2    Developmental     February  15, 2005
     c32b1    Release           August    15, 2005
     c32b2    Release           February  15, 2006

CHARMM 33.0
     c33a1    Developmental     August    15, 2005
     c33a2    Developmental     February  15, 2006
     c33b1    Release           August    15, 2006
     c33b2    Release           February  15, 2007

CHARMM 34.0
     c34a1    Developmental     August    15, 2006
     c34a2    Developmental     February  15, 2007
     c34b1    Release           August    15, 2007
     c34b2    Release           February  15, 2008

CHARMM 35.0
     c35a1    Developmental     August    15, 2007
     c35a2    Developmental     February  15, 2008
     c35b1    Release           August    15, 2008
     c35b2    Release           February  15, 2009
     c35b3    Release           August    15, 2009
     c35b4    Release           February  15, 2010
     c35b5    Release           August    15, 2010
     c35b6    Release           February  15, 2011

CHARMM 36.0
     c36a1    Developmental     August    15, 2008
     c36a2    Developmental     February  15, 2009
     c36a3    Developmental     August    15, 2009
     c36a4    Developmental     February  15, 2010
     c36a4r1  Developmental     May        1, 2010
     c36a5    Developmental     August    15, 2010
     c36a6    Developmental     February  15, 2011
     c36b1    Release           August    15, 2011
     c36b2    Release           February  15, 2012
---------------------------------------------------------------------------

[0] About CHARMM36 Development

     At the July 2008 CHARMM meeting (Harvard University, July 11-12, 2008),
we decided to release CHARMM c35b1 with incorporating enhancements and fixes
to the developmental version c35a2. Some features stiil under testing will
not be included in the release: Dynamic Importance Sampling (DIMS), Generic
Parameter Optimization Module (FITPARAM) and Genetic Neural Network for QSPR
(GNN). The modified source code and features are described in ChangeLog.c35,
[3] c35b1 Change Log.

     As an on-going project, CHARMM development will be carried out
with CHARMM version 36a series.  The following describes new features
and enhancements incorporated in the c36 development period.

==============================================================================

[1] c36a1 Change Log

    The following are introduced and modified during the development period
of February 15, 2008 through August 15, 2008.  The developments are
based on CHARMM version c35a2.  Some enhancements and fixes to c35a2
are also incorporated into c35b1 as described in the c35b1 release note
(ChangeLog.c35).

1.1 Harvard University Developments
    Developers    : Robert Petrella
    Email Address : petrella@fas.harvard.edu
    Institution   : Harvard University
    Date          : June 25, 2008

1.1.1 Faster Image List Generation (MKIMAT2)

     Linear-scaling code to generate the image lists, based partially
on MKIMAT. Invoked on the command line with the IMFAst option of the update
command. IMFAST preprocessor keyword controls compilation.

Prefx Keys: IMFAST

Files Added:
source/ltm/image_ltm.src

Files Modified:
install.com
build/UNX/image.mk
doc/images.doc
source/fcm/actclus.fcm
source/fcm/image.fcm
source/gener/update.src
source/image/upimag.src
source/nbonds/nbutil.src

..............................................................................

1.1.2 Creation of "base module" directory (ltm).

     The ltm directory is intended as a repository of fortran modules
containing only global or "long-term-memory" arrays (allocatable or
non-allocatable) and global variables. The modules are not to contain
procedures (functions or subroutines) or variables/arrays that are local
to other modules, and they are not to have any dependencies.
Intent is organizational; to be compiled early.

Files Added:
build/UNX/ltm.mk

Files Modified:
build/UNX/objlibs.mk

------------------------------------------------------------------------------

1.2 MIT Developments
    Developer     : Victor Ovchinnikov, Bernhardt L. Trout, Martin Karplus
    Email Address : ovchinnv@MIT.edu
    Institution   : Massachusetts Institute of Technology
    Date          : June 28, 2008

1.2.1 Conformational consistency

     Current methods for generating transition paths between macromolecules
e.g., the TMD and TREK modules, rely on the Cartesian coordinates of a subset
of atoms in a protein. Although several residue types possess symmetry
(e.g. planar symmetry of a PHE ring), so that the conformation of such
a residue is invariant with respect to a rotation around the symmetry axis,
rendering certain groups of atoms effectively indistinguishable, topology
files must distinguish between these atoms (e.g. PHE CD1 vs. PHE CD2).
Given two different coordinate sets for a macromolecule, any two-set path
generation method that makes use of the Cartesian coordinates of atoms that
belong to residues with symmetry decides arbitrarily the correspondence
between the `indistinguishable' atoms. For example, performing TMD using
coordinates of the ring atoms of a PHE, will force the position of atom CD1
in the initial set to move to the position of atom CD1 in the target set,
although the movement from CD1 to CD2 is also possible. In such transitions,
it is likely that there exist a path with a high energy barrier (e.g. flipping
of a PHE ring in a tightly-packed protein interior) that can be avoided by
making use of symmetry. The current method, CONFormational consistency, is an
algorithm for renaming certain atoms to minimize rotation and flipping of
the involved residues during path generation.

Files Added:
source/manip/confcons.src
test/c36test/confcons.inp

Files Modified:
doc/corman.src
build/UNX/manip.mk

..............................................................................

1.2.2 Interpolated path generation

     Generate a path between two coordinate sets contained in the main and
comparison coordinates by interpolation. Only linear inrepolation is currently
implemented. The resulting initial path may be used for subsequent path
refinement procedures, such as NEB or TREK.

Files Added:
source/manip/interp_path.src

Files Modified:
build/UNX/manip.mk
doc/corman.src

..............................................................................

1.2.3 Zero-temperature string method

     The temperature string method allows the the calculation of minimum
energy paths (MEP) between two conformations of a molecule. The method is
described in

[1] E, W., Ren, W. & Vanden-Eijnden, E. "Simplified and improved string
method for computing the minimum energy paths in barrier-crossing events."
J. Chem. Phys. (2007) 126, 164103-8

Prefx Keys: STRINGM

Files Added:
doc/stringm.doc
source/stringm/reparam.src
source/stringm/splines.src
source/stringm/stats.src
source/stringm/string.src
source/stringm/stringm.src
test/c36test/zts_ens.inp

Files Modified:
install.com
build/UNX/minmiz.mk
build/UNX/objlibs.mk
doc/ensemble.doc
source/fcm/ensemble.fcm
source/io/mainio.src
source/io/coorio.src
source/minmiz/steepd.src
source/util/title.src

------------------------------------------------------------------------------

1.3 Enhancement for SQUANTM combined QM/MM module
    Developer     : Kwangho Nam and Jiali Gao
    Email Address : nam@tammy.harvard.edu; gao@chem.umn.edu
    Institution   : Harvard University and University of Minnesota
    Date          : June 25, 2008

1.3.1 Free energy perturbation implementation for pKa calculation
     The SQUANTM semiempirical QM/MM module is extended to perform FEP
calculations, in which one application is to compute the pKa value. 
The current implementation is that the hybrid Hamiltonian is as 
described in pdetail.doc with two Hamiltonians for the reactant and
product states, respectively, and that the reactant state is always 
the protonated species and the product state is the deprotonated 
species.

1.3.2 Combined use of ab initio QM/MM and semiempirical QM/MM potentials
     A so-called multi-layered QM/MM potential is implemented. The basic
idea is similar to the electronically embedded ONIOM type potential. It 
computes a QM/MM energy for a large QM region at the semiempirical QM/MM
level, and QM/MM energies for a smaller QM region at the ab initio and
semiempirical QM/MM levels. The difference from the two calculations for
smaller QM/MM region is added to the first QM/MM energy for larger QM
region as a correction for the total energy. The current implementation
is limited to use GAMESS-UK and SQUANTM.

1.3.3 DIIS implementation
     In order to improve the SCF convergency, DIIS converger is 
implemented, which can be turned off (see qmmm.doc) for the backward
compatibility.


Files Added:
source/squantm/sqnt_mlayer.src
source/squantm/sqnt_pka_fep.src
test/cquantumtest/but4_squantm_pka.inp
test/cquantumtest/lys_mlayer_guk.inp
test/cquantumtest/qmmm_ewald_squantm_pka.inp
test/data/input_lys.guk

Files Modified:
install.com
build/UNX/squantm.mk
doc/qmmm.doc
source/charmm/iniall.src
source/dynamc/dynamc.src
source/dynamc/dynamvv.src
source/dynamc/tmd.src
source/energy/energy.src
source/energy/eutil.src
source/fcm/gamess.fcm
source/fcm/mndo97.fcm
source/fcm/squantm.fcm
source/flucq/flucq.src
source/gener/update.src
source/gukint/gukini.src
source/mc/mvcrot.src
source/mndint/mndewald.src
source/nbonds/ewaldf.src
source/nbonds/nbonds.src
source/nbonds/pme.src
source/pert/epert.src
source/quantum/qmnbnd.src
source/quantum/qub.src
source/squantm/sqnt_ene.src
source/squantm/sqnt_mlayer.src
source/squantm/sqnt_nbnd.src
source/squantm/sqnt_pka_fep.src
source/squantm/sqnt_qm2_energy.src
source/squantm/sqnt_qm2_ewald.src
source/squantm/sqnt_qm2_gho.src
source/squantm/sqnt_qm2_grad.src
source/squantm/sqnt_qm2_mopac.src
source/squantm/sqnt_qmmm_int.src
source/squantm/sqnt_qmmm_module.src
source/squantm/sqnt_qmmm_util.src
source/squantm/sqnt_setup.src

------------------------------------------------------------------------------

1.4 Developments at the National Institute of Health
    Institution   : Laboratory of Computational Biology, NHLBI, NIH
    Date          : July 1, 2008

1.4.1 Classical and QM/MM Mobile Block Hessian and MSCAle 2nd derivatives
    Developer     : H. Lee Woodcock III, Yihan Shao, An Ghysels, Bernard Brooks
    Email Address : hlwood@nih.gov, yihan.shao@gmail.com, An.Ghysels@ugent.be,
                    brb@nih.gov

     Added Classical and QM/MM Mobile Block Hessian (i.e. MBH).
Added normal mode support to the MSCAle command. This works with classical
and both ab initio and semi-empirical QM/MM using both analytic and finite
difference second derivatives

minor fix to the printing of off-path simulation results (epath.src) 

Prefx Keys: MSCALE, RPATH 

Files Added:
source/vibran/mbh.src

Files Modified:
doc/minimiz.doc
doc/mscale.doc
doc/vibran.doc
source/fcm/gamess.fcm
source/dynamc/lonepair.src
source/energy/energy.src
source/energy/epath.src
source/gukint/gukini.src
source/pert/epert.src
source/vibran/vibblock.src
source/vibran/vibran.src
source/build/UNX/vibran.mk
source/mscale/mscale.src
test/c35test/vsa_butane.inp

New/Modified Testcase:
test/c36test/mbh.inp
test/c36test/mbh_partial_opt.inp
test/c36test/vibran_mscale.inp
test/c36test/vsys1.inp
test/c36test/vsys2.inp

..............................................................................

1.4.2 Enhancements and documentation update
    Developer     : Rick Venable
    Email Address : venabler@nhlbi.nih.gov

(1) Pressure tensor data ouptut
     In order to capture the pressure tensor data on every integration step
without being overwhelmed by additional data from setting NPRINT 1, the
IUPTEN option was added to the pressure related parsing (prssre.src).
The default is to do nothing unless a positive integer is specified for
this Fortran unit number.  Calls to PSCALE() were modified to add the
integration step, so that the time values could be written properly.

Files Modified:
doc/pressure.doc
source/charmm/iniall.src
source/dynamc/prssre.src
source/dynamc/dynamc4.src,
source/dynamc/dynamc.src
source/fcm/reawri.fcm
c24test/nptdyn.inp

(3) crystl.doc update
    Updated the information on using image patches with CRYSTAL. Added a
section describing the use of P21 symmetry for interfacial systems, with
some input examples for the coordinate placement, the symmetry change,
and the needed minimization.

Files modified:
doc/crystl.doc


(2) Split trajectory into subsets
      Up to 64 subsets may be created from input trajectory files, using a list
which identifies the subset number for each frame in the input trajectory.
The membership list format is that produced by the CLUSTER command of
CORREL, specified by the UNIMember keyword of CLUSTER. Any means may be
used to produce the file, as long as it conforms to that format.  The time
base is ignored when writing the subsets, and each is renumbered as a
sequential series from 1 to N, where N is the number of frames in the subset.

Files Modified:
doc/dynamc.doc
source/dynamc/dynsub.src
test/c35test/mrgsubset.inp

..............................................................................

1.4.3 Bugfix for b-spline correction in IPS calculation
    Developer     :  Xiongwu Wu and Bernard Brooks
    Email Address :  wuxw@nhlbi.nih.gov

      The correction to b-spline spreading of atoms is missing, which causes
errors in IPS energy, force and viral calculation.

Files involved:
doc/nbonds.doc              Changes in IPS description
source/energy/energy.src    Removed NTRANS from AIPS routine argument.
source/fcm/nbips.fcm        Added boundary energy variables
source/nbonds/enbips.src    B-spline correction is added

------------------------------------------------------------------------------

1.5 University of Michigan Developments
    Developer     : Jana Khandogin, Charlie Brooks
    Email Address : jana.khandogin@ou.edu, brookscl@umich.edu
    Institution   : U. Oklahoma, U. Michigan
    Date          : June 30, 2008

1.5.1 Small additions and corrections for pHMD w/ periodic images

Prefx Keys: PHMD

Files Modified:
source/energy/phmd.src

..............................................................................

1.5.2 Additions to tamd to permit multiple roots for TAMD
    Developer     : Jianhan Chen, Charlie Brooks
    Email Address : jianhanc@ksu.edu, brookscl@umich.edu
    Institution   : KSU, U. Michigan

     Changes were made to enable the use of multiple root points in setting
up and running torsion angle molecular dynamics.

Prefx Keys: TAMD

Files Modified:
doc/tamd.doc
source/dynamc/tamd.src

..............................................................................

1.5.3 Fixes and enhancements
    Developer     : Mike Crowley, Charlie Brooks
    Email Address : michael_crowley@nrel.gov, brookscl@umich.edu
    Institution   : NREL, U. Michigan

     Fixes for itanium clusters, em64t, osx, ##IF problems, obsolete fortran,
and column fft codes.

     - Fixed MPI communications and pref flags for
     - itanium cluster parallel builds
     - obsolete flags removed for osx and em64t
     - testing parallel with machinefile added
     - TESTENDIAN trajectory reading fixed for trajectories with fixed atoms
     - Faster direct space fixed (FEWMFC), mkl added
     - Code cleanup in pme, bugfix column fft, workaround for bug in intel
       compiler affecting fft
     - Code constructs that have been deleted from fortran standard, and are
       not in intel fortran anymore are replaced with working code.

Prefx Keys: FEWMFC, COLFFT, INTELMKL

Files Modified:
install.com
build/UNX/Makefile_itanium
build/UNX/Makefile_em64t
build/UNX/Makefile_osx
build/UNX/dynamc.mk
source/adumb/umb.src
source/dynamc/dynamc.src
source/dynamc/dynio.src
source/energy/energy.src
source/energy/eintern.src
source/fcm/emap.fcm
source/fcm/blockappend.fcm
source/io/rtfio.src
source/machdep/machutil.src
source/manip/corman2.src
source/misc/gnn.src
source/misc/grid.src
source/misc/gsbp.src
source/misc/gsbp2.src
source/misc/pbeq.src
source/misc/pbeq2.src
source/nbonds/enbond.src
source/nbonds/ewald.src
source/nbonds/nbonds.src
source/nbonds/pme.src
source/nbonds/pme_column_fft.src
source/nbonds/pmeutil.src
source/util/new_timer.src
test/test.com  

------------------------------------------------------------------------------

1.6 Developments at NIC-Slovenia
    Names         : Milan Hodoscek
    Email Address : milan@cmm.ki.si
    Institutions  : National Institutes of Chemistry, Ljubljana, Slovenia
                    and National Institute of Health, Bethesda, MD, USA
    Date          : June 30, 2008

1.6.1 ETRAJ as a preparation for the CSA module

     New CSA module is being introduceds in the CHARMM. The CSA module
itself is not ready for submission yet, but the infrastructure for its
implementation and some other useful functionality is already
finished. ETRAJ command is one of them and it parallelizes reading of
the coordinate sets from the trajectory file and allows to perform any
CHARMM script on individual sets independently. The parallelization is
non-blocking and each of the individual scripts may run in parallel
(Parallel/parallel: similar to QM/MM RPATH calculations) The module is
controlled by #CSA and/or #DISTENE (for ETRAJ) pref.dat keywords.

Files Added:
doc/csa.doc
source/csa/csacntrl.src
source/csa/csacomm.src
test/c36test/csatest.inp
test/c36test/csamin.inp

Files Modified:
build/UNX/objlibs.mk
source/charmm/charmm_main.src

.............................................................................

1.6.2 Conversion of ABNR module to the new fortran

     Converted abner.src into the new fortran's module and getting rid
of all the heap and stack usage in abner.src including partial remove
of heap/stack in the dependencies files defining and using the
modified variables. Along with this the major part was converting
FLUCQ, which is almost completely converted to the new fortran, too.

Files Modified:
build/UNX/dynamc.mk
source/charmm/charmm_main.src
source/correl/anacor.src
source/correl/ancsol.src
source/correl/rdfsol.src
source/dynamc/dcntrl.src
source/energy/energy.src
source/energy/intere.src
source/fcm/flucq.fcm
source/flucq/flucq.src
source/flucq/fluqdyn.src
source/flucq/fluqene.src
source/flucq/fluqqmmm.src
source/image/upimag.src
source/image/xtlfrq.src
source/io/trajio.src
source/manip/scalar.src
source/mbond/mbdiag.src
source/mc/mcimge.src
source/minmiz/abner.src
source/minmiz/conjug.src
source/minmiz/egrad1.src
source/minmiz/minmiz.src
source/minmiz/nraph.src
source/minmiz/powell.src
source/minmiz/steepd.src
source/minmiz/tndriv.src
source/misc/distrib.src
source/misc/genetic.src
source/misc/grid.src
source/misc/hbuild.src
source/nbonds/cheqmodule.src
source/nbonds/nbonds.src
source/pert/epert.src
source/pert/icfcnf.src
source/pert/icpert.src
source/pert/tsme.src
source/quantum/qmevdw.src
source/util/selcta.src
source/vibran/vibcom.src

.............................................................................

1.6.3 REPDSTR enhancements

     Some fixes for distributed replica functionality and added
support for the Off Path Simulation method:

Files Modified:
source/charmm/miscom.src
source/energy/energy.src
source/energy/epath.src
source/gener/repdstr.src
source/minmiz/abner.src

.............................................................................

1.6.4 pref.dat and other fixes 

     Some fixes for ##IF statement and other problems:

Files Modified:
install.com
source/mscale/mscale.src
source/nbonds/enbips.src
source/nbonds/nbutil.src
source/nbonds/pmeutil.src

.............................................................................

1.6.5 GAMESS/CHARMM QM/MM interface: support for the latest GAMESS

     Support for latest version of GAMESS (11 Apr 2008 R1) released on
April 21, 2008 was added to CHARMM. New development in this version
includes: new grid code for DFT calculations (the default has changed
- so are the results if compared with older version). Popular SG1 was
added. 

Files Modified:
build/UNX/gmscomp
doc/gamess.doc

------------------------------------------------------------------------------

1.7 Michigan State University Developments
    Developer     : Sean Law, Srinivasa Murthy Gopal/Michael Feig
    Email Address : feig@msu.edu
    Institution   : Michigan State University
    Date          : June 28, 2008

1.7.1 1D and 2D PMF-based potentials 

    A series of PMF-based potentials is introduced to faciliate the
development of coarse-grained models. The potentials consist of three
different modes: 1D distance, 2D angle, and 2D hydrogen-bonding term. 

Prefx Keys: EPMF

Files Added:
doc/epmf.doc
source/energy/epmfmodule.src
test/c36test/epmf.inp
test/data/epmf1d.dat
test/data/epmf2d.dat

Files Modified:
install.com
build/UNX/energy.mk
source/charmm/charmm_main.src
source/energy/eutil.src
source/energy/energy.src
source/energy/ecnstr.src
source/energy/printe.src
source/energy/ecmap.src
source/fcm/energy.fcm

..............................................................................

1.7.2 Variable distance center of mass restraint

     An option was added to the HMCM module to allow a restraint with an 
arbitary distance between the reference center of mass and actual center
of mass (rather than the default zero distance).

Prefx Keys: part of HMCM 

Files Modified:
doc/cons.doc
source/energy/energy.src
source/energy/ecnstr.src
source/fcm/cnst.fcm
source/manip/cstran.src
source/pert/epert.src

..............................................................................

1.7.3 3D path-based restraint

     A biasing potential that restraints the projection of selected 
centers of mass along a spline-interpolated, three-dimensional path.
This potential is especially useful for DNA translocation.

Prefx Keys: CPATH

Files Added:
test/c36test/conspath.inp
test/data/nt4.pdb
test/data/splinepts.inp

Files Modified:
install.com
doc/cons.doc
source/charmm/iniall.src
source/energy/eutil.src
source/energy/energy.src
source/energy/ecnstr.src
source/energy/printe.src
source/fcm/cnst.fcm
source/fcm/energy.fcm
source/fcm/dimens.fcm
source/manip/cstran.src

..............................................................................

1.7.4 GBMV and HDGB improvements

     The possibility to define atom-specific surface tension coefficients akin
to an ASP term is introduced into GBMV. The previously fixed functional form
for the non-polar profile in the HDGB model is extended to allow an arbitrary,
spline-interpolated profile based on input from an external file. In addition,
there are a few very minor changes and fixes.

Prefx Keys: GBMV

Files Modified:
doc/gbmv.doc
source/energy/gbmvmodule.src

..............................................................................

1.7.5 Miscellaneous changes and fixes

     A number of small changes are summarized here:

- changed optimization level and modified CMAP code to avoid numerical errors 
  on 64-bit Intel architecture.
- fixed name conflict in VIBBLOCK module (pythag subroutine)
- allow extended PSF format for XPLOR format (needed for NAMD interaction)

Files Modified:
build/UNX/energy.mk
build/UNX/Makefile_em64t
source/energy/ecmap.src
source/io/psfres.src
source/vibran/vibblock.src

------------------------------------------------------------------------------

1.8 HYBH: HYBrid Hamiltonian module
    Developer     : Arnaud BLONDEL
    Email Address : ablondel@pasteur.fr
    Institution   : Institut Pasteur (Paris, France)
    Date          : June 30, 2008

     Implementation of the truncation scheme described in "Ensemble Variance
in Free Energy Calculations by Thermodynamic Integration: Theory, Optimal
"Alchemical" Path, and Practical Solutions", A.Blondel (2004) J.Comp.Chem 25,
985-993. Details on the method should be sought therein. In brief, the
implementation is based on dual topology (although single topology
could be used under some conditions), the bonded terms (bond, angle
and Urey-Bradly) are kept unchanged, dihedral and impropers are
modified according to simple quadratic scheme (w_product=(3.l+1).l/4),
and electrostatic and van der Waals are treated together with a
truncation scheme reminiscent of soft-core vdw to minimize the
numerical fluctuations of the integrant (hence Optimal "Alchemical"
Path). Ewald sums and correction terms associated appeared soft
enough to be treated according to linear scaling of the charges,
allowing direct analytical calculation of dEwald/dl. A benefit of the
method, in addition to the fact that the integrant has limited
numerical fluctuations, is that it also produce a linear evolution of
the integrant along lambda (or l) in regular cases.

     The implementation attempts to supports most of non-bonds, image
and Ewald sums options and warnings are made. Slow routines are not
currently supported. However, it is advised to test the results when
new combination of options are used. CMAP is not currently supported.

     No analysis routine is currently supplied as careful convergence
analysis should be undertaken. It is advised that additions of the
terms be made at least in real*8 format as truncation errors might
be significant otherwise.

Prefx Keys: BLOCK

Files Added:
source/fcm/trunk.fcm
test/c36test/block_hybh.inp
test/c36test/block_hybh_ew.inp

Files Modified:
doc/block.doc
source/charmm/iniall.src
source/dynamc/dynamc4.src
source/dynamc/dynamc.src
source/dynamc/dynamcv.src
source/dynamc/dynamvv.src
source/dynamc/dynamvv2.src
source/dynamc/dynamln.src
source/energy/energy.src
source/energy/enefscal.src
source/energy/eintern.src : Ref. added for ephi.
source/fcm/block.fcm
source/fcm/energy.fcm
source/image/eimage.src
source/mc/mvcrot.src      : Fix - CROSS renamed VPROD (vectorial product)
source/nbonds/enbfast.src
source/nbonds/enbond.src
source/nbonds/ewald.src
source/nbonds/enbaexp.src
source/nbonds/nbonds.src
source/nbonds/pme.src
source/pert/block.src

------------------------------------------------------------------------------

1.9 Arizona State University Developments
    Developer     : Hiqmet Kamberaj and Arjan van der Vaart
    Email Address : hkamberaj@asu.edu and vandervaart@asu.edu
    Institution   : Arizona State University
    Date          : June 27, 2008

1.9.1 Replica Exchange Using Tsallis Statistics

     Molecular dynamics using Tsallis scaling of the CMAP and Dihedral
potential terms can now be performed. This method is implemented for all
integrators (dynamc.src). The method for Tsallis scaling of the CMAP and
Dihedral potential terms is invoked by adding to the DYNAmics command the
keywords: TTSALlis QTSAllis real EMIN real, where QTSAllis is the Tsallis
q and EMIN is the estimated minimum energy of the CMAP + Dihedral terms,
having similar meaning as for TSALLIS.  The default value of QTSAllis is 1,
in which case the method reduces to standard dynamics (no scaling). Values
of q larger than 1 effectively correspond to a smoothed potential in which
the positions of the extrema are preserved. Estimates for EMIN should be
lower than any possible energy of the CMAP+Dihedral potential terms
encountered during the simulation.

     It is important to note that the scale factor for the forces involves
a temperature. The temperature employed in the Tsallis transformation
corresponds to the one used to assign the velocities during heating and
equilibration (TSTRUC initially and then FIRSTT + int*TEMINC). Thus, it is
important to set FIRSTT, FINALT and TEMINC appropriately even if one is
running Langevin dynamics at temperature TBATh (i.e., for equilibrium
dynamics, set FIRSTT = FINALT = TBATh). Furthermore, simple scaling of the
CMAP and Dihedral potential terms can also be performed by adding to the
DYNAmics command the keywords: POTSaling TSALpha, where TSALpha is the
scaling factor of the  CMAP + Dihedral terms. The default value of TSALpha
is 1, in which case the method reduces to standard dynamics (no scaling).
Values of Alpha smaller than 1 correspond to a smoothed potential.  

Reference: H. Kamberaj and A. van der Vaart (2007) Multiple Scaling Replica
Exchange for the Conformational Sampling of Biomolecules in Explicit Water.
J. Chem. Phys., 127, 234102-7.

     BLOCK was modified so that it works with the Ewald (simple and PME)
method of CHARMM. The Syntax and Function of BLOCK module are unchanged. 

Files Added:
source/energy/tsallismodule.src
test/c36test/pme_block.inp
test/c36test/tsallis.inp

Files Modified:
doc/block.doc.
doc/dynamc.doc
build/UNX/charmm.mk
build/UNX/energy.mk
source/charmm/charmm_main.src
source/dynamc/dcntrl.src
source/energy/ecmap.src
source/energy/ecntrl.src
source/energy/enefscal.src
source/energy/energy.src
source/energy/printe.src
source/nbonds/pme.src
source/nbonds/nbonds.src
source/nbonds/ewald.src
source/nbonds/enbaexp.src

..............................................................................

1.9.2 Simple Ewald method for any simulation box shape.

     Simple Ewald method is modified to run for every simulation box shape.
In additional, BLOCK was modified so that it works with the Simple Ewald 
method of CHARMM. The Syntax and Function of BLOCK module are unchanged. 

Files Modified:
doc/nbonds.doc
source/nbonds/ewaldf.src

------------------------------------------------------------------------------

1.10 RCONS Improvements
    Developer     : Jhih-Wei Chu
    Email Address : jwchu@berkeley.edu
    Institution   : UC Berkeley
    Date          : June 29, 2008

     The efficiency and robustness of the algorithm for maintaining
equal-distance constraints are improved significantly. New restraint
potentials are added in epath to help cotrolling path smoothness and
obtain minimium Hamiltonian path

Prefx Keys: RXNCONS

Files Modified:
doc/replica.doc
source/energy/epath.src
source/dynamc/dynamc.src
source/fcm/path.fcm
source/fcm/rxncons.fcm
source/fcm/rxnconswt.fcm
source/fcm/rxncons4.fcm
source/manip/holonom.src
source/manip/rxcons.src
source/manip/rxcons_3.src
source/manip/rxcons_4.src
source/manip/scalar.src
test/c35test/rxncons_rpath.inp

------------------------------------------------------------------------------

1.11 Karolinska Institute Fixes and Enhancements
    Developer     : Lennart Nilsson
    Email Address : Lennart.Nilsson@biosci.ki.se
    Institution   : Karolinska Institute
    Date          : June 28, 2008

     Added -1 warning if ISEED is specified at a langevin dynamics restart.
Fixed problems with PDB format introduced in c35a2, both for coordinates and
sequences.

Files Modified:
doc/io.doc
source/dynamc/dcntrl.src
source/io/coorio.src
source/io/mainio.src
source/io/psfres.src

------------------------------------------------------------------------------

1.12 University of Chicago Developments
    Developer     : Haibo Yu, Yuqing Deng, Wei Jiang, Benoit Roux
    Email Address : haibo@uchicago.edu, deng@mcs.anl.gov, wjiang@mcs.anl.gov,
                    roux@uchicago.edu
    Institutions  : University of Chicago, Argonne National Lab
    Date          : June 30, 2008

1.12.1 New Format for PSF of Drude Mode

    XPLOr format for PSF of Drude mode is extended to include the Thole 
and polarizability for each particle. In the new format, the 
anisotropic information for the lone-pairs of Drude model is shown 
along with the lone-pair information. This new format is intended to 
provide a PSF of Drude mode for developing NAMD package.
    The parmfile read-in subroutine has been modified to allow ATOM
NAMES longer than 4 characters in NBFIX section (i.e. for DRUDe atoms).
    
Files Modified:
source/fcm/dimens.fcm
source/io/psfres.src
source/io/parmio.src
               
..............................................................................

1.12.2 Various updates and enhancement 

    Problems with SSBP parallel running are fixed.
    Fixed a bug in when CAVIty potential is activated in GSBP, and GCMC 
simulations are performed. The cavity potential does not go to properly 
zero for GCMC solvent molecules inside the sphere for cavity radius 
larger than 18 angstroms.  This only affects GCMC simulations with GSBP 
CAVIty potential activated. 
    Fixed a bug when the EMPI empirical corrections are activated in a
deformable boundary.

Files Modified:
source/misc/gsbp.src 
source/misc/ssbp.src

------------------------------------------------------------------------------

1.13 University of Maryland Developments
    Developer     : Olgun Guvench, Kenno Vanommeslaeghe and Alex MacKerell
    Email Address : alex@outerbanks.umaryland.edu
    Institution   : University of Maryland, Baltimore
    Date          : June 30, 2008

1.13.1 Document updates

     Lone pairs with undefined coordinates can be built by COOR SHAKE.
Wrong definition of impropers can have problematic results. Clarified this
in the documentation. Also included a warning pertaining the phase of ordinary
dihedrals.

Files involved:
doc/corman.doc
doc/lonepair.doc
doc/parmfile.doc
doc/rtop.doc

..............................................................................

1.13.2 CHARMM General Force field.

     The new CHARMM General Force Field, developed in the MacKerell lab and
ready to be published, overflows hard-coded array sizes for dihedrals and
residues. A new preflx keyword, CGENFF, was introduced to request larger
arrays at compile time. As the change has little effect on CHARMM's memory
footprint, install.com was modified to include the CGENFF keyword by default.
All this is consistent with previous additions of "large" force fields
(eg. MMFF). The CGENFF keyword was also added to preflx_list.doc.

Prefx Keys: CGENFF

Files Added:
test/c35test/cgenff.inp
test/data/top_cgenff_all_1g5merge.inp
test/data/par_cgenff_all_1g5merge.inp

Files Modified:
install.com
doc/preflx_list.doc
source/fcm/dimens.fcm

..............................................................................

1.13.3 Added substitution parameters for ring pucker calculation

     Added substitution parameters for ring pucker calculation in corman.src.

Files Modified:
doc/subst.doc
source/manip/corman.src

..............................................................................

1.13.4 toppar Updates

     Inclusion of initial release of the CHARMM general force field in
the toppar directory. CHARMM general force field has been designed to
treat a range ofpharmacological compounds.  The parmaeters have been
optimized to be consistent with the CHARMM all-atom additive force
fields.

Removed:
toppar/par_all34_ethers.prm
toppar/par_all35_sugar.prm
toppar/top_all34_ethers.rtf
toppar/top_all35_sugar.rtf

Files Added:
toppar/par_all32_lipid.prm
toppar/par_all35_carb.prm
toppar/par_all35_ethers.prm
toppar/par_all36_cgenff.prm
toppar/top_all32_lipid.rtf
toppar/top_all35_carb.rtf
toppar/top_all35_ethers.rtf
toppar/top_all36_cgenff.rtf

Updates:
toppar/drude.tar.gz
toppar/silicates.tar.gz
toppar/toppar_history.tar.gz

Files Modified:
toppar/non_charmm/00readme
toppar/par_all27_lipid.prm
toppar/par_all27_na_lipid.prm
toppar/par_all27_prot_lipid.prm
toppar/par_all27_prot_na.prm
toppar/stream/toppar_all27_na_model.str
toppar/top_all27_lipid.rtf
toppar/top_all27_na_lipid.rtf
toppar/top_all27_prot_lipid.rtf
toppar/toppar_all.history

------------------------------------------------------------------------------

1.14 Multiple Energy Evaluation
   Developer     : Bruce Tidor
   Email Address : tidor@mit.edu
   Institution   : Massachusetts Institute of Technology
   Date          : July 31st, 2008

     The MuLTE command rapidly computes energetics between alternative
conformations of side chain pairs. Cartesian coordinates for a collection
of coordinates for two sets of atoms are stored in "write coor dumb" format
in files read on input. The energy for all conformational pairings are
computed and printed to a specified file.  

Files Added:
source/energy/multe.src
test/c36test/multe.inp

Files Modified:
build/UNX/energy.mk
doc/energy.doc
source/charmm/charmm_main.src
source/energy/intere.src
source/misc/grid.src
source/util/chutil.src

------------------------------------------------------------------------------

1.15 Random Number Generator
    Developer     : Youngdo Won
    Email Address : won@hanyang.ac.kr and won@helix.nih.gov
    Date          : August 6, 2008

     As some simulations expand over several nano seconds, recurrence of
random numbers could be a problem. We addressed this with a "new" random
number generator in the version c28a4 (February 15, 2001): the Combined
Linear Congruential Generator (CLCG). It was parallelized in c32a1 (2004).
Problems involved with it were fixed in c33a1 (2005). The CLCG random number
has been default for the special versions compiled with the ##NEWRNG
key. The CLCG code is now default and ##NEWRNG encapsulation is removed.
For testing or checking previous trajectories, the "old" random number 
generator, REAL* FUNCTION OLDRANDOM(ISEED), is available as a run time option.
In order to switch the "old" random number generator, the miscellaneous
RANDom command is modified to include,

     RANDom [OLDRandom ]
            [CLCG      ]

Files Modified:
install.com
doc/miscom.doc
source/charmm/iniall.src
source/correl/solana.src
source/dynamc/dcntrl.src
source/dynamc/dims.src
source/dynamc/dynamc.src
source/dynamc/dynio.src
source/dynamc/dynlng.src
source/dynamc/dynutil.src
source/fcm/exfunc.fcm
source/fcm/rndnum.fcm
source/manip/intcor.src
source/mc/mc.src
source/misc/genetic.src
source/misc/pbeq.src
source/util/clcg.src
source/util/random.src
source/vibran/vibran.src

------------------------------------------------------------------------------

1.16 Bugfixes and Enhancements

1.16.1 VMOD fixes
    Developer        : Charles Robert (& David Perahia)
    Email Address    : charles.robert@u-psud.fr
    Institution      : CNRS - France
    Date             : May 19, 2008

     In the previous version VMOD used its own normal-mode file-reading
routine that was incomplete. Several new features have been added as well.

     VMOD obtains the restraint direction(s) from a normal-mode format file.
In the initial version, an over-simplified approach was used to read the
file. To resolve this and potentially other future problems, VMOD now re-uses
existing code from VIBRAN for reading the normal-mode file. This provides
the advantage of guaranteeing VMOD/VIBRAN coherence in the future.

Files involved:
doc/mmfp.doc
source/energy/energy.src
source/fcm/mmfp.fcm
source/misc/mmfp.src
source/vibran/vibio.src
test/c34test/vmodwat.inp

..............................................................................

1.16.2 VIBRAN READ NORM 
    Developer        : Charles Robert (& David Perahia)
    Email Address    : charles.robert@u-psud.fr
    Institution      : CNRS - France
    Date             : May 19, 2008

     In VIBRAN, one should be able to read normal modes from either a binary
or card-formatted normal modes file. Further, the READ NORM command allows
one to specify which modes are to be read from the file, e.g., mode 7 from
a file with 20 modes. Call this reading from the "middle" of the file.
There are no problems when all modes are read at once for either binary or
card-formatted files. Also, a single mode can be read from the middle of a
binary file without any problem. But for reading one or more modes from the
middle of a card formatted file, the wrong values are obtained.

Files involved:
source/vibran/vibio.src

..............................................................................

1.16.3 Bug fixed in FACTS image interaction list setup
    Developer     : Francois Marchand and Amedeo Caflisch
    Email Address : caflisch@bioc.uzh.ch
    Institution   : Department of Biochemistry, University of Zurich
    Date          : June 30, 2008

     FACTS builds lists for the atom-atom and atom-image atom interactions.
The size of the image atom array (equivalent to NATIM) was set to be
twice the number of atoms present in the system. It appeared that 
the actual number of image atoms can be bigger than that, what leads
to crashes under certain system configurations.The size of this array
was set to 26*NATOM instead of 2*NATOM.

Files involved:
doc/facts.doc
source/image/images.src
source/misc/fctall.src

..............................................................................

1.16.4 DIMS one-line bugfix
    Developers    : Juan R. Perilla, Oliver Beckstein, Anu Nagarajan,
                    Jennifer Johnston, Elizabeth Denning, Tom Woolf
    Email Address : jrperillaj@jhu.edu, orbeckst@jhmi.edu, anu@jhu.edu,
                    jen.johnston@jhmi.edu, edennin3@jhu.edu, twoolf@jhmi.edu
    Institution   : Johns Hopkins University, School of Medicine
    Date          : June 30, 2008

     ntres=ntres+1 added.

Files involved:
source/dynamc/dims.src

..............................................................................

1.16.5 CORSOL f95 compilation
    Developer     : Tibor Rudas and Stefan Boresch
    Email Address : tibor.rudas@univie.ac.at, stefan@mdy.univie.ac.at
    Institution   : University Vienna
    Date          : Jun 28th 2008

     Compilation of CHARMM failed when the CORSOL keyword was present
in pref.dat for several reasons: (i) Change of the CHEQ functionality
to Fortran95 required the additon of 'use cheq...'.
(ii) During the Fortran95 migration, an assigned goto was handled
incorrectly. By mimicking what was done in correl.src the problem could
be avoided

Files involved:
source/correl/corsol.src
source/correl/ancsol.src

..............................................................................

1.16.6 RMD documentation update
    Developer     : Stephan Lutz
    Email Address : stephan.lutz@unibas.ch
    Institution   : University of Basel, Switzerland
    Date          : 06/30/2008

     Some remarks added to the RMD documentation (cross.doc) concerning
the configuration of the supplied PSF when using the RXMD command.

Files Modified:
doc/cross.doc

..............................................................................

1.16.7 PNM gradient calculation
    Developer     : Jingzhi Pu
    Email Address : pu@tammy.harvard.edu
    Institution   : Harvard University
    Date          : july 15, 2008

     Introduced into CHARMM since c35a1, the PNM code was adopted from
a preliminary code as a part of the USER command. Since the energy routine
for USER energy (subroutine USERE) was called at the very beginning of all
energy components, the PNM gradients were directly assigned to their global 
arrays (DX,DY,DZ). However, PNM gradients should be incorporated
accumulatively. The bug actualy does not affact the results for most of
the calculations, except for a few rare cases, for example, when the 
USER or RXMD command is used in combination with the PNMI command. 

Files involved:
source/misc/pnm.src

..............................................................................

1.16.8 GHO atom parameters for GHO-MNDO/d
    Developer     : Jingzhi Pu
    Email Address : pu@tammy.harvard.edu
    Institution   : Harvard University
    Date          : july 15, 2008

     A bug is found in source/mndint/mndo97q/97/PARAMD.f. The GHO atoms in 
the CHARMM/MNDO97 interface are conviniently defined as an element
with atom number 85. Paramters for GHO are therefore adopted from 
carbon by mapping parameters of the element 85 to those of the element 6. 
However, for the MNDO/d Hamiltonian, due to the structure of the code, 
at some point, following 'DO 50 I=11,LMD' in the subroutine PARAMD of 
source/mndint/mndo97q/97/PARAMD.f, the GHO parameters are reset to the 
original MNDO/d parameters for the real element 85 (which is actually 
missing in the parameter definition). So we explicitly skip this reassignment 
if a GHO atom is detected (I .eq. 85), to prevent it from being overwritten. 

Files involved:
source/mndint/mndo97q/97/PARAMD.f

==============================================================================

[2] c36a2 Change Log

    The following are introduced and modified during the development period
of August 15, 2008 through February 15, 2009.  The developments are
based on CHARMM version c36a1. As F95 conversion is in progress, we include
minor enhancements and fixes into c36a2. On going developments will be 
incorporated into the fully converted version of c36a1x, to be available by
May 15, 2009.

2.1 University of Maryland Developments
    Developer     : Igor Vorobyov, Guillaume Lamoureux and Alex MacKerell
    Email Address : ivorobyov@ucdavis.edu, guillaume.lamoureux@concordia.ca
                    and alex@outerbanks.umaryland.edu
    Institution   : University of Maryland, Baltimore
    Date          : December 31, 2008

2.1.1 MMFP bugfixes

(1) Output to MMFP data file was incorrectly handled if running CHARMM
code on more than 2 cpus. The MMFP constraint calculation and data
output at each time step was handled on a different cpu from the one
used for the other data I/O. The cpu or node asignment used for these
calculations depended on the number of processors used for
calculations. Therefore, the code was modified to always run on cpu
(node) 0 i.e. the same one used for I/O as well.

(2) Unnecessary information was printed to MMFP data file at each step
of the simulation, namely "Angle : ", "Dihedral: " or "R : ". These
were removed to save space.  

(3) There were duplicate entries in MMFP data files associated with the
calculation of system energy at the end and the beginning of each
block of molecular dynamics within the same DYNAmics run. The block
length might correspond to the frequency for stopping the rotation and
translation of the system (NTRFRQ) or step frequency for calculating
averages and standard deviations (IPRFRQ). These duplicate entries
were removed by using QMMFPW logical variable, which is set to be true
if writing to MMFP data file is allowed.

Files involved:
source/energy/energy.src (1)
source/dynamc/dcntrl.src (3)
source/fcm/contrl.fcm    (3)
source/misc/mmfp.src     (2)

..............................................................................

2.1.2 TPCONTROL for monoclinic ('MONO') crystal types

     The 'FULL' option in TPCONTROL now accepts monoclinic ('MONO') crystal
types. The following crystal types are now available for constant-pressure
dynamics with a fully flexible cell: CUBI, RECT, OCTA, RHDO, ORTH, MONO, TRIC.
Still not tested (but possibly working) are: TETR, HEXA, RHOM.

Files involved:
dynamc/dynamvv2.src

..............................................................................

2.1.3 Eight character RESIdue name support

     There appears to be a small bug with the number of characters
recognized by the "read sequence RESI NRES" command.  When you have a
residue with more then 4 characters "read sequence RESI NRES" only
recognizes 4 characters in the residue name.  This leads to the
generate statement failing as it can't find the correct residue in the
topology.  Using "read sequence card" does not give this error.

Files involved:
source/io/mainio.src

------------------------------------------------------------------------------

2.2 RMD fixes and enhancements
    Developer     : Stephan Lutz, Markus Meuwly
    Email Address : stephan.lutz@unibas.ch, m.meuwly@unibas.ch
    Institution   : Department of Physical Chemistry, University of Basel
    Date          : December 26, 2008

     Several modifications in Reactive MD module removing some bugs found for 
very specific PSF and RMD definitions. Additionally, the previous precondition 
for a mandatory bond inclusion in the PSF when the specific bond is getting
removed in the RMD definition is now abolished. Merged all Fortran77 COMMON
BLOCK variables from cross.fcm into module cross and converted all fixed size
arrays to allocatable ones.

Files Removed:
source/fcm/cross.fcm

Files Modified:
build/UNX/charmm.mk
build/UNX/dynamc.mk
build/UNX/energy.mk
build/UNX/misc.mk
build/UNX/pert.mk
doc/cross.doc
source/charmm/iniall.src
source/charmm/miscom.src
source/dynamc/dcntrl.src
source/dynamc/dynamc.src
source/energy/energy.src
source/misc/cross.src
source/misc/genetic.src
source/pert/epert.src
source/pert/icpert.src
test/c35test/cross.inp

------------------------------------------------------------------------------

2.3 Developments at NIC-Slovenia
    Names         : Milan Hodoscek
    Email Address : milan@cmm.ki.si
    Institutions  : National Institutes of Chemistry, Ljubljana, Slovenia
                    and National Institute of Health, Bethesda, MD, USA
    Date          : December 31, 2008

2.3.1 Overlap method is modularized

     The Overlap method is now in the module. The same code was ported
to c36a1x development.

Files Modified:
build/UNX/energy.mk
source/charmm/charmm_main.src
source/charmm/miscom.src
source/energy/energy.src
source/energy/eolap.src
source/fcm/olap.fcm
source/misc/olap.src

.............................................................................

2.3.2 GRAPE interface in CHARMM extended to support GPU cuda library.

     The interface code in CHARMM to the GRAPE library was extended so
it supports also the GPU (cuda library).

Files Modified:
source/charmm/iniall.src
source/fcm/grape.fcm
source/nbonds/enbond.src
source/nbonds/grape.src
source/nbonds/nbutil.src
source/nbonds/pme.src

.............................................................................

2.3.3 REPDSTR fixes and enhancement

     The distributed replica method was enhanced by few more commnads
so it allows communication between chosen replicas in a CHARMM script
itself. The new commands are repd sync, repd iores, repd ioset. See
doc/repdstr.doc file for more info.

Files Modified:
doc/repdstr.doc
source/fcm/repdstr.fcm
source/gener/repdstr.src
source/io/coorio.src
source/io/mainio.src
source/machdep/machio.src
source/machdep/paral1.src
source/machdep/paral2.src
source/util/parse.src

.............................................................................

2.3.4 Smaller miscellaneous fixes and enhancement

     There was an unprotected call to communication in the energy
routine: it is now properly protected. Several fixes were needed to
compile CHARMM LITE version. Some comment lines were added in cstuff.c
for future development of the routines in that source file. And one
subroutine name conflict was resolved.

Files Modified:
install.com
source/energy/energy.src
source/flucq/flucq.src
source/flucq/fluqdyn.src
source/flucq/fluqene.src
source/flucq/fluqqmmm.src
source/machdep/cstuff.c
source/manip/confcons.src

------------------------------------------------------------------------------

2.4 Updates on reaction path constraint facilities
    Developer     : Jhih-Wei Chu
    Email Address : jwchu@berkeley.edu
    Institution   : UC Berkeley
    Date          : December 23, 2008

     Bug fixes and minor enhancement on the reaction path facilities.

Files Modified:
source/dynamc/dynamc.src 
source/energy/epath.src 
source/fcm/rxncons3.fcm
source/fcm/rxncons4.fcm
source/fcm/rxncons.fcm
source/manip/holonom.src 
source/manip/rxcons_3.src
source/manip/rxcons_4.src
source/manip/rxcons.src

------------------------------------------------------------------------------

2.5 Bugfixes and Enhancements

2.5.1 VV2 Bugfix for NVT ensemble runs
    Developer     : Haibo Yu and Benoit Roux
    Email Address : haibo@uchicago.edu and roux@uchicago.edu
    Institutions  : University of Chicago, Argonne National Lab
    Date          : September 6, 2008

     Simulations with VV2 integrator at NVT ensemble crash at step 0 
with an error mesg SHAKE failed. Some of the variables in RattleRoll
subroutine are not initialized.

Files involved:
source/dynamc/dynamvv2.src

..............................................................................

2.5.2 AM/MM atom selection for link atoms
    Developer     : H. Lee Woodcock III and Bernard R. Brooks
    Email Address : hlwood@nih.gov and brb@nih.gov
    Institution   : Laboratory of Computational Biology, NHLBI, NIH
    Date          : December 31, 2008

     Due to the extension of the Q-Chem QM/MM interface to handle QM/MM 
Hessian with link atoms the atom selections based on IGMSEL needed 
to be modified to include link atoms. 

Files involved:
source/gukint/gukini.src

------------------------------------------------------------------------------

2.5.3 REPDSTR and ADDLink bugfixes
    Developer     : Kwangho Nam
    Email Address : nam@tammy.harvard.edu
    Institution   : Harvard University
    Date          : December 30, 2008

     A error has fixed in the replica exchange method using
REPDstr module. In the module, the exchange between two
neighboring replicas occurs when the exchange probability
is larger than random number, but the bug results in the 
reversed decision, and this bug is fixed. 

     For the ADDLink keyword, we fix it to include SQUANTM 
module. 

Files involved:
source/charmm/charmm_main.src   
source/gener/repdstr.src        

..............................................................................

2.5.4 MCMA code updated
    Developer     : Peter Steinbach
    Email Address : steinbac@helix.nih.gov
    Institution   : CMM/DCB/CIT, National Institutes of Health
    Date          : October 17, 2008

     PRNLEV control is activated and MAINCOMX is used in the main routine.

Files involved:
source/mc/mcma.src

..............................................................................

2.5.5 The mass array scaling kept unchanged for the force constant
    Developer     : nuria plattner
    Email Address : nuria.plattner@unibas.ch
    Institution   : University of Basel
    Date          : October 14, 2008

     For path integral molecular dynamics, the force constant between the
beads depends on the mass of the corresponding atoms. The mass is taken from
the AMASS(*) array. At the same time, the mass of the beads used for the
dynamics is scaled by the number of beads. (According to the centroid
approximation.) The two usages of the mass array require different values
of the masses, therefore it is not possible to use only one array for both
modules.

Files involved:
source/energy/pathint.src
source/fcm/pathint.fcm

..............................................................................

2.5.6 Ewald code fixes for HYBrid Hamiltonian module
    Developer     : Arnaud BLONDEL
    Email Address : ablondel@pasteur.fr
    Institution   : Institut Pasteur (Paris, France)
    Date          : August 28, 2008

     Some conflicts with the existing Ewald/Block implementation are fixed.

Files involved:
source/energy/energy.src
source/nbonds/enbaexp.src
source/nbonds/ewald.src
test/c36test/block_hybh.inp
test/c36test/block_hybh_ew.inp

==============================================================================

[3] c36a3 Change Log

    The following are introduced and modified during the development period
of February 15, 2009 through August 15, 2009.  The developments are
based on CHARMM version c36a2. As F95 conversion is in progress, we include
minor enhancements and fixes into c36a3. On going developments will be 
incorporated into the fully converted version of c36a1x, to be available by
October 15, 2009.

3.1 University of Chicago Developments
    Name          : Wei Jiang, Haibo Yu, Benoit Roux
    Email Address : wjiang@mcs.anl.gov, haibo@uchicago.edu, roux@uchicago.edu
    Institutions  : University of Chicago, Argonne National Lab
    Date          : June 30, 2009

3.1.1 Drude Polarizable Model Related Development

3.1.1.1 Additional Anharmonic Stretching for Drude Particles:
     In additional to the harmonic stretching of the Drude particles, one
additional anharmonic stretching is introduced which is necessary for highly
polarizable anions. This function is activated in GENE command with the logical
variable HYPE. Currently all the Drude particles are assigned with the same
anharmonic stretching. The formula is 

     E_{anharm} = KHYP*(DeltaR - RHYP)**HORD when DeltaR > RHYP.
    
Files Modified:
source/fcm/psf.fcm
source/gener/drude.src
source/gener/genpsf.src
source/energy/energy.src
source/pert/epert.src

3.1.1.2 Langevin Thermostats for Drude Particles
     The Langevin thermostat is further applied to Drude particles (relative
motion of a Drude pair), in addition to the existing Langevin thermostat applied
to center of mass of a Drude-nucleus pair.

Files Modified:
source/dynamc/dynamvv2.src

3.1.1.3 New Format for PSF of Drude Mode
     Besides the XPLOr format updated in c36a1, PSF format of Drude model is
extended to include the Thole and polarizability for each particle. In the new
format, the anisotropic information for the lone-pairs of Drude model is shown
along with the lone-pair information. 

Files Modified:
source/io/psfres.src

..............................................................................

3.1.2 Enhancement Related to Free Energy Simulations

3.1.2.1 Parallelized MC module
     The MC module is parallelized by modifying the non-bonded list when multiple
processors are invoked. For simulation with single CPU, the existing miniature
list is invoked, while for multiple processors, the full non-bonded list same as
a MD simulation is used.

Files Modified:
source/mc/mc.src
source/mc/mvgcmc.src

3.1.2.2 Hamiltonian Replica-Exchange Scheme
     The Hamiltonian Replica-Exchange scheme is introduced to the REPDSTR module.
This enables a straightforward replica-exchange for free energy perturbation,
umbrella sampling, and alternative replica-exchange for Hamiltonian-exchange and
parallel tempering.

Files Modified:
doc/repdstr.doc
source/fcm/parallel.fcm
source/fcm/repdstr.fcm
source/gener/repdstr.src
source/dynamc/dcntrl.src
source/manip/cstran.src

..............................................................................

3.1.3 Various Updates and Enhancements

3.1.3.1 CHARMM Installation on BG/P Cluster
     The installation and compilation of CHARMM on IBM Blue Gene/P cluster.

Files Modified:
install.com
build/UNX/Makefile_gnu
source/machdep/cstuff.c

3.2 Bugfix related with PERT parallel running
     Problems with PERT MMFP parallel running are fixed.
     Problems with PERT Drude system parallel running are fixed.

Files Modified:
source/pert/epert.src

------------------------------------------------------------------------------

3.2 Bugfixes/Improvements for SCC-DFTB/MM Options
    Name          : Qiang Cui, Xiao Zhu
    Email Address : cui@chem.wisc.edu, xzhu@chem.wisc.edu`
    Institution   : University of Wisconsin Madison
    Date          : June 2009

3.2.1 SCC-DFTB/MM-eWald simulations
     The Ewald summation with SCC-DFTB/MM is sped up by tabulating the erfc
calculaiton as in pure MM calculations and re-implementing the pre-calculated
terms. With the CUTF option, now SCC-DFTB/MM-eWald simulations are similar in
speed as cutoff based simulations.
       
Files Added:
source/sccdftbint/sccdftbsrc/gammamat.src 

Files Removed:
source/sccdftbint/sccdftbsrc/gammamat.f

Files Modified:
build/UNX/sccdftb.mk
doc/sccdftb.doc
source/sccdftbint/sccdftbini.src
source/sccdftbint/sccdftbsrc/eglcao.f
source/sccdftbint/sccdftbsrc/externalshift.f
source/sccdftbint/sccdftbsrc/externalchgrad.src
source/sccdftbint/sccdftbsrc/long_range.f
source/sccdftbint/sccdftbsrc/long_sccmm1.src
source/sccdftbint/sccdftbsrc/ktable_ewscc.src

..............................................................................

3.2.2  SCC-DFTB/PB function
     The added function also works for SCC-DFTB/MM; Allows for charge-dependent
radii (G. Hou, X. Zhu and QC, ms in preparation), which can be very useful for
charged species. Includes both energy and gradient. Can be used for reaction
path calculations.

Files Added:
source/misc/pbeqscc.src
source/fcm/sccpb.fcm

Files Modified:
build/UNX/misc.mk
source/fcm/pbeq.fcm
source/fcm/sccdftb.fcm
source/energy/energy.src
source/mc/mcener.src
source/misc/gsbp.src
source/misc/pbeq.src
source/misc/pbeq2.src
source/sccdftbint/sccdftbini.src
source/sccdftbint/sccdftbsrc/eglcao.f
source/sccdftbint/sccdftbsrc/shift.f

..............................................................................

3.2.3 DIV scheme for QM/MM boundary

     The DIV scheme (JPC-B, 109, 9082-9095 (2005)) is added and bug fix in GSBP
in terms of boundary and reference consistency.

Files Modified:
source/fcm/sccdftb.fcm
source/misc/gsbp.src
source/misc/gsbpscc.src
source/misc/gsbpscc2.src
source/sccdftbint/sccdftbini.src

..............................................................................

3.2.4 SCF convergence criterion added

     Added Mulliken-charge based SCF convergence criterion and the option to
print out QM dipole moment. Both are useful for IR spectra calculations based
on classical ACF of QM dipole.

Files Modified:
source/fcm/sccdftb.fcm
source/sccdftbint/sccdftbini.src
source/sccdftbint/sccdftbsrc/eglcao.f
source/sccdftbint/sccdftbsrc/output.f

------------------------------------------------------------------------------

3.3 Constant Pressure Simulation with the Primary Hydration Shell
    Developer     : Mehdi Bagheri Hamaneh and Matthias Buck
    Email Address : matthias.buck@case.edu
    Institution   : Case Western Reserve University
    Date          : March 30, 2009

     We have modified the primary hydration shell (PHS) method implemented
in the MMFP module. In this method the protein of interest is solvated using
only a thin shell of water, and to prevent evaporation of the solvent,
a half-harmonic force is applied to the water molecules whose distance from
the nearest protein atom is larger than a certain value. The PHS method
greatly reduces the computational cost of molecular dynamics simulations
especially for large systems. In our modified version the method has been
improved in several ways: 

     1) Despite the fact in PHS simulations the system is non-periodic,
the modified PHS method allows running constant pressure simulations.
This is especially important in the case of the large proteins, because
the external forces applied to the water molecules result in large pressures,
which in turn cause distortion and unfolding of the protein. To reduce
the pressure on the system, a small outward half-harmonic force is applied
to the water molecules that are close to the solvent-vacuum boundary.
By adjusting the ratio of the outward and inward forces the pressure of
the system is held constant at the desired value.

     2) The PHS method requires finding the nearest protein atom to each
water molecule. For a large system calculating these distances is very
computationally expensive. We have introduced in a much more efficient
algorithm for distance calculations, which decreases the computational
time several fold.

     3) Using the original PHS method usually results in partial desolvation
of some (mostly hydrophobic) parts of the protein. In the modified version of
the method the user may use different force constants for the external forces
applied on the water molecules, depending on the hydrophobicity of the nearest
protein residue. In other words, the force constant for the waters that are
close to non-polar residus may be set to a larger value. This usually results
in a more uniform water distribution around the protein.

     Comparisons between the results of simulations with both original and
modified PHS method, and also simulations using the standard methods with
periodic boundary conditions show good agreement between the modified version
and the standard simulations and major improvements over the original method.
For details about the method and also test simulations please see the
following:

M B Hamaneh, and M Buck, Refinement of the primary hydration shell model for
molecular dynamics simulations of large proteins, Journal of Computational
Chemistry, in press.

Files Modified: 
doc/mmfp.doc
source/energy/energy.src
source/fcm/mmfp.fcm
source/manip/corman2.src
source/misc/primsh.src
source/pert/epert.src
test/c24test/mmfptest3.inp

------------------------------------------------------------------------------

3.4 Non-Uniform Charge Scaling (NUCS)
    Developer     : Stefan Fischer
    Email Address : stefan.fischer@iwr.uni-heidelberg.de
    Institution   : University of Heidelberg, Germany
    Date          : June 24, 2009

     The NUCS procedure is a practical approach of implicit solvation 
that approximates the solvent screening effect by individually scaling 
the partial charges on the explicit atoms of the macromolecule 
so as to reproduce electrostatic interaction energies obtained 
from an initial Poisson-Boltzmann analysis. 
The solvation "Born" self-energy of the partial charges is neglected.  

     The approach is particularly suitable for minimization-based simulations, 
such as normal mode analysis, certain conformational reaction path or 
ligand binding techniques for which bulk solvent cannot be included explicitly,
for combined quantum mechanical/molecular mechanical calculations, 
when the interface to more elaborate continuum solvent models is lacking.

Details described in
  "Non-Uniform Charge Scaling (NUCS): a practical approximation 
   of solvent electrostatic screening in proteins."
   S.M. Schwarzl, D. Huang, J.C. Smith and S. Fischer.
   J. Comp. Chem. 26, 1359-1371 (2005).

Files Added:
support/nucs_solvation/nucs_solvation.tar.gz

Modified Documentation:
doc/support.doc

------------------------------------------------------------------------------

3.5 Bugfixes and Enhancements

3.5.1 Prefx key fix
    Developer     : Stefan Boresch
    Email Address : stefan@mdy.univie.ac.at
    Institution   : University of Vienna
    Date          : July 1, 2009

     Incorrect !##RMD handling in iniall.src

Files involved:
source/charmm/iniall.src

..............................................................................

3.5.2 Variable location fix
    Developer     : Rick Venable
    Email Address : venabler@nhlbi.nih.gov
    Institution   : LBC/NHLBI/NIH
    Date          : April 7, 2009

     KK is placed out of ##CHEQ block. (dynamc.src) molt_dummy is declared 
integer. (psfres.src)  qchemp of ##CHEMPERT is placed out of ##PSSP block.
bugfixes on charmm.org

Files involved:
source/dynamc/dynamc.src
source/io/psfres.src
source/fcm/pert.fcm

..............................................................................

3.5.3 DYNA UNFO write fix
    Developer     : Lennart Nilsson
    Email Address : Lennart.Nilsson@biosci.ki.se
    Institution   : Karolinska Institute
    Date          : January 27, 2009

     With I4BINARY in effect (the default) on a 64-bit system the timestep
written to a binary trajectory created with DYNA UNFO has the value 0.0.

Files involved:
source/dynamc/dynio.src

..............................................................................

3.5.4 DYNAMC with transition path sampling with PNSAve.
    Developer     : Michael Hagan (via Aaron Dinner)
    Email Address : dinner@uchicago.edu
    Institution   : The University of Chicago
    Date          : May 13, 2009

     Incorrect error handling when setting inconsistent TPS options for
input of a saved trajectory.

Files involved:
source/dynamc/tps.src

..............................................................................

3.5.5 MC with Wang-Landau sampling from an input initial guess
   Developer     : Aaron Dinner
   Email Address : dinner@uchicago.edu
   Institution   : The University of Chicago
   Date          : July 23, 2009

     Array into which the free energies (middle column of file) are read is
declared as integer rather than real*8 leading to truncation.

Files involved:
source/mc/wl.src

..............................................................................

3.5.6 Routine name corrected
    Developer        : Thomas Taylor / Stefan Boresch
    Email Address    : anubis@mdy.univie.ac.at / stefan@mdy.univie.ac.at
    Institution      : Institut fuer Computergestuetzte Biologische Chemie
    Date             : 2009-05-28

    Compiling with PIPF keyword to enable pipf code does not work out of
the box because of typo. corrected to EPFDRV.


Files involved:
source/nbonds/enbond.src

..............................................................................

3.5.7 VSHIft / RSCAle=0 for some atoms leads to NaN
    Developer        : Stefan Boresch
    Email Address    : stefan@mdy.univie.ac.at
    Institution      : University of Vienna, Austria
    Date             : June 26, 2009

     In free energy simulations with PERT it may be very useful to use
RSCAle to set the LJ interactions of some atoms to zero. We just
noticed by coincidence that this doesn't work with VSHIft (we usually
use VSWItch). Since any fix (suggestions below) touches the inner loop
of the (slow) energy routines (EVDW in enbonda.src), I'd appreciate
feedback before submitting a formal bugfix. Consider the following
fragment from enbonda.src (ca. line 804ff in c36a2):

      IF (S.LT.C2OFNB) THEN
        SGSHSQ=RSCLF(I)*RSCLF(J)*CNBA(IC)
        SIG2=SGSHSQ*R2
        SIG6=SIG2*SIG2*SIG2
        SIG12=SIG6*SIG6
        SGSHSQ=SGSHSQ*RECOF2
        SGSHSQ=SGSHSQ*SGSHSQ*SGSHSQ
        ASH6=TWO*(SGSHSQ-ONE)*SGSHSQ*SGSHSQ/SIG6 ! <----
        BSH6=(THREE*SGSHSQ-FOUR)*SGSHSQ
C
        ENBPR=(CNBB(IC)*(SIG12-SIG6-SIG6+ASH6-BSH6))
        DF=CNBB(IC)*R2*(TWELVE*(SIG6-SIG12)+SIX*ASH6)

As you can see, SGSHSQ becomes zero if RSCLF of either atom
I or J is zero, leading to a division by zero in the line
marked by <----

Realizing that SGSHSQ/SIG6 equals (RECOF2/R2)**3 leads to
an obvious fix of the offending line
Avoid the 0/0 expression by rewriting the offending line as

        ASH6=TWO*(SGSHSQ-ONE)*SGSHSQ*(RECOF2/R2)**3

Files involved:
source/nbonds/enbonda.src

..............................................................................

3.5.8 cstuff.c fix
    Names         : Milan Hodoscek
    Email Address : milan@cmm.ki.si
    Institutions  : National Institutes of Chemistry, Ljubljana, Slovenia
                    and National Institute of Health, Bethesda, MD, USA
    Date          : July 4, 2009

     pointers fixed in funtion uninf.

Files involved:
source/machdep/cstuff.c

==============================================================================

3.6 Carbohydrate force field
    Developer     : Alex MacKerell, Olgun Guvench, Liz Hatcher
    Email Address : alex@outerbanks.umaryland.edu
    Institution   : Univ. of Maryland, School of Pharmacy
    Date          : August 9, 2009

     New versions, deemed all36, of the carbohydrate RTF and PRM files
containing fully optimized parameters for the acyclic sugars, the glycosyl
linkages in hexopyranoses and the furanose monosaccharides.

Files Removed:
toppar/par_all35_carb.prm
toppar/top_all35_carb.rtf

Files Added:
toppar/par_all36_carb.prm
toppar/top_all36_carb.rtf

==============================================================================

[4] c36a4 Change Log

    The following are introduced and modified during the development period
of August 15, 2009 through February 15, 2010.  The developments are based
on CHARMM versions c36a3 and c36a1x.

4.1 Fortran 95 conversion
    Developers: Michael Crowley, Michael Garrahan, Robert Petrella,
                Milan Hodoscek, Lennart Nilsson, Bernard Brooks,
                Charles Brooks, Tim Miller, Richard Venable, Youngdo Won

Files changed:
doc/developer.doc
source/*

4.1.1 Memory management

Dynamic memory management is now done via chmalloc/chmdealloc instead
of allhp/frehp or allstk/frestk. HEAP and STACK are no longer available.

Files added:
source/memory/*

4.1.2 Modules

Variables formerly in common blocks are now in modules, available via
'use' instead of '##INCLUDE'.

Files added:
source/ltm/*

Files removed:
source/fcm/*

4.1.3 New types

Internal coordinate arrays are now in derived type internalCoordinate.
BNBND and related arrays are now in derived type nonbondDataStructure.
BIMAG and related arrays are now in derived type imageDataStructure.

Files added:
source/ltm/chm_types_ltm.src

4.1.4 Preprocessor

Output now enables the Fortran compiler and runtime system to report
the filename and line number of the original .src file instead of the
generated .f or .f90 file.

Files changed:
tool/preflx
tool/prefx.f

4.1.5 Makefile generation

Rewritten for better performance.

Files changed:
tool/setmk.com

Files added:
tool/makemod.pl

Files removed:
tool/mainmake
tool/makemod

------------------------------------------------------------------------------

4.2 Developments at NIC-Slovenia
    Names         : Milan Hodoscek
    Email Address : milan@cmm.ki.si
    Institutions  : National Institutes of Chemistry, Ljubljana, Slovenia
                    and National Institute of Health, Bethesda, MD, USA
    Date          : February 11, 2010

4.2.1 Random number generators in CHARMM overhaul.

      The operation of random number generators (RNG) in CHARMM was
modified to support the new RNGs, which usually require more than one
seed number (usually 4, in some cases even 8) for complete control of
random series of numbers. Support for RNG from the fortran system
library was added, however the previous default is still default now,
but its behavior was changed. It no longer starts by fixed default but
the initial seed numbers are calculated from the current system time
of the run. 

      In order to obtain the compatibility in operation before c36a4
there are 2 new CHARMM command flags: -prevclcg, and -prevrandom. See
more details in doc/random.doc. To use default operational mode with
fixed initial seeds one can use for example: iseed 123 345 567 789 in
DYNA command, which is useful to compare the results in testing new
methods, etc.


Files Added:

doc/random.doc

Files Modified:

machutil/startup.src
util/random.src
correl/solana.src
dynamc/dcntrl.src
manip/intcor.src
mc/mc.src
misc/genetic.src
vibran/vibran.src

..............................................................................

4.2.2 Graphical Processor Unit (GPU) support in CHARMM.

      CHARMM is modified to support execution of most compute
intensive parts on GPU instead of CPU. Both calculations are then
overlapped to maximize the performance. The effort is still under
heavy development but some of the most commonly used methods already
produce the same results as using just CPU. Currently it runs about 10
times faster than on 1 CPU. It only works with NVIDIA cards using CUDA
library.  See the details about setup and running CHARMM with CUDA in
doc/gpu.doc file.

Files added:

doc/gpu.doc

Files modified:

nbonds/grape.src

------------------------------------------------------------------------------

4.3 Image list generation

    Developer:     Robert Petrella
    Email Address: petrella@fas.harvard.edu
    Institution:   Harvard University
    Date:          October 2009

MKIMAT2 is now the default, replacing MKIMAT. See item 1.1.1 above.

Files changed:
source/gener/update.src
source/image/image_module.src
source/image/upimag.src
source/io/parmio.src

------------------------------------------------------------------------------

4.4 Bug fixes

4.4.1 Parameter reading

    Developer:     Stefan Boresch
    Email Address: stefan@mdy.univie.ac.at
    Institution:   University of Vienna, Austria
    Date:          June 2009

Atom type codes greater than 255 resulted in crashes on 32-bit platforms.

Files changed:
source/cff/parrdr_cff.src
source/gener/update.src
source/io/parmio.src
source/ltm/param_ltm.src
source/mmff/assignpar.src
source/mmff/readpar.src
source/util/array.src
source/util/sort.src

4.4.2 RXNCOR distance calculation

    Developer:     Michael Crowley
    Email Address: michael.crowley@nrel.gov
    Institution:   National Renewable Energy Laboratory, USA
    Date:          December 2009

Improved numerical stability of point-to-line distance calculation.

Files changed:
source/rxncor/rxndef.src
source/rxncor/rxnene.src

4.4.3 EMAP input/output

    Developer:     Michael Garrahan
    Email Address: mgarraha@umich.edu
    Institution:   University of Michigan
    Date:          January 2010

Revised to work correctly on more platforms.

Files changed:
source/emap/emapdock.src
source/emap/emapio.c
source/emap/emapsubs.src

4.4.4 Monte Carlo

    Developer:     Michael Garrahan
    Email Address: mgarraha@umich.edu
    Institution:   University of Michigan
    Date:          December 2009

Subroutine argument inconsistencies led to crashes.

Files changed:
source/mc/mc.src
source/mc/mcace.src
source/mc/mcimge.src
source/mc/mvrtrn.src

4.4.5 Other fixes

Uninitialized variables and array boundary violations caused indeterminate
results.

Files changed:
source/cff/codes_cff.src
source/cff/parrdr_cff.src
source/correl/rdfsol.src
source/dynamc/dynlng.src
source/energy/epmfmodule.src
source/energy/phmd.src
source/energy/printe.src
source/gener/genpsf.src
source/io/mainio.src
source/manip/rxcons_4.src
source/minmiz/steepd.src
source/minmiz/tndriv.src
source/minmiz/tnpack.src
source/misc/cross.src
source/misc/eef1.src
source/misc/gnn.src
source/molvib/molvib.src
source/molvib/molvsb.src
source/pert/block.src

------------------------------------------------------------------------------

4.5 Update of toppar files for c36a4

    Developer     : Alex MacKerell
    Email Address : alex@outerbanks.umaryland.edu
    Institution   : Univ. of Maryland, Baltimore
    Date          : January 8, 2010

doc/parmfile.doc updated for c36b4
update of toppar directory
  lipids parmeters to version 36 (version 32 removed)
  CHARMM General force field parameters added (version 36)
  drude parameters updated
  
==============================================================================

[5] c36a4r1 Change Log

    The developmental version c36a4 in FORTRAN95 is further fixed and cleaned
during the period of February 15, 2010 through April 30, 2010.

5.1 Fixex for Portland Group compiler
    Developer     : Lev Gorenstein / Carol B. Post
    Email Address : lev@purdue.edu / cbp@purddue.edu
    Institution   : Purdue University
    Date          : March 8, 2010


1) Compilation dies with error "PGF90-S-0026-Unmatched quote" on line 1048
   in source/util/string.src, because unlike other compilers (and against
   Fortran-90 standard!) pgf95 treats backslashes as C-style escape sequences
   instead of regular characters.
   To mitigate, add '-Mbackslash' to FC definition in corresponding section
   of Makefile_gnu on lines 81 and 85 (this option tells the compiler to NOT
   treat backslashes specially).

2) After addressing 1) above, compilation still dies with
   "Unknown command ##ENDIF^M" in source/correl/ancsol.src and
   source/correl/corsol.src because these files were placed into
   repository in DOS mode (i.e. with 'CRLF' line endings).
   Pgf95 preprocessor chokes on these ends of lines (while gfortran
   and ifort preprocessors apparently don't care).
   To mitigate, run these .src files through any EOL-conversion utility:
        dos2unix  source/correl/ancsol.src  source/correl/corsol.src
   or even simple
        sed -i 's/\x0D$//'  source/correl/ancsol.src  source/correl/corsol.src

Files involved:
build/UNX/Makefile_gnu
source/correl/ancsol.src
source/correl/corsol.src

------------------------------------------------------------------------------

5.2 Compile time errors found with SQ, +COLFFT, and PGF95 install options
    Developer     : Rick Venable
    Email Address : venabler@nhlbi.nih.gov
    Institution   : U.S. NIH/NHLBI/DIR Lab. of Comput. Biology
    Date          : February 25, 2010


     Inclusion of COLFFT (parallel PME enhancement) or the SQUANTUM (via SQ)
pref.dat keywords led to a few simple compile time errors which were
easily diagnosed and fixed.

     Use of the Portland Group compiler via PGF95 insstall option led to
several compile time errors, one simple and couple more subtle.  The
simple one was the use of a single backslash in a quoted string;
adding the '-Mbackslash' compiler option in Makefile_gnu fixed that.

     The PGI compiler compiler complained (kind error) about passing a 
parameter to a dummy arg that was not declared with intent(in); after 
examining the call usage, the dummy arg was declared with intent(in).

     An apparent pre-processor problem surfaced; prefx_gnu compiled with PGI
behaved differently than that from gfortran wrt. ##ENDIF statement
processing when the ##IF block lacks indentifers in parnetheses.  Adding
identifiers to all ##IF blocks fixed the problem.


Files involvd:
build/UNX/Makefile_gnu (PGF95)
source/correl/ancsol.src (PGF95)
source/nbonds/pme_column_recip.src (COLFFT)
source/squantm/sqnt_mlayer.src (SQUANTUM)
source/squantm/sqnt_setup.src (SQUANTUM)
source/util/sring.src (PGF95)

------------------------------------------------------------------------------

5.3 Compatability with the NAG and Pathscale compilers
    Developer     : Tim Miller
    Email Address : btmiller@nhlbi.nih.gov
    Institution   : NIH
    Date          : February 27, 2010

(1) Re-ordered type declarations in source/memory/dealloc_mod.src for 
subroutine chmdealloc_chm_xyz_mult. In the current order n1 and n2 were being
used in array declarations before being declared themselves. Moving the
declaration of n1 and n2 to the top of the type declarations fixes the problem.
(2) In nmr.src -- inctrl should be given an explicit dimension of 20 (otherwise
Pathscale dies due to a size mismatch with the dummy argument)
(3) solvation/rism.src -- there is no module rism, took ##use rism out
(otherwise pathscale thinks we have a subroutine and module both named rism)

Files Modified:
source/memory/dealloc_mod.src
source/misc/nmr.src
source/solvation/rism.src

------------------------------------------------------------------------------

5.4 NREL fixes
    Developer     : Mike Crowley
    Email Address : michael.crowley@nrel.gov
    Institution   : NREL
    Date          : February 26, 2010

5.4.1 compiler needs -cpp for new preprocessed file format

     add -cpp to FC

Files involved:
build/UNX/Makefile_g95
build/UNX/Makefile_osx
build/UNX/Makefile_gnu

..............................................................................

5.4.2 PREFX key BANBA removed
	
     BANBA no longer in the code, removed from default pref.dat

Files involved:
install.com

..............................................................................

5.4.3 Column FFT fix for parallel processing

     Column fft for faster parallel on larger numbers of processors was broken 
for non-orthogonal unit cells such as truncated octahedron, now fixed.
Routine called for both orthorhombic and non-orthorhombic unit cells was the 
same routine which was optimized specifically for orthorhombic unit cells. 
The second routine for non-orthogonal was fixed and is now called for
non-orthorhombic cells.

Files involved:
source/nbonds/pme_column_recip.src

..............................................................................

5.4.4 Nonbond tables

     Last atom was not treated with nonbond forces and energies	
Old code assumed upper triangle list so last atom would have no list.
Fixed by removing "-1" from upper limit to do loop.

Files involved:
???

------------------------------------------------------------------------------

5.5 Fixes at the University of Michigan
    Developer     : Mike Garrahan
    Email Address : mgarraha@umich.edu
    Institution   : University of Michigan
    Date          : April 18, 2010

5.5.1 Build reports need more details about test failures

     CruiseControl build reports say "NEW FAILURE" when a test fails but
don't show how the test failed. rpt2xml.pl runs charmmdif on new failures

Files involved:
test/rpt2xml.pl

..............................................................................

5.5.2 install.com fails to modify Makefile_$chmhost when updated

     install.com was recently modified to replace an existing
build/gnu/Makefile_gnu when build/UNX/Makefile_gnu was newer. However, 
it skipped the modifications usually applied when creating a new build/gnu
directory. This resulted in a stray 'grflib' at the end of the link command,
which failed. added flag new_makefile and changed conditions for modifying the
makefile

Files involved:
install.com


..............................................................................

5.5.3 Pathscale compiler warnings

     The Pathscale compiler issued several warnings when compiling with default
keywords. Replaced scalar 0 arguments with arrays (egrad1.src, aspener.src,
aspenermb.src) and removed RETURNs following unconditional GOTOs
(datastruc.src, tsmp.src)


Files involved:
source/minmiz/egrad1.src
source/misc/aspener.src
source/misc/aspenermb.src
source/mmff/datastruc.src
source/pert/tsmp.src

..............................................................................

5.5.4  cftiangl test setup too complicated

     Test cftiangl performed several COOR commands not essential to the
functionality under test. commented out some COOR commands and added some 
inline PDB data.

Files involved:
test/c30test/cftiangl.inp

..............................................................................

5.5.5 SELPROP calls SCAFIL incorrectly

    The call to subroutine SCAFIL from subroutine SELPROP was missing some
arguments. In subroutine SELPROP, added dimension(*) to dummy argument ARRAY;
added XCOMP2,YCOMP2,ZCOMP2,WCOMP2 to end of arguments for SCAFIL.

Files involved:
source/util/selcta.src

..............................................................................

5.5.6 mc_pert_pbc segfaults in parallel

     Test mc_pert_pbc generated a segmentation fault when run in parallel.
Debugging found that MCLOOP local variable NAMC was uninitialized and
had a very large value on first entry to MCENOB. initialized NAMC to 1
at beginning of MCLOOP

Files involved:
source/mc/mc.src

..............................................................................

5.5.7 PGI build crashes in cwrite

     Certain calls of subroutine CWRITE without the optional DECI argument
caused a segmentation fault when built with the PGI compiler. added a local
variable DECIP in CWRITE which is equal to DECI if provided, -1 if not.

Files involved:
source/io/coorio.src


..............................................................................

5.5.8 Compile with NAG Fortran


     Certain files contained syntax which other compilers accepted but NAG
Fortran rejected.

Files involved:
tool/prefx.f                   removed extra commas from WRITE statements
build/UNX/Makefile_nag	       added -dusty compile option
source/correl/mantim.src       corrected type of array NINSUB in SUBDIV
source/dynamc/tamd.src         use advance='no' in WRITE statements
source/energy/ecnstr.src       added commas to some formats
source/energy/ehbond.src       corrected argument types in subroutine calls
source/energy/epmfmodule.src   declare integer N before arrays of dimension(N)
source/image/crystal.src       corrected argument types in subroutine calls
source/image/xtlfrq.src        call standard CMPLX instead of DCMPLX
source/machdep/machio.src      call standard get_environment_variable
source/machdep/machutil.src    replaced integer(8) with integer(chm_int8)
source/machdep/startup.src     replaced FLUSH subroutine call
                               call standard get_command_argument
source/manip/confcons.src      declare integer N before arrays of dimension(N)
source/mc/mc.src               added SAVE attribute to arrays of type(iptr_ptr)
source/mc/mcma.src             restored stub subroutine to avoid empty file
source/minmiz/nraph.src        corrected argument types in subroutine calls
source/misc/distrib.src        call standard REAL instead of DFLOAT
source/misc/fitcharge.src      declare integer N before arrays of dimension(N)
                               replaced FLUSH subroutine call
source/misc/nmr.src            call standard CMPLX instead of DCMPLX
source/misc/ssbp.src           call standard CMPLX instead of DCMPLX
source/molvib/molvco.src       corrected argument types in subroutine calls
source/nbonds/exelec.src       call standard CMPLX instead of DCMPLX
source/pert/block.src          corrected argument types in subroutine calls
source/pert/icfcnf.src         corrected argument types in subroutine calls
source/pert/icfix.src          declare integer N before arrays of dimension(N)
source/pert/tsme.src           changed ICOLO from integer to type(chm_iptr)
source/pipf/vpipf.src          restored stub subroutine to avoid empty file
source/quantum/qmjunc.src      removed extra commas from WRITE statements
source/util/imsl.src           call standard CMPLX instead of DCMPLX
source/util/matrix.src         call standard CMPLX instead of DCMPLX
source/util/random.src         added ')' to a WRITE statement
source/vibran/mbh.src          corrected argument types in subroutine calls
source/vibran/redbas.src       corrected argument types in subroutine calls

..............................................................................

5.5.9 Compile LITE with NAG Fortran

     When running install.com with the LITE option, NAG Fortran reported
syntax errors at the ends of various files. Added empty subroutines and
reordered ##IF directives and MODULE declarations.

Files involved:
source/energy/ecmap.src        added empty subroutines
source/mc/armupt.src
source/mc/mc.src
source/mc/mcener.src
source/mc/mcimge.src
source/mc/mcio.src
source/mc/mcmini.src           added empty subroutines
source/mc/movead.src
source/mc/moveio.src
source/mc/moveln.src
source/mc/mvcrot.src
source/mc/mvdihe.src
source/mc/mvgcmc.src
source/mc/mvhmc.src
source/mc/mvrtrn.src
source/mc/mvutil.src
source/quantum/qmevdw.src      added empty subroutines

..............................................................................

5.5.10 PGI build crashed taking size of unallocated arrays

     CHARMM executable built with PGI 10 compiler crashed with message
0: SIZE: arg not associated with array

Files involved:
source/image/images.src      in subroutine REIMAG, if the array is unallocated,
                             let L = 0 instead of calling size
source/pert/pert.src         use size of PPIT instead of PPJB in subroutine 
                             CLEARPERT's deallocation of PPIT

..............................................................................

5.5.11 PGI segfaults in GCMC

     Subroutines GCADNB and GCADIM tried to access array IPERT when it was
not allocated. Replaced "QPERT .AND. (IPERT(J) ...)" expressions in
GCADNB and GCADIM with safer IF constructs.

Files involved:
source/mc/mvgcmc.src

..............................................................................
	
5.5.12 Avoid taking size of unallocated arrays

     The result of the size() intrinsic function is undefined for allocatable
arrays which are not allocated and pointers which are not associated.
Several places in the c36a4 code had this vulnerability.

Files involved:
source/util/datstr.src
     defined routines nbgrow_ints_muladd, nbgrow_reals_muladd,
     imgrow_muladd, and generic interfaces NBGROW and IMGROW, so that callers
     need not determine the size of an array in order to enlarge it by a
     given factor.
source/image/upimag.src
source/nbonds/nbexcl.src
source/nbonds/nbutil.src
     call the _muladd forms of IMGROW and NBGROW.
source/correl/solana.src
source/gener/replica.src
source/manip/intcor.src
source/misc/fctall.src
source/misc/genetic.src
source/nbonds/pme.src
source/pert/tsme.src
     ensure that an array is allocated or associated before calling
     size() on it.

..............................................................................

5.5.13 PERT simulation crashed after 100000 dynamic steps

     With PERT enabled, certain simulations segfaulted after a few hundred
thousand steps of dynamics. glibc malloc checking reported a deallocation
failure in UPIMAG (called by UPDECI) after a few tens of thousands
of steps. Code inspection found that UPIMAG allocated and deallocated
arrays ITR, JMATPT, and JMATTR under conditions which were related but
not necessarily identical.

Files involved
source/image/upimag.src             in subroutine UPIMAG, allocate and 
     deallocate ITR, JMATPT, and JMATTR in the same conditional block as 
     the call to IMMAP.  Declared module imgup and subroutine UPIMAG0 
     to enforce argument list correctness.

correl/anacor.src                   use new module imgup.
source/correl/rdfsol.src
source/gener/update.src
source/mc/mcener.src
soruce/nbonds/heurist.src
source/nbonds/nbexcl.src
source/pert/block.src

source/pert/block.src               extracted module block_ltm to break
source/pert/block_ltm.src           dependency cycle involving module block_fcm.

source/image/upimag.src             use new module block_ltm instead of
source/misc/eef1.src                block_fcm


source/nbonds/elookup.src           removed conditionally compiled
source/nbonds/enbaexp.src           BLOCK arrays from ENBAEXP argument list.

..............................................................................

5.5.14 Keyword typos in DCNTRL

     While reconciling a postdoc's recent LDM work with c36a4, in subroutine
DCNTRL I noticed instances of !##LM and !##TMS where !##LDM and !##TSM
were clearly intended.

Files involved:
source/dynamc/dcntrl.src            corrected typos on lines 2510 and 2809.


Detailed description of fixes per each file:

dynamc/dcntrl.src: 

..............................................................................

5.5.15 Segfaults in EGROUP when built with LITE

     When built without MC, ENBOND called EGROUP and ENBFSG with incorrect
arguments, leading to a segfault. After this was corrected, EGROUP
made invalid accesses beyond the end of XCENT, YCENT, etc., leading
to other crashes.

Files involved:
source/nbonds/enbond.src
     made argument LCENTR to EGROUP and ENBFSG conditional on MC keyword;
     corrected type of argument ETA to ENBFS8.

source/nbonds/enbondg.src
     declared module ENBONDG so that argument mismatches are detected at
     compile time.

source/quantum/qmevdw.src
     corrected types of several arguments to EGROUP.

source/mc/mccent.src
     subroutine mc_alloc_centers reallocates XCENT etc. if already allocated
     and a larger size is requested.

..............................................................................

5.5.16 Failure to compile without LDM

     Removing LDM from the default set of pref.dat keywords resulted in
errors at compile time.

Files involved:
source/dynamc/dcntrl.src     subroutine DCNTRL uses module block_fcm
                             unconditionally.
source/energy/energy.src     calls to SETFLA are conditional on LDM.
source/energy/genborn.src    part of subroutine GBSolv1 is conditional on LDM;
                             subroutines GBSolv2 and FillAlpGB2 use module
                             lambdam unconditionally.
source/ltm/lambda_ltm.src    declares integer lstrt unconditionally.
source/pert/block.src        subroutine BLOCK declares integer ltemp
                             unconditionally, call to RMLAMBDA is conditional
                             on LDM; subroutine BLOCKIN call to
                             ldm_block_clear is conditional on LDM.

..............................................................................

5.5.17 Failure to compile with FASTENBFS8
   
     Adding FASTENBFS8 to the default set of pref.dat keywords resulted in
errors at compile time.

Files involved:
source/nbonds/enbfast.src    corrected shapes of cache arrays; corrected calls
                             to chmalloc/chmdealloc.
source/nbonds/enbfs8p.src    renamed module to enbfs8pm; module contains
                             subroutine enbfs8p; all use declarations precede
                             all variable declarations.

..............................................................................

5.5.18 Incorrect arguments to READCV, WRITECV, etc.

     Many subroutines passed scalar integer 0 to READCV or WRITECV where the
declared argument type was an array of integers or reals.

Files involved: 
source/dynamc/cvio.src
source/dynamc/dynio.src      declared modules cvio and dynio;
	                     relocated READCV, WRITCV, and related subroutines
                             to break compile-time dependency cycle.
source/gener/replica_ltm.src
source/gener/replica.src     declared module replica_ltm;
                             relocated variables QREP and NREPL to break
                             compile-time dependency cycle.
source/gener/repdstr.src     removed spurious dependency on module traj_mod.
source/dynamc/dcntrl.src
source/dynamc/dynamc.src
source/dynamc/dynamc4.src
source/dynamc/dynamcv.src
source/dynamc/dynamvv.src
source/dynamc/dynamvv2.src
source/io/coorio.src
source/io/trajio.src
source/mc/mcio.src
source/minmiz/minmiz.src
source/quantum/qub.src       use modules cvio and/or dynio; corrected READCV
                             WRITCV, READYN, WRIDYN argument types as needed.
source/correl/anacor.src
source/correl/rdfsol.src
source/correl/solana.src
source/dynamc/dynsub.src
source/dynamc/tamd.src
source/dynamc/tps.src
source/dynamc/trnphi.src
source/energy/hqbm.src
source/manip/corman2.src
source/manip/dynanal.src
source/manip/hbanal.src
source/manip/intcor.src
source/manip/rmsdyn.src
source/misc/nmr.src
source/pert/block.src
source/pert/icfcnf.src
source/pert/puic.src
source/rxncor/adiab.src
source/rxncor/lupopt.src
source/vibran/quasi.src
source/vibran/rbquas.src
source/vibran/vibio.src      use module cvio; corrected READCV, WRITCV 
	                     argument types as needed.

..............................................................................

5.5.20 Various pref keyword issues

     pref.dat mutation (or "jackknife") testing yielded compile-time errors
when PIPF was added or FOURD or BLOCK was deleted.

Files involved
source/dynamc/dynamc4.src
source/dynamc/dynamc.src
source/mc/mcio.src           corrected types of PIPF-dependent arguments
                             in calls to READYN and WRIDYN
source/dynamc/dynio.src      added constant array uind0 for caller convenience
source/dynamc/tpcontrol.src  call BLASGN only if BLOCK enabled at compile time
source/mc/mc.src
source/mc/mcener.src
source/mc/mcmini.src
source/mc/mvhmc.src
source/misc/genetic.src      set NOFORC only if BLOCK enabled at compile time
source/mc/mcmini.src         removed ')' from !##.not.FOURD lines
source/ltm/aaa_sanity_checks.src   enforce that DOCK requires BLOCK

..............................................................................

5.5.21 Failure to compile with SCCDFTB

Files involved:
build/UNX/Makefile_gnu
build/UNX/Makefile_osx       $FC no longer includes -fpreprocessed when
                             compiling with gfortran
source/gener/update.src
source/quantum/qub.src       use sccdftbsrc in addition to sccdftbint
source/pert/block.src        subroutine block_sccd uses string instead of exfunc
source/sccdftbint/sccdftbini.src   corrected rank of array cptc1
                             use string instead of exfunc
source/misc/gsbpscc.src
source/misc/gsbpcc2.src
source/misc/pbeq.src         replaced GOTO end of loop with CYCLE
source/ltm/sccdftb_ltm.src
source/ltm/sccdftbsrc_ltm.src  removed distracting comments
source/sccdftbint/stbgho.src removed syntax errors, added use chm_kinds,
                             modified function declarations
source/sccdftbsrc/dylcao.src
source/sccdftbsrc/ktable_ewscc.src
source/sccdftbsrc/long_sccmm1.src
source/sccdftbsrc/long_sccmm2.src  indented 'use' statements to column 7
source/sccdftbsrc/long_range.f
source/sccdftbsrc/short_range.f    changed tabs to spaces

..............................................................................

5.5.22 Compile with QM-MM interfaces

     Code to interoperate with CADPAC, GAMESS, MNDO97, and QMMMSEMI did
not compile.

Files involved:
source/cadint/cadini.src     corrected rank of CADCRD, updated use 
                             declarations, replaced malloc/free with 
                             chmalloc/chmdealloc
source/dynamc/dynamc.src     corrected types of arguments to WRITCV for GAMESS.
source/flucq/flucqqmmm.src   restored IMPLICIT declarations in FQQMM2
source/gukint/gukini.src     corrected preprocessor conditionals for CADPAC
source/mndint/mndini.src     updated use declarations, resurrected VZERO
                             previously deleted from util/vector.src
source/qmmmsemi/qmmmsemi.src updated use declarations

..............................................................................

5.5.23 Integer overflow in improper dihedral codes

     Large atom type code numbers in a topology file resulted in corruption
of improper dihedral data due to arithmetic overflow in 32-bit integers
used to encode the four atoms.

Files involved:
source/io/parmio.src         in PARWTR, declared NATC2 as integer(chm_int8)
                             instead of default integer; on line 2931 in
                             PARRDR, computed NO in terms of NATC2
                             instead of NATC.

..............................................................................

5.5.24 Workarounds for PGI, CFF, MMFF

     Executables built with PGI segfaulted in about 100 of 400 testcases
in a library routine named __hpf_bcopysl unless compiled with -g or -gopt.
After this was resolved, subroutine NEWPRM corrupted NATC while reading
CTHET2 due to a faulty equivalence, causing segfaults in tests gb_cff*.
PGI support representatives attributed both problems to defects in pgf95.


Files involved:
build/UNX/Makefile_gnu       added -gopt to FC1, FC2, FC3 options for PGI
source/ltm/param_ltm.src
source/ltm/psf_ltm.src       removed EQUIVALENCE declarations for CFF and MMFF
source/cff/cff_ltm.src
source/ltm/mmff_ltm.src      added USE declarations with renaming for
                             variables in modules param and psf
source/mmff/assignpar.src
source/mmff/efast_mm.src
source/mmff/readpar.src      replaced rank-2 alias TorFC with direct access
                             to rank-1 array CPC
source/mmff/escalar_mm.src   renamed some subroutine arguments to avoid name
                             collisions with module mmff, declared module
                             escalar_mm
source/ltm/exfunc_ltm.src    removed external declarations for functions in
                             escalar_mm
source/energy/ecntrl.src
source/energy/energy.src
source/image/eimage.src
source/pert/epert.src        use module escalar_mm, corrected subroutine
                             argument types
source/energy/ediff.src
source/energy/intere.src
source/gener/modpsf.src      updated use declarations
source/misc/fitcharge.src    use IAC directly instead of alias MTYPE to
                             compile without MMFF
source/nbonds/ace.src        moved preprocessor conditionals to compile
                             without CFF

------------------------------------------------------------------------------

5.6 Fixes from NIC, Slovenia and NIH, Bethesda
    Names         : Milan Hodoscek
    Email Address : milan@cmm.ki.si
    Institutions  : National Institutes of Chemistry, Ljubljana, Slovenia
                    and National Institute of Health, Bethesda, MD, USA
    Date          : March 21, 2010

5.6.1 CMAP energy term and BLOCK broken again.

     The CMAP energy term didn't work with BLOCK facility in all the
c36aX versions of CHARMM. It works OK for all c35b series of
versions. In order to prevent breaking it again a new self checking
testcase was created.

File Modified:
   source/energy/ecmap.src

File created:
   test/c36test/cmapblock.inp

.............................................................................

5.6.2 Smaller miscellaneous fixes and enhancement

     In order to compile CHARMM using more pref.dat keywords which are
soon to be default there were some fixes needed to the c36a4 tree. The
list of keywords tested is the following:
REPDSTR,ALTIX_MPI,GAMESS,QCHEM,PARCMD,MSCALE,ASYNC_PME,SPACDEC,PARALLEL

Files Modified:

   source/correl/ancsol.src  (get rid of extra ^M at the end of each line)
   install.com               (missing "if gpu" added)
   source/energy/eintern.src (SPACDEC fix)
   source/energy/enefscal.src(SPACDEC fix)
   source/gamint/blur.src    (GAMESS fix)
   source/gener/repdstr.src  (REPDSTR fix)
   source/gukint/gukini.src  (QCHEM,GAMESS fixes)
   source/ltm/aaa_sanity_check.src
   source/ltm/mndo97_ltm.src (compile fix)
   source/ltm/spacdec_ltm.src(SPACDEC fix)
   source/machdep/machio.src (parallel fix)
   source/machdep/paral1.src (parallel fix)
   source/mmff/escalar_mm.src(init fix)
   source/nbonds/enbond.src  (comment modified)
   source/nbonds/nbndcc.src  (parallel fixes)

------------------------------------------------------------------------------

5.7 Fixes from Karolinska Institute
    Name          : Lennart Nilsson
    Email Address : Lennart.Nilsson@ki.se
    Institution   : Karolinska Institutet
    Date          : March 4, 2010

5.7.1 added documentation of mpif90 switch to install.com

Files involved:
install.com

..............................................................................

5.7.2 Compilation of dynamc/cveloci.src fails when CVELOCI is in pref.dat

Files involved:
source/dynamc/cveloci.src     Added use string after use stream

..............................................................................

5.7.3 If-tests without being initialized

     If test performed on RRES and FLGSIT. The results of the test were only
used under conditions when they had been properly initialized, but the test
itself was sometimes performed even when RRES or FLGSIT had not been
initialized.

Files involved:
source/correl/solana.src      Added initialization of rres and flgsit

..............................................................................

5.7.4 Documentation correction

     SHAKE and READ COOR FILE documentation corrected

Files involved:
doc/cons.doc
doc/io.doc                    Added description of CONTinue option

..............................................................................

5.7.5 Mass weighting was not actually done when MASS keyword was present

Files involved:
source/misc/quicka.src        Added multiplication of coordinates by atom mass

..............................................................................

5.7.6 Multiple invocations of CONS RMSD

     Previous RMSD restraint energy terms were incorrectly zeroed when one
term was within tolerance

Files involved:
source/energy/rmsd.src        Removed incorrect resetting of ERMS

==============================================================================

[6] c36a5 Change Log

    The following are introduced and modified during the development period
of May 1, 2010 through August 15, 2010.

6.1 Distributed Multipoles (Module name MTP)
    Developers  : N. Plattner, M-W Lee, M. Meuwly
    Institution : Department of Chemistry, University of Basel
    Date        : June 17, 2010

     The multipole (MTP) module allows to include electrostatic
interactions between multipolar charge distributions and point charges
or between several multipolar charge distributions.

Subversion revision 15 and 39

Added:
doc/mtp.doc
source/nbonds/mtp.src
test/c36test/mtp-cluster.inp
test/c36test/mtp-h2o-trimer.inp
test/c36test/mtp-no-h2o.inp
test/data/mtp-h2o-trimer.dma
test/data/mtp-cluster.dma
test/data/mtp_no.dma

Modified:
build/UNX/charmm.mk
build/UNX/image.mk
build/UNX/nbonds.mk
doc/commands.doc
source/charmm/charmm_main.src
source/charmm/miscom.src
source/image/upimage.src
source/nbonds/enbond.src

------------------------------------------------------------------------------

6.2 University of Michigan Developments
    Developer    : Michael Crowley, Mike Garrahan, Charles L. Brooks III
    Institutions : University of Michigan, NREL
    Date         : March 11 - July 15, 2010

6.2.1 Remove INTEGER8 and SCALAR keywords

     Since HEAP and STACK global arrays have been eliminated, it is no longer
desirable to make the default integer size 8 bytes on x86_64 machines.
SCALAR keyword is no longer used in the source code. Removed SCALAR and
INTEGER8 keywords and conditional code.
     install.com no longer adds SCALAR or INTEGER8 to pref.dat. Makefiles
no longer add -i8 or -Di8 to compile command line.

Subversion revision 9 and 11

prefx Keys: INTEGER8, SCALAR

Files Modified:
install.com
build/UNX/Makefile_em64t
build/UNX/Makefile_gnu
build/UNX/Makefile_osx
source/correl/solana.src
source/ltm/parallel_ltm.src
source/machdep/ensemble.src
source/machdep/machio.src
source/machdep/paral1.src
source/machdep/paral2.src
source/machdep/paral3.src
source/cadint/cadini.src
source/flucq/fluqqmmm.src

..............................................................................

6.2.2 Parallel install.com

     Can compile CHARMM in parallel. Environment variable
MAKE_COMMAND='make -j2' will take advantage of a dual-core workstation.
Recommend using KEEPO option of install.com. Revised 'ar' usage saves
considerable time in Mac OS X even with a single core.

Subversion revision 14

Files Modified:
tool/preflx            runs prefx in a temporary directory to avoid
                       concurrency problems with prefx.msg, for021.dat, etc.
tool/makemod.pl        generated makefile updates library archive once after
                       all its constituent object files are complete
build/UNX/*.mk         regenerated with revised makemod.pl

source/charmm/charmm_main.src
source/dynamc/tamd.src
source/energy/ecmap.src
source/energy/gbmvmodule.src
source/nbonds/pblist.src
source/qmmmsemi/qmmmsemi.src
source/squantm/sqnt_qmmm_module.src
source/stringm/stringm.src

..............................................................................

6.2.3 Multi-site lambda-dynamics

     "Multi-Site lambda-dynamics" (MSLD) is a more generalized lambda-dynamics
method that allows multiple substituents (blocks) on multiple Sites on a
common framework to be evaluated simultaneously. Different functional forms
of lambda have been implemented which inherently satisfy the constraints
that each lambda should vary between 0 and 1 and the sum of the lambda values
at a given Site must equal 1. This strategy reduces the need to use Lagrangian
Multipliers and renormalization schemes and, for most systems, the timestep
can be increased in dynamics to 2 fs when SHAKE is invoked.
     BLOCK commands MSLD and MSMA are added.

Subversion revision 17

prefx Keys: LDM

Files Added:
source/pert/lambdadyn.src
test/c36test/msld_test1.inp

Files Removed:
ltm/lambda_ltm.src (moved to pert/lambdadyn.src)

Files Modified:
build/UNX/cff.mk
build/UNX/charmm.mk
build/UNX/dynamc.mk
build/UNX/energy.mk
build/UNX/io.mk
build/UNX/ltm.mk
build/UNX/nbonds.mk
build/UNX/pert.mk
doc/block.doc
doc/dynamc.doc
source/dynamc/dcntrl.src
source/dynamc/dynamc.src
source/dynamc/dynamcv.src
source/dynamc/dynamln.src
source/dynamc/dynamvv.src
source/dynamc/dynio.src
source/energy/enefscal.src
source/energy/energy.src
source/energy/genborn.src
source/io/trajio.src
source/ltm/dimens_ltm.src
source/mc/mvhmc.src
source/nbonds/enbaexp.src
source/nbonds/enbfast.src
source/nbonds/enbond.src
source/nbonds/nbexcl.src
source/nbonds/nbonds.src
source/pert/block.src

..............................................................................

6.2.4 Doxygen configuration

     Configuration file and instructions for automatically generating
low-level documentation from CHARMM code using Doxygen.
see http://www.doxygen.org/

Subversion revision 16

Files Added:
tool/Doxyfile
tool/doxygen.patch

Files Modified:
doc/developer.doc     Added node "API" to developer.doc.

..............................................................................

6.2.5 Force and energy dump

     FRCD command lists energy terms and atom forces to full precision for
validating force field implementations across MD engines.

Subversion revision 23

Files Added:
test/c36test/frcd_3ala.inp

Files Modified:
doc/miscom.doc
source/charmm/miscom.src
source/energy/printe.src
Files Removed: none

..............................................................................

6.2.6 install.com compatibility with old csh

     Failed with error message "if: Badly formed number" on a system using
BSD csh instead of tcsh. Replaced the -M filetest operator (tcsh only)
on line 564 with a more portable test command.

Subversion revision 8

Files Involved:
install.com

..............................................................................

6.2.7 Ignore x86_64 install.com option for gnu and osx

     install.com rejected the x86_64 option with gnu or osx, giving an error
message such as -i8 not available for this platform. In install.com, added
logic to give a warning and continue under these conditions.
(bug in revision 9)

Subversion revision 10

Files involved:
install.com
build/UNX/Makefile_gnu

..............................................................................

6.2.8 test comparison improvements

     "c36a4r1" in output header interfered with automatic comparison of test
outputs.

Subversion revision 13

Files involved:
test/seddir          exclude "CHARMM...Version" from output comparison
test/rpt2xml.pl      ignore whitespace when reporting differences

..............................................................................

6.2.9 prefx output line numbering

     Line numbers inserted in prefx output were wrong if a source file had
multiple non-nested EXPAND blocks or any EXPAND WHEN conditions were false.

Subversion revision 12

Files Involved:
install.com          compiles prefx.f90 instead of prefx.f
tool/prefx.f
tool/prefx.f90       converted to free source form, added derived type
	             expand_context, handles more input cases correctly

..............................................................................

6.2.10 MSLD minor fixes

     Comments in lambdadyn.src inconsistently refer to MSLD and MLDM.
MSLD test case hardcodes "scratch" directory name.

Subversion revision 21

Files Involved:
source/pert/lambdadyn.src
test/c36test/msld_test1.inp

..............................................................................

6.2.11 SCAFIL, GCMCON, etc.

     SCAFIL and SCARET had complicated argument lists prone to mismatches.
Assumed-size (*) array argument GCMCON in various subroutines hindered
debugging. PBEQ defined some COMMON blocks which were no longer used.

Subversion revision 22

Files Involved:
source/charmm/charmm_main.src
source/manip/scalar.src
source/mc/mc.src
source/mc/mcener.src
source/mc/mcimge.src
source/mc/mcio.src
source/mc/mvgcmc.src
source/misc/pbeq.src
source/util/selcta.src

..............................................................................

6.2.12 Always keep .o files

     Since makefiles no longer reuse .a library archive members, running
install.com without KEEPO causes the next install.com to regenerate all the
.o files. Other developers suggest that KEEPO behavior should be the default.

Subversion revision 40

Files Involved:
install.com
build/UNX/*.mk
tool/makemod.pl

..............................................................................

6.2.13 HFB and other fixes

TREK/HFB: spurious rotation of images
GBSW: memory allocation errors after repeated resets

Subversion revision 41

Files involved:
source/energy/gbsw.src     deallocate startalst, gblookup,
                           tmpdist only if allocated
source/rxncor/adiab.src    added flag LNOROTATE to eliminate spurious rotation
source/rxncor/travel.src

------------------------------------------------------------------------------

6.3 Bonded lookup tables
    Developer   : Antti-Pekka Hynninen, Michael Crowley
    Institution : NREL
    Date        : July 1, 2010

     Lookup tables for bond, angle, and dihedral interaction energies.

Subversion revision 24

Files Added:
source/energy/eintern_table.src
test/c36test/bond_table.inp
test/data/bond_table.txt

Files Modified:
doc/io.doc
source/energy/ecntrl.src
source/io/mainio.src
source/nbonds/etable.src

------------------------------------------------------------------------------

6.4 AXD: Accelerated dynamics
    Developers  : David Glowacki and Emanuele Paci
    Institution : University of Leeds
    Date        : June 28, 2010

The AXD module introduces an efficient and easy-to-use method to determine
potential of mean forces and rates along them. It resembles Milestoning with
some differences. So far only a reaction coordinate equal to the distance
between two atoms has been implemented but other reaction coordinate could
be easily implemented (we are working on the number of contacts)

Subversion revision 19

prefx Keys: AXD

Files Added:
doc/axd.doc
source/manip/axd.src
test/c36test/axd1.inp
test/c36test/axd2.inp

Files Modified:
install.com
build/UNX/charmm.mk
build/UNX/dynamc.mk
build/UNX/manip.mk
source/charmm/charmm_main.src
source/dynamc/dynamc.src
source/dynamc/dynamvv2.src

------------------------------------------------------------------------------

6.5 FACTS improvements
    Developer   : Francois Marchand and Amedeo Caflisch
    Institution : Department of Biochemistry, University of Zurich
    Date        : July 13, 2010

1) Correct treatment of fixed atoms. Previous versions of FACTS were
   not compatible with fixed atoms.
2) Inclusion of a salt screening term. A term similar to the one used in
   GBSW is used to treat low salt concentrations at the Debye-Huckel level.
3) Compatibility with BLOCK. The FACTS energy terms and their gradients can
   now be scaled according to the BLOCK intra- and inter-block scaling
   coefficients.
4) Automatic detection of use of image. The 'TAIM' keyword for periodic
   boundary conditions is no more required in the FACTS command line.

Subversion revision 30

Files Added:
source/misc/fctblock.src

Files Modified:
build/UNX/energy.mk
build/UNX/misc.mk
doc/facts.doc
source/energy/energy.src
source/misc/fctall.src
source/nbonds/nbonds.src
test/c35test/facts_p19.inp
test/c35test/facts_p22.inp

------------------------------------------------------------------------------

6.6 SQUAMTM improvements
    Developer   : Kwangho Nam
    Institution : Harvard University
    Date        : July 15, 2010

    The regular QM/MM-Ewald method suffers from high memory requirement and
slowness as the size of the system increases.  The PME method is a NlogN
algorithm, where N is the number of atoms in the system, and requires lesser
memory.  The current implementation computes the QM-MM long range interactions
(in the QM/MM calculations) by using the PME algorithm and the QM-QM long
range interactions are computed by the regular QM/MM-Ewald algorithm,
in which the lesser is much faster since mostly the size of QM system is much
smaller than MM system. Also small bug fixes in the MNDO97.

Subversion revision 25

Files Modified:
doc/qmmm.doc
source/dynamc/dcntrl.src
source/dynamc/dynamc.src
source/dynamc/dynamcv.src
source/mndint/mndini.src
source/nbonds/pme.src
source/squantm/sqnt_ene.src
source/squantm/sqnt_qm2_energy.src
source/squantm/sqnt_qm2_ewald.src
source/squantm/sqnt_qm2_mopac.src
source/squantm/sqnt_qmmm_int.src
source/squantm/sqnt_qmmm_module.src
source/squantm/sqnt_qmmm_util.src
source/squantm/sqnt_setup.src
source/squantm/squantm_ltm.src

------------------------------------------------------------------------------

6.7 NIH Developments
    Developer   : Xiongwu Wu, Jon Wright, An Ghysels and Bernard R. Brooks
    Institution : NHLBI, NIH
    Date        : July 15, 2010

6.7.1 Improved SGMD/SGLD for correct ensemble avearges

     The SGMD/SGLD method is improved to reproduce correct ensemble avearge.
REPDSTR is enhanced with SGMD/SGLD simulation.

Subversion revision 31

Prefx Keys: SGLD, REPDSTR

Files Modified:
doc/sgld.doc
doc/repdstr.doc
source/dynamc/dcntrl.src
source/dynamc/dynamc.src
source/dynamc/sglds.src
source/gener/repdstr.src
test/c31test/sgld.inp

..............................................................................

6.7.2 SGMDfp/SGLDfp update

     SGMDfp/SGLDfp method, documentation, and testcase are updated.

Subversion revision 34

Prefx Keys: SGLD

Files Modified:
doc/sgld.doc
source/dynamc/dcntrl.src
source/dynamc/dynamc.src
source/dynamc/sglds.src
test/c31test/sgld.inp

..............................................................................

6.7.3 Raise and entropy options for MBH method

     The optional arguments RAISe and ENTRopy have been implemented in the
Mobile Block Hessian (MBH) method in the vibran module. Test case and doc file
vibran.doc are updated. The RAISe option increases the frequencies that
corresponds to global translational/rotational to an artificially high value
in order to separate them from the internal vibrations. The way the MBH does
the mass-weighting of the Hessian required to implement a different method
he optional arguments RAISe and ENTRopy have been implemented in the Mobile
Block Hessian (MBH) method in the vibran module. Test case and doc file
vibran.doc are updated. The RAISe option increases the frequencies that
corresponds to global translational/rotational to an artificially high value
in order to separate them from the internal vibrations. The way the MBH does
the mass-weighting of the Hessian required to implement a different method
than the one that is available for the DIAG key word.

Subversion revision 38

Files Modified:
doc/vibran.doc
source/vibran/mbh.src
source/vibran/raise.src
source/vibran/vibran.src
test/c36test/mbh.inp

..............................................................................

6.7.4 EMAP documentation and binding site input parameters

     EMAP documentation is reformatted and binding site parameters added to
allow forcused search.

Subversion revision 20

Files involved:
doc/emap.doc
source/emap/emapdock.src

------------------------------------------------------------------------------

6.8 Michigan State University Developments
    Developer   : Michael Feig
    Institution : Michigan State University
    Date        : July 15, 2010

Subversion revision 33

6.8.1 PRNLEV protection of write statements

     IF statements were added at three places to protect write messages
according to PRNLEV setting.

Files Modified:
source/gener/makphi.src
source/io/coorio.src

..............................................................................

6.8.2 Miscellanous updates/fixes in GBMV module

     Minor fixes and updates. HDNOSW option is introduced to allow non-polar
switching function in membrane environment to be switched off.

Files Modified:
doc/gbmv.doc
source/energy/gbmvmodule.src

..............................................................................

6.8.3 Provide an option to read external epsilon grid files in PBEQ

     Add the option of reading epsilon grids from an external file instead of
generating it based on a given solute. There are two new options (EPSG and
EPSU) to provide a unit number of a previously opened file from which the
epsilon grids are then read.  There are two different formats. In format 1
(EPSU) the epsilon grid is directly read in and has to match the grid
dimensions setup through PBEQ. In format 2 (EPSG) an arbitrary grid can
be given which is then sampled to setup the epsilon grid within PBEQ. These
new options work only with non-multigrid standard PB calculations.

Files Modified:
doc/pbeq.doc
source/misc/pbeq.src

..............................................................................

6.8.4 PRIMO coarse-grained force field

     Updates to fully implement the PRIMO coarse-grained force field.
This includes updated EPMF routines and a new PRIMO module that allows
the use of virtual atoms in the calculation of bonded terms.

prefx Keys: EPMF, PRIMO (new)

Files Added:
doc/primo.doc
source/energy/primomodule.src
test/c36test/primo.inp

Files Modified:
install.com
build/UNX/energy.mk
build/UNX/charmm.mk
doc/commands.doc
doc/epmf.doc
source/ltm/energy_ltm.src
source/charmm/charmm_main.src
source/energy/epmfmodule.src   (completely rewritten)
source/energy/eutil.src
source/energy/energy.src
source/energy/printe.src
test/c36test/epmf.inp
test/data/epmf1d.dat
test/data/epmf2d.dat

------------------------------------------------------------------------------

6.9 Miscellaneous Parallel and QM/MM Bug Fixes
    Developer   : Milan Hodoscek
    Institution : NIC, Ljubljana, NIH, Bethesda
    Date        : July 22, 2010

     Several bug fixes, mostly for parallel and QM/MM CHARMM.
- subroutine name clash PRTSTAT -> PRTSTATS in iniall.src
- switch off parallel communication, PARINFNTY pref.dat keyword
- qm/mm fixes and improvements
- charmm/gamess: integer*8 vs integer*4 fixes
- grape fixes, now parallel...
- parallel/parallel fixes for path calculations

Subversion revision 36 and 37

Files added:
test/data/pertlam0.inp
test/data/pertlam1.inp
test/c36test/mscalepert.inp
test/c36test/rexsgld.inp
test/c36test/rexcpt.inp

Files modified:
doc/parallel.doc
doc/gamess.doc
doc/qchem.doc
doc/repdstr.doc
source/image/upimag.src
source/nbonds/grape.src
source/minmiz/abner.src
source/manip/rxcons_4.src
source/charmm/iniall.src
source/gukint/gukini.src
source/machdep/machutil.src
source/machdep/paral1.src
source/dynamc/dcntrl.src
source/gamint/ddi.src
source/energy/epath.src
source/energy/eutil.src
source/quantum/addlnat.src
source/gener/repdstr.src
source/util/random.src
source/ltm/gamess_ltm.src
source/ltm/parallel_ltm.src
source/ltm/dimens_ltm.src
source/ltm/chm_kinds_ltm.src
source/ltm/grape_ltm.src
test/data/ala.str

==============================================================================

[7] c36a6 Change Log

    The following are introduced and modified during the development period
of May 1, 2010 through August 15, 2010.

7.1 University of Chicago Developments
    Name          : Wei Jiang, Lei Huang, Benoit Roux
    Email Address : wjiang@mcs.anl.gov,roux@uchicago.edu
    Institutions  : University of Chicago, Argonne National Lab
    Date          : July 30, 2010

7.1.1 2 Dimensional Halmiltonian Exchange Scheme Based on REPDSTR Module

     2D Hamiltonian-Exchange scheme is implemented in REPDSTR module,
by command 'REPD NREP @nrep EXLM EX2D NRPX @nrpx FREQ @freq'.
Hamiltonian-Exchange is extended to PBC systems for either NVT and NPT
simulation. This new feature is especially useful to enhance samplings
of umbrella sampling that involve multiple reaction coordinates.

prefx Keys: +REPDSTR +GENCOMM +ALTIX_MPI +ASYNC_PME

Files Modified:
source/ltm/repdstr_ltm.src
source/gener/repdstr.src

..............................................................................

7.1.2 Dynamic Energy Call Flags for RMSD/GEO Output

     New logical energy call flags (QDYNCALL) are inserted to integrator
files (dynamc.src, dynamcv.src, dynamvv.src and dynamvv2.src). This flag has
the data output of RMSD (urmsd) and GEO (iummfp) only occur when force
calculation is performed for next time step. In any non-dynamic energy call
no output is executed. This flag successfully avoids annoying extra output
lines due to energy calls that are not intended for MD force calculation.

Files Modified:
source/ltm/energy_ltm.src
source/ltm/contrl_ltm.src
source/dynamc/dcntrl.src
source/dynamc/dynamc.src
source/dynamc/dynamcv.src
source/dynamc/dynamvv.src
source/dynamc/dynamvv2.src
source/misc/mmfp.src
source/energy/rmsd.src

..............................................................................

7.1.3 Constructing exclusion list for lone pairs from their hosts' list

     Both drude particles and lone pairs should have the same exclusion lists
as their hosts. In the code currently released, the implement for drude,
MAKDRUDEINB(), is fine in constructing exclusion list. However, there is no
an analog for lone pairs. Some virtual bonds are added between lone pairs and
those atoms connecting directly with lone pairs' hosts to make exclusion list
correct. As MAKDRUDEINB() does, MAKLONEPAIRINB() will build the exclusion
list for lone pairs based on their hosts' list.

Files Modified:
source/nbonds/nbexcl.src

..............................................................................

7.1.4 Extended format PSF of Drude model for CHARMM/NAMD

     New extended  format PSF is designed  for Drude model. The default
format is for CHARMM and xplor format is for NAMD. The PSF explicitly provides
Thole, Polarizability, lone pair and anisotropic information for CHARMM/NAMD
PSF reader. Generation of Drude models based on nonpolarizable model is also
extended to polypeptides and proteins (including generation of disu bond and
patch).

Files Modified:
doc/drude.doc
source/io/psfres.src
source/io/rtfio.src
source/gener/genpsf.src
source/gener/modpsf.src
source/gener/makphi.src
source/gener/psfsum.src
source/misc/hbuild.src
source/nbonds/nbexcl.src
source/nbonds/nbonds.src
source/nbonds/pme.src

------------------------------------------------------------------------------

7.2 University of Minnesota Developments
    Developer     : Dan T. Major, Kwangho Nam, Jiali Gao
    Email Address : majort@mail.biu.ac.il
    Institution   : University of Minnesota, Bar-Ilan University, Israel
                    and Harvard University
    Date          : Jan 27, 2011

7.2.1 Enhancement in Path Integral FEP/UM with QM/MM potentials

     A path-integral (PI) method to account for nuclear quantum correction
to a classical trajectory. The implementation is based on the double
averaging algorithm used in (Sprik, M.; Klein, M. L.; Chandler, D.
Phys. Rev. B 1985, 31, 4234), and the implementation of Warshel et al.
(Hwang, J.-K.;Chu, Z.T.; Yadav, A.; Warshel, A.  J. Phys. Chem. 1991, 95,
8445). The method describes a subset of atoms in the system as
quantum mechanical by replacing the classical particle with a ring of
quasi-particles (beads). The current code may use several
methods to sample the beads: standard Monte Carlo, the Bisection
algorithm (Pollock, E.L.; Ceperley, D.M. Phys. Rev. B 1984, 30, 2555), and
the staging method in (Sprik, M.; Klein, M. L.; Chandler, D.
Phys. Rev. B 1985, 31, 4234).  Three kinds of actions may be used: The
primitive approximation (PA), Takahashi-Imada (TI - Takahashi, M.;
Imada, M. J. Phys.  Phys. Soc. Japan 1984, 53, 3765-3769), and
Chin (CH - Chin, S. A.; Chen, C. R.  J. Chem. Phys. 2002, 117,
1409-1415. Chin, S. A. Phys. Rev. E Stat. Nonlin.
Soft Matter Phys 2004, 69, 046118-7).

     Two mass-perturbation methods may be used to obtain isotope effects:
bisection and staging algorithms.  The new work is described in JCTC 2011 
"Path-integral calculations of nuclear quantum effects in model systems,
small molecules, and enzymes via gradient-based forward corrector algorithms"
by Azuri, Asaf; Engel, Hamutal; Doron, Dvir; Major, Dan T.

QUB is implemented as serial and parallel. In the Parallel version,
the number of processors cannot exceed the number of beads.
Currently, the code has been implemented in serial for standard CHARMM MOPAC,
SQUANTM, GAMESS-UK, QCHEM and SCCDFTB.
The parallel version is implemented seperately for CHARMM MOPAC, SQUANTM,
and SCCDFTB. With the SQUANTM module, the path-integral code takes charge of
the parallelization (scales linearly with NPROC if MOD(NBEADS,NPROC)=0).
For the other codes, the parallel part is mainly handled by the QM code.
The code has also been implemented in parallel for GAMESS-UK
and QCHEM, but not tested so this is disabled for now.
The code has been tested on a SGI-Altix cluster mainly with the Intel 
11.1 compiler.

Files Added:
test/cquantumtest/sqmpathint3.inp (w/SQUANTM)
test/cquantumtest/sqmpathint4.inp (w/SQUANTM)
test/data/umb3d.pot (w/SQUANTM)
test/cquantumtest/sccdftbpathint1.inp (w/SCCDFTB)
test/cquantumtest/sccdftbpathint2.inp (w/SCCDFTB)
test/cquantumtest/gukqmpathint1.inp (w/GAMESSUK)
test/cquantumtest/gukqmpathint1.inp (w/GAMESSUK)
test/data/qmpathint_guk.in (w/GAMESSUK)
test/cquantumtest/qcqmpathint1.inp (w/QCHEM)
test/cquantumtest/qcqmpathint2.inp (w/QCHEM)
test/data/qchem_qub.inp (w/QCHEM)

Files Modified:
doc/qub.doc
source/quantum/mpiqub.src
source/quantum/qub.src
source/charmm/charmm_main.src
source/ltm/qubpi_ltm.src
source/squantm/sqnt_qm2_ewald.src
source/squantm/sqnt_qmmm_int.src
source/squantm/sqnt_qmmm_util.src
source/quantum/qmevdw.src

New/Modified Testcase:
test/cquantumtest/qmpathint1.inp (w/QUANTUM)
test/cquantumtest/qmpathint2.inp (w/QUANTUM)
test/cquantumtest/sqmpathint1.inp (w/SQUANTM)
test/cquantumtest/sqmpathint2.inp (w/SQUANTM)

..............................................................................

7.2.2 Enhancement in SQUANTM (QM/MM) and bug fixes.

     The code has been modified to give enhanced stability and some bug fixes
have been made. The code now works fully with the new version of the QUB
module in serial and parallel. Special modifications have been made to the
SQUANTM routines to allow the QUB module to handle the parallel part, which
makes it highly efficient.

Files Modified:
source/squantm/sqnt_qm2_ewald.src
source/squantm/sqnt_qmmm_int.src
source/squantm/sqnt_qmmm_util.src
source/quantum/qmevdw.src


..............................................................................

7.2.3 rxncor error fixes

     An error in indexing causes error when using more than one reaction
coordinate and printing wrong free energy.

1. Erroneous initialization and updating of the DELSTT index causes
a shift in the array of all reaction coordinate arrays except for the last
one. The error only occurs when using 2 or more reaction coordinates,
so all simulations with a single reaction coordinate were still correct.
The errors can be very significant due to large errors in the computed
biasing potential.

2. Calling the WRSTT routine should only be done if number of total steps
(RXNCNT) is greater then STTSTP. Also, when computing free energy (HELMHO)
one should divide by (RXNCNT-STTSTP) and not just RXNCNT to account for steps
discarded before collecting data during umbrella sampling (set by the 'START'
input option).

Files involved:
source/rxncor/rxndef.src
source/rxncor/rxnene.src

------------------------------------------------------------------------------

7.3 University of Michigan Developments
    Name          : Mike Garrahan, Charles L. Brooks III,
                    Antti-Pekka Hynninen, and Michael Crowley
    Email Address : mgarraha@umich.edu, NREL
    Institution   : University of Michigan
    Date          : July 30, 2010


7.3.1 Eliminate I4VAL and other obsolete functions

     Since untyped arrays HEAP and STACK were eliminated, array access
functions I4VAL, GTRR8, and ASUMR8 are no longer needed.

Files Modified:
source/cff/enbfast_cff.src
source/cff/enbonda_cff.src
source/dynamc/dcntrl.src
source/energy/ecmap.src
source/energy/eintern.src
source/energy/enefscal.src
source/energy/genborn.src
source/flucq/fluqqmmm.src
source/gukint/gukini.src
source/ltm/exfunc_ltm.src
source/mmff/enbscalar_mm.src
source/nbonds/enbfast.src
source/nbonds/enbonda.src
source/nbonds/enbondg.src
source/nbonds/ewaldf.src
source/pert/block.src
source/util/util.src

..............................................................................

7.3.2 Dynamic allocation of some restraints

     In modules cnst_fcm and cstran_mod, allocate dihedral and harmonic
restraint arrays dynamically to avoid limiting their size at compile time.

prefx Keys: HMCM, CPATH

Files Modified:
source/adumb/cmds.src
source/adumb/eadumb.src
source/charmm/iniall.src
source/dynamc/dynamcv.src
source/dynamc/dynamvv.src
source/dynamc/dynlng.src
source/energy/ecnstr.src
source/energy/ediff.src
source/energy/eintern.src
source/energy/eintern_table.src
source/energy/energy.src
source/energy/epath.src
source/energy/intere.src
source/energy/rmsd.src
source/gener/drude.src
source/gener/modpsf.src
source/io/mainio.src
source/ltm/cnst_ltm.src
source/ltm/dimens_ltm.src
source/machdep/quanta.src
source/manip/cstran.src
source/manip/rxcons_3.src
source/manip/rxcons_4.src
source/misc/cross.src
source/misc/genetic.src
source/pert/epert.src
source/pert/icfcnf.src
source/pert/icpert.src
source/pert/tsms.src
source/quantum/qmevdw.src
source/vibran/vibblock.src

..............................................................................

7.3.3 Module dependency cycle detection

     When there is a dependency cycle, make (via install.com) gives an
error but not enough information to fix the problem. When generating
makefiles, feed makemod.pl's module dependency information to the tsort
utility to detect and report dependency cycles.

Files Modified:
tool/makemod.pl
tool/setmk.com

..............................................................................

7.3.4 Bonded lookup table enhancements

     Parallel capability and other improvements to bonded lookup tables.

Files Modified:
source/energy/eintern_table.src

..............................................................................

7.3.5 Bugfixes

(1) BSD csh compatibility
     Some csh scripts used tcsh features not supported by old BSD csh:
$? variable, -s file inquiry operator.

Files Involved:
install.com
test/test.com
tool/setmk.com

(2) Trek HFB fixes
     An invalid index in array IDNEXT caused a segmentation fault.
Arrays WAMPX etc. were not correctly deallocated.

Files Involved:
install.com
source/rxncor/travel2.src

(3) Compile with MTS
     CHARMM did not compile with MTS added to pref.dat

Files Involved:
source/charmm/iniall.src
source/dynamc/dcntrl.src
source/dynamc/dynamln.src
source/dynamc/dynamvv.src
source/dynamc/mts.src
source/dynamc/tbmts_ltm.src
source/energy/energy.src
source/image/eimage.src
source/image/nbondm.src
source/image/upimag.src
source/nbonds/nbonda.src
source/nbonds/nbondg.src
source/nbonds/nbonds.src
source/pert/epert.src

(4) REPDSTR memory allocation
     After 'REPD NREP ...', 'REPD RESET'  failed with the following error:
forrtl: severe (153): allocatable array or pointer is not allocated
Stack trace indicated a deallocation on line 110 of repdstr.src.

Files Involved:
source/energy/epath.src
source/gener/repdstr.src

(5) No IA64_MPI for emt64t
     Since we no longer use 8-byte default integers, IA64_MPI is inappropriate
for em64t systems. Passing an array of 4-byte integers to MPI8ALLREDUCE may
result in a segmentation fault.

Files Involved:
install.com

(6) REPDSTR fixes
     Fails to compile with REPDSTR due to missing variable declarations.
XPEERS and related arrays should be allocated only after an RPATH command.

Files Involved:
source/energy/epath.src
source/gener/repdstr.src
source/ltm/repdstr_ltm.src

(7) Miscellaneous fixes and cleanup
     Miscellaneous bug fixes since c36a4 not yet incorporated in the master
repository.

Files Involved:
source/energy/ediff.src
source/energy/epmfmodule.src
source/energy/hqbm.src
source/gener/modpsf.src
source/image/nbndgcm.src
source/ltm/fast_ltm.src
source/manip/fsshake.src
source/manip/rmsdyn.src
source/manip/rxcons_3.src
source/minmiz/steepd.src
source/nbonds/ewald.src
source/nbonds/nbmodule.src
source/rxncor/adiab.src

(8) APBS Update
     CHARMM APBS code needs updates for compatibility with F95 modules and
the current third-party interface.

Files Involved:
build/UNX/Makefile_gnu
doc/apbs.doc
source/dynamc/dims.src
source/energy/energy.src
source/misc/apbs.src
source/misc/pbeq.src

(9) developer documentation
     Developer documentation updated according to current practice with
Subversion etc. Preprocessor documentation moved to its own file.
Repaired some navigation links to facilitate browsing with GNU Info.

Files Involved:
doc/developer.doc
doc/io.doc
doc/prefx.doc
doc/testcase.doc

(10) EPMF fixes
     Defects in subroutines selchbpmf and calene2dspl led to inconsistent
hbond energy evaluations. Module cmapm now contains subroutine ecmap for
argument checking.

Files Involved:
source/energy/ecmap.src
source/energy/ecntrl.src
source/energy/ediff.src
source/energy/epmfmodule.src
source/energy/intere.src
source/image/eimage.src
source/mc/mcener.src
source/pert/icfcnf.src
source/pert/icpert.src
source/pert/tsme.src

(11) Test case corrections
     Some test cases needed minor modification for best agreement between
c35 and c36. 

Files Involved:
test/c22test/pert.inp
test/c22test/xtlala3.inp
test/c24test/mmfptest2.inp
test/c24test/pert2.inp
test/c34test/mc_pert_pbc.inp
test/c34test/tamd_ala10.inp
test/c34test/testzero.inp
test/c35test/cgenff.inp
test/c35test/cross.inp
test/c35test/facts_p19.inp
test/c35test/facts_p22.inp
test/c35test/rxncons.inp
test/c35test/trek_hfb.inp
test/charmmdif
test/seddir

(12) GBSW lookup fix
     For large GBSW lookup grids, indexing arithmetic was vulnerable to
32-bit integer overflow. Array natomingp can use 2-byte integers to
conserve memory.

Files Involved:
source/energy/gbsw.src
source/ltm/chm_kinds_ltm.src

(13) PHMD fix
     Subroutine RunPHMD incorrectly used the size of ImINBL when traversing
ImINBSL, causing some simulations to die or segfault.

Files Involved:
source/charmm/charmm_main.src
source/dynamc/dynamc.src
source/dynamc/dynamcv.src
source/energy/energy.src
source/energy/phmd.src

(14) PME updates
     Eliminate RCFFT keyword so that PME always uses real-to-complex FFT.

Files Involved:
doc/parallel.doc
doc/preflx_list.doc
install.com
source/nbonds/enbips.src
source/nbonds/nbutil.src
source/nbonds/pme_column_fft.src
source/nbonds/pme.src

(15) SOLANL uninitialized variables
     Uninitialized variables OX2, ATCOR, ATCOR1, ATCOR2 in subroutine SOLANL
led to inconsistent rotational correlation times.

Files Involved:
source/correl/solana.src

(16) MCMA consolidation
     Files mc/mcma_ltm.src and mc/mcma.src should be combined since the
variables in mcmamod are not used anywhere else.

Files Involved:
charmm/charmm_main.src
mc/mcma.src
mc/mcma_ltm.src

(17) Preprocessor conditional usage
     To facilitate the use of third-party tools on CHARMM source code,
some preprocessor conditional expressions should be simplified.

Files Involved:
charmm/charmm_main.src
energy/dmcons.src
energy/ecmap.src
energy/ediff.src
energy/efour.src
energy/energy.src
energy/eolap.src
energy/epath.src
energy/epmfmodule.src
energy/eutil.src
energy/genborn.src
energy/primomodule.src
energy/printe.src
energy/rgy.src
ltm/repdstr_ltm.src
pert/lambdadyn.src

(18) Remove unused module dependency
     Module cvio declared "use phmd" but did not actually refer to anything
in that module. This caused excessive recompilation when PHMD or GBSW code
was changed.

Files Involved:
source/dynamc/cvio.src

------------------------------------------------------------------------------

7.4 Developments at National Instutes for Health
    Developer   : Tim Miller, M. Lerner, Xiongwu Wu, Rick Venable and
                  Bernard R. Brooks
    Institution : NHLBI, NIH
    Date        : November 20, 2010

7.4.1 New tool for finding ## keywords

     A new python script (preflx_used.py) is added. This script parses the
source tree and prints out a list of all ## key words used in the code.
It is primarily intended to help developers track ## keyword usage and
identify areas where ## keywords might be misused.

Files Added:
tool/preflx_used.py

..............................................................................

7.4.2 GROMACS Style Angle Energies and Cut-offs

     GROMACS style angle energies (using cosines) are now applied to angles
that have a negative theta-naught value in the parameter file. Additionally,
GROMACS style switching function for nonbonded interaction has been added.
The GROMACS angle potential has been added to EANGLE and a FAST routine has
been created. Additionally, GROMACS-style nonbonded cut-offs have been
implemented. These work for standard cases, but do not work for all code paths
(e.g. they do not support CROSS or when CTOFNB < CTONNB).

Files Modified:
source/energy/eintern.src
source/energy/ecntrl.src
source/gener/update.src
source/io/parmio.src
source/ltm/deflts_ltm.src
source/ltm/inbnd_ltm.src
source/ltm/param_ltm.src
source/misc/hbuild.src
source/nbonds/enbond.src
source/nbonds/enbfs8p.src
source/nbonds/enbonda.src
source/nbonds/enbaexp.src
source/nbonds/enbfast.src
source/nbonds/nbutil.src
doc/io.doc
doc/parmfile.doc
doc/nbonds.doc

New Testcases:
test/c36test/chmangl_taylor.inp
test/c36test/groangl_taylor.inp
test/c36test/gromacs_angles.inp
test/c36test/gromacs_nbond.inp
data/gromacs-reference.dat

..............................................................................

7.4.3 Torque Utility

     Allow users to define torque centers to allow for rotation and torques on
rigid bodies. Currently, this can only be used with MSCALE.

New Pref key: TORQUE

Files Added:
doc/torque.doc
source/manip/torque.src

Files Modified:
source/charmm/charmm_main.src
source/gener/psfsum.src
doc/mscale.doc
build/UNX/gener.mk
build/UNX/manip.mk
build/UNX/mscale.mk
build/UNX/charmm.mk
doc/commands.doc

..............................................................................

7.4.4 Numerous enhancements to MSCALE:

 - Cleanly shut down subsystems when the main processor exits.
 - Add support for calling AMBER's SANDER module as a subsystem.
 - Fixes to allow periodic systems to work correctly with MSCALE.
 - Pass virial data through MSCALE upon request allowing for NPT calculations.
 - Support passing rotation matrices and torques via MSCALE (in conjunction
   with the torque functionality above).
 - Add the DEBUg option to the SERVer command; when used, DEBUg prints out
   the result of each energy evaluation performed by the server.

Files Modified:
source/energy/energy.src
source/mscale/mscale.src
source/manip/torque.src
source/pert/epert.src
doc/mscale.doc

..............................................................................

7.4.5 Miscellaneous Fixes and Enhancements

 - Print out PID of the CHARMM process in the header and make a ?PID subst
   variable (these are only enabled when the NIH pound-pound keyword is used).
 - Fix c36test/vibran_mscale.inp (wrong path to subsystem files).
 - Added FASTER routines in enefscal.src. These versions of the FAST routines
   that are stripped down for maximum efficiency. The following have been
   removed from FASTER routines: ACTBOND, BLOCK, DOCK, GENETIC, LDM.
 - cons.doc has been fixed (the documentation previously implied that WIDTH
   in CONS DIHE was in radians. It's actually in degrees.
 - A bug in the functional form of the Taylor-expanded angle potential has
   been fixed.

Files Modified:
source/charmm/iniall.src
source/energy/ecntrl.src
source/energy/enefscal.src
doc/cons.doc
doc/subst.doc
test/c36test/vibran_mscale.inp

..............................................................................

7.4.6 IPS rationalized potential and second derivatives

     Isotropic periodic sum (IPS) is an efficient alternative to lattic sum
(Ewald summation). For easy implementation of the IPS method, we developed
rationalized polynomial IPS potentials that can be used as simple as the
cutoff methods.

     Electrostatic interaction has a function form of 1/r. In biological
systems, opposite charges form polar systems and a more accurate polar IPS
potential is developed to describe the charge-charge interaction in the polar
systems.

     This development updated the electriostatic interaction with the polar
IPS potential.

     This development also implemented the polar IPS potential for r**(-2)
form interactions. This form of interaction has been utilized in representing
solvent screening effect.

     In addition, in some applications like the orthogonal walk sampling
methods, secondary derivatives are needed. This implementation allow secondary
derivatives of the IPS potential be calculated.

Prefx Keys: NBIPS

Files Modified:
source/energy/energy.src
source/nbonds/enbips.src
source/nbonds/enbond.src
source/nbonds/enbonda.src
source/nbonds/enbondg.src
source/nbonds/nbips_ltm.src
build/UNX/energy.mk
test/c32test/ips_tip216.inp

..............................................................................

7.4.7 SGMD/SGLD simulation methods for conformational search and sampling

     Recent progress in theoretic understanding of the SGMD/SGLD simulation
methods provides quantitative description of the guiding force effect on
conformational distribution. Based on this theoretic understanding,
we improved the implementation of the SGMD/SGLD methods in CHARMM so that
both SGMD and SGLD can be employed to achive dramatically enhanced
conformational search and calculate correct ensemble properties.

     In SGMD/SGLD simulations, a weighting factor is output that allows
user to convert SGMD/SGLD ensemble to canonical ensemble. Alternatively,
users can choose to run SGMDfp/SGLDfp method that directly samples the
canonical ensemble.

     By default, SGMD/SGLD are run in momentum-based form (SGMDp/SGLDp),
which utilize local avearge momentums to calculate the guiding forces.
The force-based form (SGMDf/SGLDf), which uses local average forces for
the guiding force calculation, are also implemented and can be used for
simulations. The conformational weighting factors for all SGMD/SGLD
simulations are available from simulation outputs.

Prefx Keys: SGLD
Files Modified:
source/dynamc/dcntrl.src
source/dynamc/dynamc.src
source/dynamc/sglds.src
build/UNX/charmm.mk
build/UNX/dynamc.mk
doc/sgld.doc
test/c31test/sgld.inp

..............................................................................

7.4.8 Fixes and minor enhancements

(1) MCMA bugfixes
     There were compile time errors when the MCMA keyword was included,
apparently all simple bugs from the initial Fortran9x conversion.

Files Involved:
source/mc/mcma.src
source/mc/mcma_ltm.src

(2) doc fixes
     Remove obsolete charmm_gen.doc file; correct spelling error in 
commands.doc

Files Involved:
doc/commands.doc

------------------------------------------------------------------------------

7.5 Q-Chem/CHARMM QM/MM Enhancements
    Developer   : H. Lee Woodcock
    Institution : University of South Florida 
    Date        : Feb. 1, 2011

     The following enhancements have been added.

1. Improved coordinate reading: The COORdinate command 
to the Q-Chem/CHARMM interface has been improved and is 
now more robust in terms of reading geometries from 
Q-Chem output files back into CHARMM. This can be useful 
when employing Q-Chem's delocalized internal coordinate 
optimizer during QM/MM minimizations. 

2. Improved charge handling during Q-Chem/CHARMM QM/MM 
microiteration minimizations. As part of this procedure
charges from Q-Chem need to be read into CHARMM. This 
functionality has been made more robust. 

3. Parallel Q-Chem with serial CHARMM: The QCPArallel 
option to the Q-Chem/CHARMM interface has been improved
to be more general. For example, the QCPAra keyword now
only is activated when CHARMM is run with 1 processor 
and QCPAra > 1. 

4. QM/PCM and QM/MM/PCM: Support for continuum solvent
methods in Q-Chem has been added. 

5. Q-Chem control file improvements: $molecule and $rem 
sections are now independent of order in the Q-Chem 
control file. 

6. Automatic restart of Q-Chem: To prevent calculations 
/ simulations from abruptly terminating due to SCF parallel 
communication failures the NREStart keyword was added that
allows the user to specify the number of times to retry a
particular Q-Chem QM/MM energy and force calculation before
terminating the overall CHARMM process. 

7. File Saving: The SINP and SOUT keywords activate Q-Chem 
to save input and output file, respectively, for each step 
of a minimization or simulation.

8. Save / Read Gradient: The SGRAdient and RGRAdient 
keywords activates the Q-Chem/CHARMM interface to save an 
individual gradient and read that gradient back in at a 
later point in the calculation.

9. Internal / External writing of Q-Chem input files: As 
knows from qchem.doc a Q-Chem control file is needed for 
proper functioning. The MMQM keyword allows this file, as 
well as external Q-Chem input files, to be written on the 
fly rather than being prepared a priori. 

10. VOLUme keyword bug fixed: Reverts behavior back to using
full VOLUme keyword to activate rather than only VOLU keyword. 

11. The use of LKATMS as part of the Lonepair facility combined
with QM/MM Normal Mode Analysis was enhanced. This previously 
conflicted with the Drude facility and has now been protected 
and dynamic memory used. 

12. Memory allocation bug was fixed from error introduced 
during Fortran conversion. A previous array was being reused 
which lead to a segfault. This was fixed by adding a new 
pointer array, KUPT, in addition to IUPT and JUPT. 

prefx Keys: QCHEM, LONEPAIR

Files Modified:
source/ltm/gamess_ltm.src
source/gukint/gukini.src
source/manip/corman2.src
source/charmm/iniall.src
source/dynamc/lonepair.src
source/energy/energy.src
source/misc/zmat.src
doc/qchem.doc

------------------------------------------------------------------------------

7.6 Miscellaneous Parallel and QM/MM Bug Fixes In CHARMM
    Developer   : Milan Hodoscek
    Institution : NIC, Ljubljana, NIH, Bethesda
    Date        : February 2, 2011

     Several bug fixes, mostly for parallel and QM/MM CHARMM.

- modularize usersb.src
- GPU/CHARMM improvements
- qm/mm fixes and improvements in rpath calcs
- charmm/gamess: integer*8 vs integer*4 fixes
- legendre polinomial fixes in solana.src
- vibran/pert fix with Bernie Brooks

files modified:
source/charmm/iniall.src
source/charmm/miscom.src
source/charmm/usersb.src
source/correl/anacor.src
source/correl/solana.src
source/energy/ediff.src
source/energy/energy.src
source/energy/intere.src
source/gamint/ddi.src
source/gukint/gukini.src
source/manip/rxcons_4.src
source/misc/genetic.src
source/pert/epert.src
source/pert/icfcnf.src
source/pert/icpert.src
source/util/random.src
source/util/selcta.src
source/vibran/vibsub.src
source/vibran/vibutil.src

------------------------------------------------------------------------------

7.7 Karolinska Institute Developments
    Name          : Lennart Nilsson
    Email Address : Lennart.Nilsson@ki.se
    Institution   : Karolinska Institutet
    Date          : January 5, 2011

7.7.1 Added MAP function to correl mantime

     Maps timeseries to specified interval:
MANTIM name MAP real1 real2
Q(t)is mapped to [real1,real2], defalut 0-360

Files Modified (module/file.src):
source/correl/correl.src
source/correl/mantim.src
doc/correl.doc

..............................................................................

7.7.2 Torque option added to PULL

     PULL TORQue can be used to apply a torque to selected atoms around
user specified axis (PNAS (2006) 103, 16200-16205)

Files Added:
test/c36test/torquetest.inp

Files Modified:
source/energy/epull.src
doc/cons.doc

..............................................................................

7.7.3 Bugfixes

(1) NAMD binary files cannot be read (and incorrect files are written)
on 64bit systems and READ/WRITE NAMD does not work in parallel

(2) Crystal data not written to output file unless crystal is setup in MERGE

(3) Crystal data (XTLABC) is read/written to trajectories in default chm_real
precision, potentially rendering trajectories incompatible if chm_real
changes

(4) In parallel, nodes other than node 0 do not parse STREAM FILE ARG correctly

(5) Cleaned up handling of defaults with new random number generator

(6) Self check tolerance too strict in testcase c34test/lookup.inp in parallel

(7) install.com fails with CORSOL in pref.dat

(8) COOR ANAL: Fixed dimension of dummy argument VRED caused crash for large
systems when doing charge "velocity" autocorrelation (CHEQ)

(9) corsubs.src is in wrong directory, it should be in source/manip

Files involved:
doc/dynamc.doc
source/correl/ancsol.src
source/correl/solana.src
source/dynamc/cvio.src
source/dynamc/dcntrl.src
source/dynamc/dynsub.src
source/io/mainio.src
source/machdep/cstuff.c
source/manip/corsubs.src
source/util/random.src
source/util/string.src
source/util/title.src
test/c34test/lookup.inp

==============================================================================

[8] c36b1 Change Log

     At the 2011 CHARMM meeting (University of Wisconsin Madison, July 15-17,
2011), we decided to release CHARMM c36b1 with incorporating enhancements and
fixes to the developmental version c36a6. GPU code is stiil under development
and not included in the release.

     The following are introduced and modified during the development period
of February 15, 2011 through August 15, 2011.

8.1 University of Chicago Developments
    Name        : Wei Jiang and Benoit Roux
    Institutions: University of Chicago, Argonne National Lab
    Date        : April 8, 2011

8.1.1 Nonbonded Pair-Specific Thole Shielding Energy Term for Drude Model
     New nonbonded pair-specific Thole interaction term is introduced to
Drude model. The new Thole term utilizes a mini nonbonded pairlist
constructed based on the nonbonded pairlist. The parameters of nonbonded
Thole term read from the parameter file. It mainly is used in ion-ion
interaction in aqueous solutions.

Subversion committed: 117

Files added:
source/ltm/nbthole_ltm.src
test/c36test/nb_thole.inp

Files modified:
doc/drude.doc
source/energy/energy.src
source/gener/drude.src
source/image/nbondm.src, upimag.src
source/io/parmio.src
source/nbonds/nbonda.src, nbonds.src
source/pert/epert.src

..............................................................................

8.1.2 Optimized parallel code for VV2 integrator
     The source files related to VV2 integrator are edited and optimized,
so that VV2 integrator can be used in REPDSTR parallel/parallel run.

Subversion committed: Revisions 91 and 104

Files Modified:
doc/repdstr.doc
source/dynamc/dcntrl.src
source/dynamc/dynamvv2.src
source/dynamc/nose.src
source/dynamc/tpcontrol.src
source/gener/repdstr.src
source/ltm/repdstr_ltm.src
source/machdep/paral1.src

..............................................................................

8.1.3 Hyperpolarization term of Drude model in PERT module
     Hyperpolarization term for Drude model is added into PERT module.
And tpcntrl.doc file is updated.

Subversion committed: Revision 109

Files Modified:
doc/tpcntrl.doc
source/pert/epert.src

..............................................................................

8.1.4 Bug fixes for THOLE and EHYPER terms of Drude model
     Serial and parallel run give different Thole and Hyper energies.
comment out PARALLEL preprocess for THOLE_NBX CALL and add (MYNOD==0)
condition for EHYPER CALL.

Subversion committed: 115

Files Involved:
source/energy/energy.src
source/pert/epert.src

..............................................................................

8.1.5 Beg fixes for FITCHARGE of Drude model
     Bug returned wrong number of lines in the potential files. This bug
would cause segmentation fault errors in f90 versions of CHARMM when large
potential files were read by fitcharge.

Subversion committed: 119

Files modified:
source/misc/fitcharge.src

..............................................................................

8.1.6 Center of Mass of the Simulated Cell of Drude System
     Tpcontrol.src file is improved that can correctly describe motions
of center of mass of the whole simulated Drude system.

Subversion committed: 120

Files Modified:
source/dynamc/tpcontrol.src

------------------------------------------------------------------------------

8.2 University of Basel Developments
    Developers : Stephan Lutz(1), Jing Huang(2), Sven Lammers(2),
                 Nria Plattner(3), Myung Won Lee(3), and Markus Meuwly
    Institution: Department of Chemistry, University of Basel, Switzerland
    Date       : May 5, 2011

8.2.1 RXMD (module cross) enhancements to describe multiple (>2) PES
     The limitation of RXMD to treat only two user defined PES is removed.
RXMD is now able to describe N <= maxint PES. The algorithm is able to
perform transitions between any combination of two user defined PES.
     A new option implements the capability for RXMD to modify VdW
interactions between atom pairs describing a bond breakage or formation
going from one PES to another. The intention is to lower the bond formation
barrier in the nonbonded state of these atom pairs.
     Due to the new features the RMD keywords and parameter file format
has been changed. The changes are described in the documentation
(cross.doc).

Subversion committed: Revision 92

Files modified:
source/charmm/iniall.src
source/misc/cross.src
doc/cross.doc
test/c35test/cross.inp

File added:
test/data/mbno_cross1.par
test/data/mbno_cross2.par

Files Removed:
test/data/mbno_cross.par

Other Comments:
Includes also several minor bugfixes to make RXMD more robust for
different bond definitions in the PSF file .
The testcase (cross.inp) has been extended with a modified printout
to OUTU!

..............................................................................

8.2.2 Molecular Mechanics with Proton Transfer (module MMPT)
     The MMPT module contains reactive force fields to investigate proton
transfer (PT) reactions in MD simulations. It uses parametrized
three-dimensional potential energy surfaces (PESs) to describe
the interactions within a general DH--A proton transfer motif
where D is the donor, H is the hydrogen and A is the acceptor
atom. Together with the standard CHARMM force field and specific
rules control how bonded interactions on the donor and acceptor side
are switched on and off depending on the position of the transfering
H-atom (DH--A or D--HA). Multiple PT motifs can be located.

Subversion committed: Revisions 106 and 108

prefx Keys: MMPT

Files Added:
doc/mmpt.doc
source/misc/mmpt.src
test/c36test/mmpt_2py2hp.inp
test/c36test/mmpt_h5o2p.inp
test/c36test/mmpt_ma.inp
test/c36test/mmpt_n2h7p.in

Files Modified:
install.com
doc/commands.doc
doc/preflx_list.doc
source/charmm/miscom.src
source/energy/energy.src
source/energy/eutil.src
source/ltm/energy_ltm.src
test/c35test/cross.inp
..............................................................................

8.2.3 Bugfixes for Multipole (MTP) Module

- using absolute value of JNB to prevent segmentation fault
- dynamic memory allocation for arrays REFM and RANK
- explicit initialization of REFM and RANK
- correction of cutoffs for energy and forces
- smooth cutoffs for torques
- additional dynamic memory allocation for images
- proper initialization of MTP from MKIMAT2 in upimag.src

Subversion committed: Revision 110

Files Involved:
source/charmm/iniall.src
source/nbonds/mtp.src
source/image/upimag.src

------------------------------------------------------------------------------

8.3 Karolinska Institute Fixes and Enhancements
    Developer  : Lennart Nilsson
    Institution: Karolinska Institute
    Date       : March 23, 2011

8.3.1 Enhanced reading of non-contiguous trajectories
     Added keyword NOCHeck to all trajectory reading commands in CHARMM,
parsed by routine TRJSPC. When NOCHeck is in effect most of the checks in
READCV concerning beginning and end of the various files making up a multifile
trajectory are disabled. As long as the files are all described by the same
PSF it is possible to mix files that are not contiguous, or differ wrt
timestep, nsavc, fixed atoms, crystal data. Warnings are printed when this
is done, and if MERGe is used to create a new trajectory from such pieces,
this is flagged by setting ICNTRL(14) =1 in the new trajectory. The total
number of frames actually read when READCV is finished with all files is
placed in substitution variable 'NTOT'.
     Direct reading of the ICNTRL array was also replaced in several routines
with a call to GTICNT. I have however not updated the documentation in all
places where reading a trajectory is discussed, but a general description
of the syntax is added in dynamc.doc

Subversion committed: Revisions 93 and 98

Files Added:
test/c36test/traj.inp ; tests the new features; self-evaluating
test/data/tst.str     ; small script to check that variables are with
	                tolerances, for self-evaluating tests

Files Modified:
doc/dynamc.doc
doc/tps.doc
doc/subst.doc
source/correl/rdfsol.src
source/correl/corsol.src
source/correl/ancsol.src
source/correl/correl.src
source/correl/solana.src
source/dynamc/cvio.src
source/dynamc/dynsub.src
source/dynamc/tps.src
source/dynamc/dynio.src
source/io/trajio.src
source/manip/rmsdyn.src
source/manip/hbanal.src
source/manip/corman2.src
source/manip/corman.src
source/misc/nmr.src
source/misc/distrib.src
source/pert/block.src
source/pert/lambdadyn.src
source/pert/icfcnf.src
source/quantum/qub.src
source/rxncor/adiab.src
source/util/parse.src
source/vibran/vibran.src

..............................................................................

8.3.2 Enhanced reading of sequences from coordinate files
     Added keyword SEGI <segid> to READ SEQU COOR and READ SEQU PDB commands.
When present the sequence will be read for the specified segment only;
similar to the CHAIn option to READ SEQU PDB.

Subversion committed: Revision 93

Files Modified:
doc/io.doc
source/io/mainio.src
source/io/psfres.src

------------------------------------------------------------------------------

8.4 Aqueous pores in IMM1 implicit membrane
    Developer  : Maja Mihajlovic and Themis Lazaridis
    Institution: Department of Chemistry, City College of New York
    Date       : May 18, 2011

     Implicit cylindrical, toroidal and circular pores are added to the
implicit membrane model, IMM1. The modifications are implemented based on
equations in T. Lazaridis, J. Chem. Theory Comput., 1:716-722 (2005) and
M. Mihajlovic and T. Lazaridis, Biochim. Biophys. Acta, 1798:1494-1502 (2010).

Subversion committed: Revision 105

Files modified:
doc/eef1.doc
source/misc/eef1.src
source/nbonds/enbondg.src

File added:
test/c36test/testimm1pore.inp

------------------------------------------------------------------------------

8.5 FACTS energy decomposition and INTE compatibility
    Developer  : François Marchand, Amedeo Caflisch
    Institution: Department of Biochemistry, University of Zurich
    Date       : June 14, 2011

     A set of keywords were added to decompose the FACTS solvation energy
in its individual contributions (electrostatic self-energy and GB screening
interactions, non-polar solvation) or evaluate the FACTS energy for a subset
of atoms, useful for certain post-simulation analysis. FACTS is now compatible
with the INTEraction command and it allows, among other, to evaluate the GB
screening interactions between two subsets of atoms (which when added to
its Coulombic counterpart gives the effective electrostatic interaction
between the two subsets). Also, there is the possibility to write the different
atomic contributions to files.

    FACTS with all-atom (param22) force field should be run with the special
GBSW CMAP parameter file "par_all22_prot_gbsw.inp". It was observed that with
the normal CMAP the helical conformations are overweighted, similar to what
happen with GBSW. The GBSW CMAP corrects this effect.

    Code cleaning and minor changes

Subversion committed: Revision 111
Files Modified:
doc/facts.doc
source/misc/fctall.src
source/energy/intere.src
test/c35test/facts_p22.inp

------------------------------------------------------------------------------

8.6 Standard state definition for entropy calculations
    Developer  : Kenno Vanommeslaeghe, Randy Bin Lin and Alex D. MacKerell
    Institution: University of Maryland School of Pharmacy
    Date       : June 22, 2011

     Added definition of standard states to entropy calculations

Subversion committed: Revision 112

Files Modified:
doc/corman.doc
source/ltm/entropy_ltm.src
source/manip/corman.src
source/manip/rgyr.src
source/vibran/vibran.src
test/c32test/entropy.inp

------------------------------------------------------------------------------

8.7 University of Michigan Developments
    Developer    : Michael Crowley, Mike Garrahan, Charles L. Brooks III
    Institutions : University of Michigan, NREL
    Date         : June 1, 2011

8.7.1 Tool updates

     install.com "clean" option instead of size removes binary object files
install.com automatically updates subdirectory makefiles, which are no longer
in version control Parallel builds go in separate directories from serial
builds, e.g. gnu_M instead of gnu

     NewCharmmTree links to directories instead of files

     prefx: corrected line numbering after ##KEYWORDS

     Perl scripts comply with "use strict"

     Revised some compiler options in Makefiles

Subversion committed: Revision 102

Files Modified:
install.com
test/rpt2xml.pl
test/test.com
tool/build.xml
tool/makemod.pl
tool/NewCharmmTree
tool/prefx.f90

Files Removed:
build/UNX/*.mk (42 machine-generated)

..............................................................................

8.7.2 Development omnibus
     Various changes since c36a6, including recent developer workshops at
the University of Michigan, May 12-14, 2011.
- Array sizes determined at start of run
- CUDA GPU code
- EIGHTSHELL parallel decomposition (work in progress)
- PARALLEL and ENSEMBLE can be used together
- Enhancements to harmonic center of mass restraints (HMCM)
- Improvements to multi-site lambda dynamics (MSLD)
- Various module declarations
- "Jackknife" keyword testing script
- prefx keyword corrections
- QM interface fixes
- Force field validation script

Subversion committed: Revision 107

Files Added:
doc/dimens.doc
source/machdep/paralgroups.src
source/nbonds/eightshell.src
source/util/storage.src
test/c36test/calc_mod.inp
test/c36test/grid_mctst.inp
test/cbenchtest/dhfr
test/cbenchtest/mbco
tool/gpu/*
tool/jackknife.py
tool/validate/ffcompare

Files Modified:
Too many to list, mostly due to array allocation

Files Removed:
source/dynamc/tbmtsp_ltm.src
source/dynamc/tbmtsp1_ltm.src

..............................................................................

8.7.3 Fixes for PULL with TORQue
     PULL_SETUP left SWIT and SFOR uninitialized under some conditions.
TORQ2 improperly accessed ISLCT(0). energy/epull.src initializes SWIT and SFOR
unconditionally in PULL_SETUP; don't let JS1 = 0 in TORQ2

Subversion committed: Revision 87

Files Involved:
source/energy/epull.src

..............................................................................

8.7.4 Remane variables named TYPE
     Although technically allowed, TYPE is a confusing variable name since
F95 uses the same word for derived types. In module psf, rename the atom type
array to ATYPE. In MPI wrappers, rename to TAG as in MPI documentation.

Subversion committed: Revisions 94 and 97

Files Involved:
doc/developer.doc
source/ltm/psf_ltm.src and 97 others

..............................................................................

8.7.5 Energy modules
     Explicit interfaces for subroutines such as EBOND, EANGLE, ENBOND ensure
that their callers use the correct number and types of arguments. Created new
modules ecntrl, eintern, eutil, enbond_mod, and pert_mod and corrected
subroutine call arguments as needed.

Subversion committed: Revision 95

Files Involved:
source/charmm/charmm_main.src, iniall.src, miscom.src
source/correl/anacor.src
source/dimb/dimbsub.src, nmdimb.src
source/dynamc/dcntrl.src, dims.src, dynamc4.src, dynamc.src, dynamcv.src
source/dynamc/dynamvv2.src, dynamvv.src, tamd.src, tps.src
source/energy/ecnstr.src, ecntrl.src, ediff.src, eintern.src, energy.src
source/energy/eutil.src, intere.src, multe.src
source/flucq/fluqdyn.src
source/image/eimage.src
source/mc/mcener.src, mcmini.src, mc.src
source/minmiz/egrad1.src, minmiz.src
source/misc/cross.src, fctall.src, galgor_ltm.src, genetic.src, hbuild.src
source/misc/sasini.src, testch.src
source/nbonds/enbonda.src, enbond.src
source/pert/block_ltm.src, block.src, epert.src, icfcnf.src, icpert.src
source/pert/pert.src, tsme.src
source/quantum/qub.src
source/rxncor/lupopt.src, path.src, travel2.src
source/vibran/vibblock.src, vibcom.src, vibio.src, vibsub.src

..............................................................................

8.7.6 Memory usage of CFF, CHEQ, DYNVV2 and HQBM
     Static memory footprint of some modules reduced.

Subversion committed: Revision 96

Files involved:
source/cff/cff_ltm.src        conditional compilation of array declarations
source/dynamc/dynamvv2.src    relocated some arrays from module psf
source/energy/hqbm.src        allocate RC?BIAS arrays dynamically
source/gener/genpsf.src       compile without CHEQ
source/ltm/psf_ltm.src        relocated some arrays to module dynvv2
source/minmiz/egrad1.src      compile without CHEQ
source/nbonds/cheqmodule.src  compile array declarations only with CHEQ

..............................................................................

8.7.7 Uninitiallied variables in TREK
     Observed intermittent failures of c22test/travel.inp. Running the test
in valgrind showed that some variables in rxncor/adiab.src were uninitialized.

Subversion committed: Revision 99

Files Involved:
source/rxncor/adiab.src  assigned initial values to SEGSTP, ENEMAX, and NLINMN

..............................................................................

8.7.8 test.com compatibility with Open MPI 1.4.3
      Open MPI 1.4.3 changed the naming convention for output files under
mpirun --output-filename. This made test.com fail to exclude the outputs
of rank>0 processes, making it impossible for compare.awk to give reliable
results.

Subversion committed: Revision 100

Files Involved:
test/test.com     use more flexible wildcards for mpirun output filenames

..............................................................................

8.7.9 Ignore intentional changes in test outputs
     Updated test output comparison ignore-lists to prevent certain changes
in c36a6 from being counted as failures.

Subversion committed: Revision 101

Files Involved:
test/charmmdif
test/seddir

..............................................................................

8.7.10 Miscellaneous fixes for XPLOR, GBSW, etc.

- valgrind on OSX
Develop instructions for setting up gdb and valgrind on Mac OS X so that they
are actually usable.

- DMCO selection
When selecting native contacts from different segments there seems to be
a problem. Added code to distinguish segid in dmcons selection. Now contact
map constraints between different segments with same resid work.

- array bounds
Valgrind shows out of bounds array accesses in AINDEX called by MAPIC when
deleting atoms.

- XPLOR PSF I/O
There is some problem with the reading or writing of of psf files when the
drude model is used.

Subversion committed: 113

Files Involved:
install.com
doc/energy.doc, gbsw.doc
source/adumb/cmds.src
source/charmm/iniall.src, miscom.src
source/dynamc/cveloci.src
source/energy/dmcons.src, ecnstr.src, gbsw.src, phmd.src
source/gener/modpsf.src
source/io/psfres.src
source/manip/cstran.src
source/minmiz/minmiz.src
source/nbonds/cheqmodule.src, grape.src, pme.src
test/c36test/test_drude.inp
test/data/drude_test.psf, drude_test_xplor.psf
test/data/drude_water.psf, drude_water_xplor.psf
tool/gpu/md3compile
tool/preflx

------------------------------------------------------------------------------

8.8 SGLD/SGLDfp update and RXSGLD development
    Developer    : Xiongwu Wu and Bernard R Brooks
    Institutions : NIH/NHLBI/LBC
    Date         : July 26, 2011

     Replica exchange with SGLD, RXSGLD, is implemented to allow explica
exchange simulation using the guiding effect, SGFT or TEMPSG, with or without
temperature change to define replicas. RXSGLD has a significant improvement
in exchange efficiency and can be applied to much larger systems than
temperature based replica exchange methods.
     SGLD/SGLDfp methods are updated to be consistent with publications.

Subversion committed: 114

Prefx Keys: SGLD, REPDSTR

Files Removed:
test/c36test/rexsgld.inp

Files Added:
test/c36test/rxsgld.inp

Files Modified:
doc/dynamc.doc, repdstr.doc, sgld.doc
source/dynamc/dcntrl.src, sgld.src
source/gener/repdstr.src
source/nbonds/nbutil.src

------------------------------------------------------------------------------

8.9 Pasteur Institute Developments
    Developer    : Arnaud BLONDEL
    Institution  : Institut Pasteur, Paris, France
    Date         : July 20, 2011

8.9.1 Update synchronisation with images update in HYBH
     Image Atom numbering evolve upon image update.
Tables for truncation hybrid hamiltonian scheme need a update synchronisation.
QTABLE logical changed to PTABLE integer to flag both primary and image atom
update. Consistency checks added.  New keyword to clear HYBrid Hamiltonian
scheme added.

Subversion committed: 116

Files involved:
source/image/upimag.src
source/nbonds/enbaexp.src, enbfast.src, ewald.src
source/pert/block.src, trunk_ltm.src

..............................................................................

8.9.2 Introduced CLHH keyword to clear HYBrid Hamiltonian scheme
     Keyword CLHH has been introduced in the block module to clear out the
HYBrid Hamiltonian scheme without clearing the block setup.

Subversion committed: 116

Files involved:
test/c36test/block_hybh.inp
doc/block.doc

------------------------------------------------------------------------------

8.10 SCPISM parallelization improvements and fixes
    Developer    : Sergio A. Hassan
    Institution  : CMM/DCB National Institutes of Health
    Date         : August 2, 2011

     Parallelization improvements, minor fixes, clean up unnecessary lines
left after f90 conversion.

Subversion committed: 118

Prefx Keys: SCPISM

Files Modified:
source/misc/scpism.src
doc/scpism.doc

==============================================================================

[9] c36b2 Change Log

     The following are introduced and modified during the development period
of August 15, 2011 through February 15, 2012.

9.1 Corrections to Makefile_xt4 for Cray XE6 and Cray Fortran compiler
    Name        : Chris Rowley and Benoit Roux
    Institutions: University of Chicago, Argonne National Lab
    Date        : October 17, 2011

Subversion: revision 132

     Our group has been using CHARMM on the latest generation Cray system
(XE6). There were some changes to the Makefile_xt4 and install.com that are
needed to build working executables on these systems. I want to update
the c36b1 branch with these changes, which are described below.

Makefile_xt4:
This makefile was not corrected to use the new _M paths for MPI compiled
executables. Also, this makefile currently assumes that the PGI compiler
is being used. I have made changes to this makefile to recognize user
options for other compilers and to change the fortran flags to reflect this.
It now supports the GNU, Pathscale, PGI, and Cray compilers.

install.com:
The Cray mpich libraries for the XE6 use default 32 bit integers, whereas
the Cray XT4 used default 64 bit integers. This causes segfaults in the MPI
compiled executables on XE6 systems. The IA64_MPI keyword should be a user
specified option for this machine type until there is a more permanent fix.

     Also, Cray has encouraged us to move to the Cray Fortran compiler,
which gives better performance on XE6 systems. To support this, we need
to add a new keyword to install.com, CRAYFTN. Also, the Cray compiler is
pickier about syntax than the other compilers. It refuses to compile code
where a comma is used to separate a write statement from its string arguments.
Also, it requires that strings that are split over two lines have use a line
continuation character on the second line. Fixing this required about a dozen
minor syntactical corrections in different parts of the source code.
There is no functional effect of these changes. The following source files
are affected:

Files modified:
build/UNX/Makefile_xt4
install.com
source/charmm/iniall.src
source/dynamc/sglds.src
source/energy/eintern_table.src
source/manip/corman.src
source/misc/fctall.src
source/misc/fitcharge.src
source/misc/mmpt.src
source/pert/lambdadyn.src
source/rxncor/travel2.src

------------------------------------------------------------------------------

9.2 Lift the restriction of the requirement of 2**N processors
    Name        : Lei Huang and Benoit Roux
    Institutions: University of Chicago, Argonne National Lab
    Date        : January 23, 2012

Subversion: revision 150

     3D FFT code in CHARMM requires that the number of processors has to be
the power of 2. With our fixed code, only the largest number of the power
of 2 of cores will do 3D FFT work (e.g., 8 out of total 12 cores) and the
left cores are idle. Although there are some loss in the efficiency,
the loss are very small in most cases since the fraction of time on 3D FFT
is generally less than 2~3% in serial version of CHARMM. Now any number
of processors are acceptable to run CHARMM. Prefx key "+GENCOMM" is REQUIRED
to build parallel CHARMM versions.

File modified:
source/nbonds/pmeutil.src

------------------------------------------------------------------------------

9.3 Fixes for TMD, PHMD, FBETA, DELTIC and others
    Developer    : Michael Crowley, Mike Garrahan, Charles L. Brooks III
                   Lennart Nilsson, Stefan Boresch
    Institutions : University of Michigan, NREL
    Date         : January 31, 2012

Subversion: Revisions 144 and 152

9.3.1 Added an argument to subroutine FINCYC to compile with TMD enabled.
Files Involved:
source/dynamc/dcntrl.src
source/dynamc/tamd.src
source/dynamc/tmd.src
source/energy/eutil.src
source/minmiz/minmiz.src

9.3.2 Corrected a PHMD output format string which caused a Fortran runtime
error.
Files Involved:
source/energy/phmd.src

9.3.3 Corrected arguments to chmdealloc in subroutine dealloc_cnst.
Files Involved:
source/ltm/cnst_ltm.src

9.3.4 Recognized T3E as obsolete.
Files Involved:
source/ltm/aaa_sanity_checks.src

9.3.5 Eliminated some unsafe CHEQ logic from subroutines mkimat and mkimat2.
Files Involved:
source/image/upimag.src

9.3.6 Attempt to set FBETA got a spurious warning that FBETA was
"not yet filled."
Files Involved:
source/manip/scalar.src - allocate FBETA as needed

9.3.7 Deleting atoms caused CHARMM to segfault.
Files Involved:
source/gener/modpsf.src - revised PATIC and DELTIC as on trunk

------------------------------------------------------------------------------

9.4 SGLD Enhancements
    Developer    : Xiongwu Wu and Bernard R Brooks
    Institutions : NIH/NHLBI/LBC
    Date         : February 10, 2012

Subversion: Revisions 153, 154, and 156
Prefx Keys: SGLD, REPDSTR

     Velocities and net forces of the center of mass are removed in SGMD/SGLD
integration. A input flag, SGMVCM, is used if the center of mass is allowed
to move.
     When SGLD is applied to only a part of system, reweighting can be done
with 'anal on' before dynamics command

Files Modified:
doc/sgld.doc
source/charmm/iniall.src
source/dynamc/dcntrl.src
source/dynamc/sglds.src
source/energy/energy.src
source/nbonds/enbips.src
source/nbonds/enbond.src

------------------------------------------------------------------------------

9.5 Installation and Documentation
    Developer    : Rick Venable
    Institutions : NIH/NHLBI/LBC
    Date         : January 21, 2012

Subversion: Revisions 146 and 148

     References to G77, F77, PVM, SGI, Sun, etc. are no longer printed by
the help message, and the parsing of many of these has been disabled
(via comment). MPIF90 has been made the default for the M option.
The parsing of -KEYWORD has been fixed, so that keywords may be selectively
removed from pref.dat.  Options 'clean' and 'distclean' documented.
     Updated usage.doc to include pointer to dimens.doc, slight changes
to Control section; added info on other array settings besides CHSIZE to
dimens.doc.
     The P21 example in crystl.doc has an error in the image centering command

Files Involved:
install.com
doc/dimens.doc
doc/install.doc
doc/usage.doc
doc/crystl.doc
