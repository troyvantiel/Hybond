* Test of Harmonic Atom Constraints (using new atom selection syntax).
*

stream datadir.def
BOMLEV -2
OPEN READ FORM UNIT 1 NAME  @0top9.rtf
READ RTF  CARD UNIT 1
CLOSE UNIT 1
OPEN READ FORM UNIT 2 NAME  @0param6.prm
READ PARA CARD UNIT 2
CLOSE UNIT 2

READ      SEQUENCE  CARDS
* LYSOZYME SEQUENCE
*
  129
LYS VAL PHE GLY ARG CYS GLU LEU ALA ALA 
ALA MET LYS ARG HIS GLY LEU ASP ASN TYR
ARG GLY TYR SER LEU GLY ASN TRP VAL CYS 
ALA ALA LYS PHE GLU SER ASN PHE ASN THR
GLN ALA THR ASN ARG ASP THR ASN GLY SER 
THR ASP TYR GLY ILE LEU GLN ILE ASN SER
ARG TRP TRP CYS ASP ASN GLY ARG THR PRO 
GLY SER ARG ASN LEU CYS ASN ILE PRO CYS
SER ALA LEU LEU SER SER ASP ILE THR ALA 
SER VAL ASN CYS ALA LYS LYS ILE VAL SER
ASP GLY ASN GLY MET ASN ALA TRP VAL ALA 
TRP ARG ASN ARG CYS LYS GLY THR ASP VAL
GLN ALA TRP ILE ARG GLY CYS ARG LEU
GENERATE ENZ
PATCH DISU ENZ   6 ENZ 127
PATCH DISU ENZ  30 ENZ 115
PATCH DISU ENZ  64 ENZ  80
PATCH DISU ENZ  76 ENZ  94

OPEN READ CARD UNIT 13 NAME @0lysozyme.crd
READ COOR CARD UNIT 13
COOR COPY COMP
!!!!! 1
CONS harm SELE atom * 1 * END  force 1.
PRINT CONS
CONS harm mass SELE atom * 1 * END  force 1.
PRINT CONS
!!!!! 2
CONS HARM FORCE -10. SELE atom * * CA  END
PRINT CONS
CONS HARM force 10. SELE .NOT. ( atom * *  SG .OR. atom * * NZ ) END
PRINT CONS
CONS HARM SELE  BYNUM 1:1001   END
PRINT CONS
!!!!! 3
CONS  HARM FORCE 1.0 SELE atom * * CA .OR. atom * * N .OR. -
       atom * * C .OR.  atom * * O  END
cons harm SELE atom ENZ 6 SG END force  100.
!!!!! 4
!! 20-OCT-91, modify to CARD format CONS I/O
OPEN WRITE UNIT 20 FORM NAME @9TESTCONS.DAT
WRITE CONS UNIT 20
*CONSTRAINTS FOR TESTCONS
*
HBONDS BEST IHBFRQ 50 CUTHB 4.50 CUTHA 65.0 CTONHB 98.0 CTOFHB 99.0 -
       CTOFHA 60.0 CTONHA 55.0
MINI SD              -
   NSTEP 4  STEP  0.05     IHBFRQ 0 INBFRQ 4 NPRINT 1 -
   CUTNB 8.00 WMIN 2.6 -
   CTONNB 98.0 CTOFNB 99.0 CTONHB 98.0 CTOFHB 99.0

!!!!! 5
!ANAL
!BUILD ATOM EC
!ADD STATS SUM $ PLACE STRUCTURE $
!PRINT TABLE PRETTY FRAC 1
!keeponly sele resid ALL end
!PRINT TABLE PRETTY FRAC 7
!END

!!!!! 6
CONS HARM SELE  BYNUM 1:1001 END force 500. COMP
PRINT CONS

!!!!! 7
!ANAL
!COMPARE CONS 20
!BUILD DIFF ATOM EC
!ADD STATS SUM $ PLACE STRUCTURE $
!keeponly sele resid ALL end
!PRINT TABLE PRETTY FRAC 7
!BUILD ATOM ENERGY
!ADD STATS SUM $ PLACE STRUCTURE $
!keeponly sele resid ALL end
!PRINT TABLE PRETTY FRAC 7
!END

!!!!! 8
MINI SD NSTEP 1 INBFRQ 0 STEP 0.05
