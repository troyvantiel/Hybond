*  H2O TEST RUN FOR NOSE-HOOVER DYNAMICS
*  PART I (SINGLE THERMOBATH)
*

if ?NUMNODE .gt. 1 then
 echo "Test NOT performed."
 stop
endif
if ?olddyn .ne. 1 then
 echo "Test NOT performed."
 stop
endif

stream datadir.def
WRNLEV 4
BOMBLEV -2

OPEN READ FORM UNIT 1 NAME  @0toph8.rtf
READ RTF  CARD UNIT 1
OPEN READ FORM UNIT 2 NAME  @0param3.prm
READ PARAMETER CARD UNIT 2
READ SEQUENCE WATER 125
GENERATE

SET 6 15.517182
SET 7 15.517182
SET 8 15.517182
OPEN UNIT 8 READ CARD NAME @0cubic.img
READ IMAG UNIT 8
PRINT IMAGES TRAN

OPEN UNIT 3 READ CARD NAME @0wat125.crd
READ COORD CARD UNIT 3

IMAGE BYGROUPS XCEN 0.0 YCEN 0.0 ZCEN 0.0 SELE ALL END

SHAKE BOND ANGLE TOL 1.0D-9

UPDATE INBFRQ 5 IHBFRQ 0  -
       CUTIM 8.0  IMGFRQ 5 -
       ATOM SHIFT VATOM VSWITCH -
       CUTNB 8.0  CTOFNB 7.5   CTONNB 6.5  EPS 1.0 CDIE

OPEN WRITE UNIT 31 CARD NAME @9FOR015.RST

DYNA NOSE QREF 50.0 TREF 300.0 NCYC 5 FIRSTT 100 -
     STRT NSTEP 100  TIME 0.001 NPRINT 10 IPRFRQ 100 -
     IUNREA -1 IUNWRI 31  IUNCRD -1  IUNVEL  -1 -
     KUNIT  -1  NSAVC 50  NSAVV  50  ISVFRQ 1000

@testcheck ?tote -243.82431 0.0001 nose1_1_tot

energy

@testcheck ?ener -301.10282 0.0001 nose1_1_ener
@testcheck ?elec -121.87805 0.00001 nose1_1_elec
@testcheck ?vdw   -77.94733 0.00001 nose1_1_vdw

OPEN WRITE UNIT 31 CARD NAME @9FOR016.RST
OPEN READ  UNIT 30 CARD NAME @9FOR015.RST
OPEN WRITE UNIT 42 CARD NAME @9FOR017.SS

DYNA NOSE QREF 50.0 TREF 300.0 NCYC 5 - 
     REST NSTEP 100  TIME 0.001 NPRINT 10 IPRFRQ 100 - 
     IUNREA 30 IUNWRI 31  IUNCRD -1  IUNVEL  -1 -      
     KUNIT  -1  NSAVC 50  NSAVV  50  ISVFRQ 100 -
     IUNOS  42  NSNOS 10 

@testcheck ?tote -243.68987 0.0001 nose1_2_tot

energy

@testcheck ?ener -280.70678 0.00001 nose1_2_ener
@testcheck ?elec -114.25249 0.00001 nose1_2_elec
@testcheck ?vdw   -81.88856 0.00001 nose1_2_vdw

STOP
