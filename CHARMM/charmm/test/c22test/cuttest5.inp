* Cuttest5
*

! Tests Non-bond cutoff options: van der Waals interactions only
! CUTNB 8.0 CTOFNB 7.5 EPS 1.0 E14FAC 0.4 WMIN 1.5
! (1) ATOM CDIE SWITCH VATOM VSWITCH CTONNB 6.5
! (2) ATOM CDIE SWITCH VATOM VSHIFT  CTONNB 6.5
! (3) ATOM CDIE SWITCH VATOM VSWITCH CTONNB 7.5
! By Stephen Fleischman 11/91
!
! Compare derivatives of selected atoms to the numerical derivatives.
! The difference should be less than 0.008.  The tolerance in the TEST
! FIRST command is set very small so that all of the specified 
! derivatives will be printed out.

stream datadir.def
set testname cuttest5
format (F20.7)

bomlev -2
OPEN READ FORM UNIT 1 NAME @0toph19.rtf
READ RTF  CARD UNIT 1
CLOSE UNIT 1
OPEN READ FORM UNIT 2 NAME @0param19.prm
READ PARAMETER CARD UNIT 2
CLOSE UNIT 2

READ      SEQUENCE  CARDS
*PTI SEQUENCE
*
   58
ARG PRO ASP PHE CYS LEU GLU PRO PRO TYR 
THR GLY PRO CYS LYS ALA ARG ILE ILE ARG
TYR PHE TYR ASN ALA LYS ALA GLY LEU CYS 
GLN THR PHE VAL TYR GLY GLY CYS ARG ALA
LYS ARG ASN ASN PHE LYS SER ALA GLU ASP 
CYS MET ARG THR CYS GLY GLY ALA
GENERATE  MAIN
PATCH DISU MAIN  5 MAIN 55
PATCH DISU MAIN 14 MAIN 38
PATCH DISU MAIN 30 MAIN 51
READ SEQUENCE WATER 4
GENERATE SOLV NOANGLE

! define atoms for force testing
DEFINE FATOMS SELE SEGID MAIN .AND. RESID 12 END
calc nckcoor = ?nsel * 3
OPEN UNIT 3 READ CARD NAME @0bpti.crd
READ COORD CARD UNIT 3
CLOSE UNIT 3
COOR COPY COMP

SKIPE ELEC

!{1. ATOM/CDIE/SWITCH/VATOM/VSWITCH CTONNB 6.5}
set tt 1
set sp slow
FASTER OFF
ENERGY ATOM CDIE SWITCH VATOM VSWITCH VDIS IHBFRQ 0 -
CUTNB 8.0  CTOFNB 7.5  CTONNB 6.5  EPS 1.0  E14FAC 0.4  WMIN 1.5
set refval -5.55984
@testcheck ?ener  @refval .000001 @testname_e_@tt_@sp
COOR FORCE COMP SELE FATOMS END
PRINT COOR COMP SELE FATOMS END
TEST FIRST SELE FATOMS END STEP 0.00001 TOL 0.
TEST FIRST SELE FATOMS END STEP 0.00001 TOL 0.000001
@testcheck ?nok @nckcoor .000001 @testname_f_@tt_@sp
FASTER ON
ENERGY
set sp fast
@testcheck ?ener  @refval .000001 @testname_e_@tt_@sp
COOR FORCE COMP SELE FATOMS END
PRINT COOR COMP SELE FATOMS END

!{2. ATOM/CDIE/SWITCH/VATOM/VSHIFT CTONNB 6.5}
set tt 2
set sp slow
FASTER OFF
ENERGY ATOM CDIE SWIT VATOM VSHIF VDIS CTONNB 6.5
COOR FORCE COMP SELE FATOMS END
set refval 110.25847
@testcheck ?ener  @refval .000001 @testname_e_@tt_@sp
PRINT COOR COMP SELE FATOMS END
TEST FIRST SELE FATOMS END STEP 0.00001 TOL 0.
TEST FIRST SELE FATOMS END STEP 0.00001 TOL 0.000001
@testcheck ?nok @nckcoor .000001 @testname_f_@tt_@sp
FASTER ON
ENERGY
set sp fast
@testcheck ?ener  @refval .000001 @testname_e_@tt_@sp
COOR FORCE COMP SELE FATOMS END
PRINT COOR COMP SELE FATOMS END

!{3. ATOM/CDIE/SWITCH/VATOM/VSWITCH CTONNB 7.5}
set tt 3
set sp slow
FASTER OFF
ENERGY ATOM CDIE SWITCH VATOM VSWIT VDIS CTONNB 7.5
COOR FORCE COMP SELE FATOMS END
set refval -22.71650
@testcheck ?ener  @refval .000001 @testname_e_@tt_@sp
PRINT COOR COMP SELE FATOMS END
TEST FIRST SELE FATOMS END STEP 0.00001 TOL 0.
TEST FIRST SELE FATOMS END STEP 0.00001 TOL 0.000001
@testcheck ?nok @nckcoor .000001 @testname_f_@tt_@sp
FASTER ON
ENERGY
set sp fast
@testcheck ?ener  @refval .000001 @testname_e_@tt_@sp
COOR FORCE COMP SELE FATOMS END
PRINT COOR COMP SELE FATOMS END

STOP
