* Cuttest1
*

! Tests Non-bond cutoff options:
! CUTNB 8.0 CTONNB 7.5 CTOFNB 7.5 EPS 1.0 E14FAC 0.4 WMIN 1.5
! (1) ATOM CDIE SHIFT  VATOM VSWITCH
! (2) ATOM CDIE SWITCH VATOM VSWITCH
! (3) ATOM CDIE FSHIFT VATOM VSWITCH
! (4) ATOM RDIE SHIFT  VATOM VSWITCH
! (5) ATOM RDIE SWITCH VATOM VSWITCH
! By Stephen Fleischman 11/91
!
! Compare derivatives of selected atoms to the numerical derivatives.
! The difference should be less than 0.008.  The tolerance in the TEST
! FIRST command is set very small so that all of the specified 
! derivatives will be printed out.

stream datadir.def
bomlev -2
OPEN READ FORM UNIT 1 NAME @0toph19.rtf
READ RTF  CARD UNIT 1
CLOSE UNIT 1
OPEN READ FORM UNIT 2 NAME @0param19.prm
READ PARAMETER CARD UNIT 2
CLOSE UNIT 2

READ      SEQUENCE  CARDS
*PTI SEQUENCE
*
   58
ARG PRO ASP PHE CYS LEU GLU PRO PRO TYR 
THR GLY PRO CYS LYS ALA ARG ILE ILE ARG
TYR PHE TYR ASN ALA LYS ALA GLY LEU CYS 
GLN THR PHE VAL TYR GLY GLY CYS ARG ALA
LYS ARG ASN ASN PHE LYS SER ALA GLU ASP 
CYS MET ARG THR CYS GLY GLY ALA
GENERATE  MAIN
PATCH DISU MAIN  5 MAIN 55
PATCH DISU MAIN 14 MAIN 38
PATCH DISU MAIN 30 MAIN 51
READ SEQUENCE WATER 4
GENERATE SOLV NOANGLE

! define atoms for force testing
DEFINE FATOMS SELE SEGID MAIN .AND. RESID 12 END
calc nckcoor = 3 * ?nsel
OPEN UNIT 3 READ CARD NAME @0bpti.crd
READ COORD CARD UNIT 3
CLOSE UNIT 3
COOR COPY COMP

!================================================================
!{1. TRUNC/CDIE/SHIFT/VATOM/VSWITCH}
FASTER OFF
ENERGY ATOM CDIE SHIF VATOM VSWI VDIS IHBFRQ 0 -
  CUTNB 8.0  CTOFNB 7.5  CTONNB 7.5  EPS 1.0  E14FAC 0.4  WMIN 1.5
COOR FORCE COMP SELE FATOMS END
PRINT COOR COMP SELE FATOMS END
@testcheck ?elec -1671.41014 .000001 cuttest1_e1slow
@testcheck ?vdw  -288.68692  .000001 cuttest1_v1slow
TEST FIRST SELE FATOMS END STEP 0.00001 TOL 0.00000
TEST FIRST SELE FATOMS END STEP 0.00001 TOL 0.000001
@testcheck ?nok @nckcoor .000001 cuttest1_f1slow

FASTER ON
ENERGY
COOR FORCE COMP SELE FATOMS END
PRINT COOR COMP SELE FATOMS END
@testcheck ?elec -1671.41014 .000001 cuttest1_e1fast
@testcheck ?vdw  -288.68692 .000001 cuttest1_v1fast


!================================================================
!{2. TRUNC/CDIE/SWITCH/VATOM/VSWITCH}
FASTER OFF
ENERGY ATOM CDIE SWIT VATOM VSWI VDIS
@testcheck ?elec -2234.51648 .00001 cuttest1_e2slow
@testcheck ?vdw  -288.68692  .00001 cuttest1_v2slow
COOR FORCE COMP SELE FATOMS END
PRINT COOR COMP SELE FATOMS END
TEST FIRST SELE FATOMS END STEP 0.00001 TOL 0.
TEST FIRST SELE FATOMS END STEP 0.00001 TOL 0.000001
@testcheck ?nok @nckcoor .000001 cuttest2_f2slow
FASTER ON
ENERGY
COOR FORCE COMP SELE FATOMS END
PRINT COOR COMP SELE FATOMS END
@testcheck ?elec -2234.51648 .00001 cuttest1_e2fast
@testcheck ?vdw  -288.68692  .00001 cuttest1_v2fast


!================================================================
!{3. TRUNC/CIDE/FSHIFT/VATOM/VSWITCH}
FASTER OFF
ENERGY ATOM CDIE FSHIF VATOM VSWI VDIS
@testcheck ?elec -921.89792  .00001 cuttest1_e3slow
@testcheck ?vdw  -288.68692  .00001 cuttest1_v3slow
COOR FORCE COMP SELE FATOMS END
PRINT COOR COMP SELE FATOMS END
TEST FIRST SELE FATOMS END STEP 0.00001 TOL 0.
TEST FIRST SELE FATOMS END STEP 0.00001 TOL 0.000001
@testcheck ?nok @nckcoor .000001 cuttest1_f3slow
FASTER ON
ENERGY
COOR FORCE COMP SELE FATOMS END
PRINT COOR COMP SELE FATOMS END
@testcheck ?elec -921.89792 .000001 cuttest1_e3fast
@testcheck ?vdw  -288.68692 .000001 cuttest1_v3fast


!================================================================
!{4. TRUNC/RDIE/SHIFT/VATOM/VSWITCH}
FASTER OFF
ENERGY ATOM RDIE SHIF VATOM VSWI VDIS
@testcheck ?elec -691.63197  .00001 cuttest1_e4slow
@testcheck ?vdw  -288.68692  .00001 cuttest1_v4slow
COOR FORCE COMP SELE FATOMS END
PRINT COOR COMP SELE FATOMS END
TEST FIRST SELE FATOMS END STEP 0.00001 TOL 0.
TEST FIRST SELE FATOMS END STEP 0.00001 TOL 0.000001
@testcheck ?nok @nckcoor .000001 cuttest1_f4slow
FASTER ON
ENERGY
COOR FORCE COMP SELE FATOMS END
PRINT COOR COMP SELE FATOMS END
@testcheck ?elec -691.63197 .000001 cuttest1_e4fast
@testcheck ?vdw  -288.68692 .000001 cuttest1_v4fast


!================================================================
!{5. TRUNC/RDIE/SWITCH/VATOM/VSWITCH}
FASTER OFF
ENERGY ATOM RDIE SWIT VATOM VSWI VDIS
@testcheck ?elec -892.35671 .000001 cuttest1_e5slow
@testcheck ?vdw  -288.68692 .000001 cuttest1_v5slow
COOR FORCE COMP SELE FATOMS END
PRINT COOR COMP SELE FATOMS END
TEST FIRST SELE FATOMS END STEP 0.00001 TOL 0.
TEST FIRST SELE FATOMS END STEP 0.00001 TOL 0.000001
@testcheck ?nok @nckcoor .000001 cuttest1_f5slow
FASTER ON
ENERGY
COOR FORCE COMP SELE FATOMS END
PRINT COOR COMP SELE FATOMS END
@testcheck ?elec -892.35671 .000001 cuttest1_e5fast
@testcheck ?vdw  -288.68692 .000001 cuttest1_v5fast

STOP
