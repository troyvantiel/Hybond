* NACL TEST RUN -- CALCULATION OF MADELUNG CONSTANT 
* TEST OF EWALD SUM CALCULATION 
*

stream datadir.def
set testname ewions
format (F20.7)

READ RTF CARD
* NACL rtf file
*
   19    1                ! Version number
MASS    99 NA    22.99    ! Point Charge for sodium
MASS    96 CL    35.45    ! Point Charge for Chlorine
RESI  NA   1.0            ! TEST Charge 
GROUP
ATOM   NA   NA  +1.0
PATCH FIRST NONE LAST NONE
RESI   CL -1.0            ! TEST Charge 
GROUP
ATOM   CL   CL  -1.0
PATCH FIRST NONE LAST NONE
END

READ PARAMETER CARD
* NACL parameters
*
NONBONDED  NBXMOD 5  ATOM CDIEL SHIFT VATOM VDISTANCE VSHIFT -
CUTNB 8.0  CTOFNB 7.5  CTONNB 6.5  EPS 1.0  E14FAC 0.4  WMIN 1.5
!
!                  Emin       Rmin
!                  (kcal/mol) (A)
NA       0.000     -0.000        1.09  ! Na +1 charge 
CL       0.000     -0.000        1.09  ! Cl -1 charge
END


! Read in sequence for 22 pairs of NaCl
READ SEQU NA 108
READ SEQU CL 108
GENERATE IONS

! Read in coordinates for 32 pairs of NaCl
READ COOR CARD
* COORDINATES SET ON NA-CL TYPE LATTICE        
*
  216
    1    1 NA   NA    -8.55837  -8.55837  -5.26663 IONS    1   1.00000
    2    2 NA   NA    -8.55837  -8.55837   1.31663 IONS    2   1.00000
    3    3 NA   NA    -8.55837  -8.55837   7.90000 IONS    3   1.00000
    4    4 NA   NA    -8.55837  -5.26663  -8.55837 IONS    4   1.00000
    5    5 NA   NA    -8.55837  -5.26663  -1.97500 IONS    5   1.00000
    6    6 NA   NA    -8.55837  -5.26663   4.60837 IONS    6   1.00000
    7    7 NA   NA    -8.55837  -1.97500  -5.26663 IONS    7   1.00000
    8    8 NA   NA    -8.55837  -1.97500   1.31663 IONS    8   1.00000
    9    9 NA   NA    -8.55837  -1.97500   7.90000 IONS    9   1.00000
   10   10 NA   NA    -8.55837   1.31663  -8.55837 IONS   10   1.00000
   11   11 NA   NA    -8.55837   1.31663  -1.97500 IONS   11   1.00000
   12   12 NA   NA    -8.55837   1.31663   4.60837 IONS   12   1.00000
   13   13 NA   NA    -8.55837   4.60837  -5.26663 IONS   13   1.00000
   14   14 NA   NA    -8.55837   4.60837   1.31663 IONS   14   1.00000
   15   15 NA   NA    -8.55837   4.60837   7.90000 IONS   15   1.00000
   16   16 NA   NA    -8.55837   7.90000  -8.55837 IONS   16   1.00000
   17   17 NA   NA    -8.55837   7.90000  -1.97500 IONS   17   1.00000
   18   18 NA   NA    -8.55837   7.90000   4.60837 IONS   18   1.00000
   19   19 NA   NA    -5.26663  -8.55837  -8.55837 IONS   19   1.00000
   20   20 NA   NA    -5.26663  -8.55837  -1.97500 IONS   20   1.00000
   21   21 NA   NA    -5.26663  -8.55837   4.60837 IONS   21   1.00000
   22   22 NA   NA    -5.26663  -5.26663  -5.26663 IONS   22   1.00000
   23   23 NA   NA    -5.26663  -5.26663   1.31663 IONS   23   1.00000
   24   24 NA   NA    -5.26663  -5.26663   7.90000 IONS   24   1.00000
   25   25 NA   NA    -5.26663  -1.97500  -8.55837 IONS   25   1.00000
   26   26 NA   NA    -5.26663  -1.97500  -1.97500 IONS   26   1.00000
   27   27 NA   NA    -5.26663  -1.97500   4.60837 IONS   27   1.00000
   28   28 NA   NA    -5.26663   1.31663  -5.26663 IONS   28   1.00000
   29   29 NA   NA    -5.26663   1.31663   1.31663 IONS   29   1.00000
   30   30 NA   NA    -5.26663   1.31663   7.90000 IONS   30   1.00000
   31   31 NA   NA    -5.26663   4.60837  -8.55837 IONS   31   1.00000
   32   32 NA   NA    -5.26663   4.60837  -1.97500 IONS   32   1.00000
   33   33 NA   NA    -5.26663   4.60837   4.60837 IONS   33   1.00000
   34   34 NA   NA    -5.26663   7.90000  -5.26663 IONS   34   1.00000
   35   35 NA   NA    -5.26663   7.90000   1.31663 IONS   35   1.00000
   36   36 NA   NA    -5.26663   7.90000   7.90000 IONS   36   1.00000
   37   37 NA   NA    -1.97500  -8.55837  -5.26663 IONS   37   1.00000
   38   38 NA   NA    -1.97500  -8.55837   1.31663 IONS   38   1.00000
   39   39 NA   NA    -1.97500  -8.55837   7.90000 IONS   39   1.00000
   40   40 NA   NA    -1.97500  -5.26663  -8.55837 IONS   40   1.00000
   41   41 NA   NA    -1.97500  -5.26663  -1.97500 IONS   41   1.00000
   42   42 NA   NA    -1.97500  -5.26663   4.60837 IONS   42   1.00000
   43   43 NA   NA    -1.97500  -1.97500  -5.26663 IONS   43   1.00000
   44   44 NA   NA    -1.97500  -1.97500   1.31663 IONS   44   1.00000
   45   45 NA   NA    -1.97500  -1.97500   7.90000 IONS   45   1.00000
   46   46 NA   NA    -1.97500   1.31663  -8.55837 IONS   46   1.00000
   47   47 NA   NA    -1.97500   1.31663  -1.97500 IONS   47   1.00000
   48   48 NA   NA    -1.97500   1.31663   4.60837 IONS   48   1.00000
   49   49 NA   NA    -1.97500   4.60837  -5.26663 IONS   49   1.00000
   50   50 NA   NA    -1.97500   4.60837   1.31663 IONS   50   1.00000
   51   51 NA   NA    -1.97500   4.60837   7.90000 IONS   51   1.00000
   52   52 NA   NA    -1.97500   7.90000  -8.55837 IONS   52   1.00000
   53   53 NA   NA    -1.97500   7.90000  -1.97500 IONS   53   1.00000
   54   54 NA   NA    -1.97500   7.90000   4.60837 IONS   54   1.00000
   55   55 NA   NA     1.31663  -8.55837  -8.55837 IONS   55   1.00000
   56   56 NA   NA     1.31663  -8.55837  -1.97500 IONS   56   1.00000
   57   57 NA   NA     1.31663  -8.55837   4.60837 IONS   57   1.00000
   58   58 NA   NA     1.31663  -5.26663  -5.26663 IONS   58   1.00000
   59   59 NA   NA     1.31663  -5.26663   1.31663 IONS   59   1.00000
   60   60 NA   NA     1.31663  -5.26663   7.90000 IONS   60   1.00000
   61   61 NA   NA     1.31663  -1.97500  -8.55837 IONS   61   1.00000
   62   62 NA   NA     1.31663  -1.97500  -1.97500 IONS   62   1.00000
   63   63 NA   NA     1.31663  -1.97500   4.60837 IONS   63   1.00000
   64   64 NA   NA     1.31663   1.31663  -5.26663 IONS   64   1.00000
   65   65 NA   NA     1.31663   1.31663   1.31663 IONS   65   1.00000
   66   66 NA   NA     1.31663   1.31663   7.90000 IONS   66   1.00000
   67   67 NA   NA     1.31663   4.60837  -8.55837 IONS   67   1.00000
   68   68 NA   NA     1.31663   4.60837  -1.97500 IONS   68   1.00000
   69   69 NA   NA     1.31663   4.60837   4.60837 IONS   69   1.00000
   70   70 NA   NA     1.31663   7.90000  -5.26663 IONS   70   1.00000
   71   71 NA   NA     1.31663   7.90000   1.31663 IONS   71   1.00000
   72   72 NA   NA     1.31663   7.90000   7.90000 IONS   72   1.00000
   73   73 NA   NA     4.60837  -8.55837  -5.26663 IONS   73   1.00000
   74   74 NA   NA     4.60837  -8.55837   1.31663 IONS   74   1.00000
   75   75 NA   NA     4.60837  -8.55837   7.90000 IONS   75   1.00000
   76   76 NA   NA     4.60837  -5.26663  -8.55837 IONS   76   1.00000
   77   77 NA   NA     4.60837  -5.26663  -1.97500 IONS   77   1.00000
   78   78 NA   NA     4.60837  -5.26663   4.60837 IONS   78   1.00000
   79   79 NA   NA     4.60837  -1.97500  -5.26663 IONS   79   1.00000
   80   80 NA   NA     4.60837  -1.97500   1.31663 IONS   80   1.00000
   81   81 NA   NA     4.60837  -1.97500   7.90000 IONS   81   1.00000
   82   82 NA   NA     4.60837   1.31663  -8.55837 IONS   82   1.00000
   83   83 NA   NA     4.60837   1.31663  -1.97500 IONS   83   1.00000
   84   84 NA   NA     4.60837   1.31663   4.60837 IONS   84   1.00000
   85   85 NA   NA     4.60837   4.60837  -5.26663 IONS   85   1.00000
   86   86 NA   NA     4.60837   4.60837   1.31663 IONS   86   1.00000
   87   87 NA   NA     4.60837   4.60837   7.90000 IONS   87   1.00000
   88   88 NA   NA     4.60837   7.90000  -8.55837 IONS   88   1.00000
   89   89 NA   NA     4.60837   7.90000  -1.97500 IONS   89   1.00000
   90   90 NA   NA     4.60837   7.90000   4.60837 IONS   90   1.00000
   91   91 NA   NA     7.90000  -8.55837  -8.55837 IONS   91   1.00000
   92   92 NA   NA     7.90000  -8.55837  -1.97500 IONS   92   1.00000
   93   93 NA   NA     7.90000  -8.55837   4.60837 IONS   93   1.00000
   94   94 NA   NA     7.90000  -5.26663  -5.26663 IONS   94   1.00000
   95   95 NA   NA     7.90000  -5.26663   1.31663 IONS   95   1.00000
   96   96 NA   NA     7.90000  -5.26663   7.90000 IONS   96   1.00000
   97   97 NA   NA     7.90000  -1.97500  -8.55837 IONS   97   1.00000
   98   98 NA   NA     7.90000  -1.97500  -1.97500 IONS   98   1.00000
   99   99 NA   NA     7.90000  -1.97500   4.60837 IONS   99   1.00000
  100  100 NA   NA     7.90000   1.31663  -5.26663 IONS  100   1.00000
  101  101 NA   NA     7.90000   1.31663   1.31663 IONS  101   1.00000
  102  102 NA   NA     7.90000   1.31663   7.90000 IONS  102   1.00000
  103  103 NA   NA     7.90000   4.60837  -8.55837 IONS  103   1.00000
  104  104 NA   NA     7.90000   4.60837  -1.97500 IONS  104   1.00000
  105  105 NA   NA     7.90000   4.60837   4.60837 IONS  105   1.00000
  106  106 NA   NA     7.90000   7.90000  -5.26663 IONS  106   1.00000
  107  107 NA   NA     7.90000   7.90000   1.31663 IONS  107   1.00000
  108  108 NA   NA     7.90000   7.90000   7.90000 IONS  108   1.00000
  109  109 CL   CL    -5.26663  -5.26663  -1.97500 IONS  109  -1.00000
  110  110 CL   CL    -5.26663  -5.26663   4.60837 IONS  110  -1.00000
  111  111 CL   CL    -5.26663  -5.26663  -8.55837 IONS  111  -1.00000
  112  112 CL   CL    -5.26663  -1.97500  -5.26663 IONS  112  -1.00000
  113  113 CL   CL    -5.26663  -1.97500   1.31663 IONS  113  -1.00000
  114  114 CL   CL    -5.26663  -1.97500   7.90000 IONS  114  -1.00000
  115  115 CL   CL    -5.26663   1.31663  -1.97500 IONS  115  -1.00000
  116  116 CL   CL    -5.26663   1.31663   4.60837 IONS  116  -1.00000
  117  117 CL   CL    -5.26663   1.31663  -8.55837 IONS  117  -1.00000
  118  118 CL   CL    -5.26663   4.60837  -5.26663 IONS  118  -1.00000
  119  119 CL   CL    -5.26663   4.60837   1.31663 IONS  119  -1.00000
  120  120 CL   CL    -5.26663   4.60837   7.90000 IONS  120  -1.00000
  121  121 CL   CL    -5.26663   7.90000  -1.97500 IONS  121  -1.00000
  122  122 CL   CL    -5.26663   7.90000   4.60837 IONS  122  -1.00000
  123  123 CL   CL    -5.26663   7.90000  -8.55837 IONS  123  -1.00000
  124  124 CL   CL    -5.26663  -8.55837  -5.26663 IONS  124  -1.00000
  125  125 CL   CL    -5.26663  -8.55837   1.31663 IONS  125  -1.00000
  126  126 CL   CL    -5.26663  -8.55837   7.90000 IONS  126  -1.00000
  127  127 CL   CL    -1.97500  -5.26663  -5.26663 IONS  127  -1.00000
  128  128 CL   CL    -1.97500  -5.26663   1.31663 IONS  128  -1.00000
  129  129 CL   CL    -1.97500  -5.26663   7.90000 IONS  129  -1.00000
  130  130 CL   CL    -1.97500  -1.97500  -1.97500 IONS  130  -1.00000
  131  131 CL   CL    -1.97500  -1.97500   4.60837 IONS  131  -1.00000
  132  132 CL   CL    -1.97500  -1.97500  -8.55837 IONS  132  -1.00000
  133  133 CL   CL    -1.97500   1.31663  -5.26663 IONS  133  -1.00000
  134  134 CL   CL    -1.97500   1.31663   1.31663 IONS  134  -1.00000
  135  135 CL   CL    -1.97500   1.31663   7.90000 IONS  135  -1.00000
  136  136 CL   CL    -1.97500   4.60837  -1.97500 IONS  136  -1.00000
  137  137 CL   CL    -1.97500   4.60837   4.60837 IONS  137  -1.00000
  138  138 CL   CL    -1.97500   4.60837  -8.55837 IONS  138  -1.00000
  139  139 CL   CL    -1.97500   7.90000  -5.26663 IONS  139  -1.00000
  140  140 CL   CL    -1.97500   7.90000   1.31663 IONS  140  -1.00000
  141  141 CL   CL    -1.97500   7.90000   7.90000 IONS  141  -1.00000
  142  142 CL   CL    -1.97500  -8.55837  -1.97500 IONS  142  -1.00000
  143  143 CL   CL    -1.97500  -8.55837   4.60837 IONS  143  -1.00000
  144  144 CL   CL    -1.97500  -8.55837  -8.55837 IONS  144  -1.00000
  145  145 CL   CL     1.31663  -5.26663  -1.97500 IONS  145  -1.00000
  146  146 CL   CL     1.31663  -5.26663   4.60837 IONS  146  -1.00000
  147  147 CL   CL     1.31663  -5.26663  -8.55837 IONS  147  -1.00000
  148  148 CL   CL     1.31663  -1.97500  -5.26663 IONS  148  -1.00000
  149  149 CL   CL     1.31663  -1.97500   1.31663 IONS  149  -1.00000
  150  150 CL   CL     1.31663  -1.97500   7.90000 IONS  150  -1.00000
  151  151 CL   CL     1.31663   1.31663  -1.97500 IONS  151  -1.00000
  152  152 CL   CL     1.31663   1.31663   4.60837 IONS  152  -1.00000
  153  153 CL   CL     1.31663   1.31663  -8.55837 IONS  153  -1.00000
  154  154 CL   CL     1.31663   4.60837  -5.26663 IONS  154  -1.00000
  155  155 CL   CL     1.31663   4.60837   1.31663 IONS  155  -1.00000
  156  156 CL   CL     1.31663   4.60837   7.90000 IONS  156  -1.00000
  157  157 CL   CL     1.31663   7.90000  -1.97500 IONS  157  -1.00000
  158  158 CL   CL     1.31663   7.90000   4.60837 IONS  158  -1.00000
  159  159 CL   CL     1.31663   7.90000  -8.55837 IONS  159  -1.00000
  160  160 CL   CL     1.31663  -8.55837  -5.26663 IONS  160  -1.00000
  161  161 CL   CL     1.31663  -8.55837   1.31663 IONS  161  -1.00000
  162  162 CL   CL     1.31663  -8.55837   7.90000 IONS  162  -1.00000
  163  163 CL   CL     4.60837  -5.26663  -5.26663 IONS  163  -1.00000
  164  164 CL   CL     4.60837  -5.26663   1.31663 IONS  164  -1.00000
  165  165 CL   CL     4.60837  -5.26663   7.90000 IONS  165  -1.00000
  166  166 CL   CL     4.60837  -1.97500  -1.97500 IONS  166  -1.00000
  167  167 CL   CL     4.60837  -1.97500   4.60837 IONS  167  -1.00000
  168  168 CL   CL     4.60837  -1.97500  -8.55837 IONS  168  -1.00000
  169  169 CL   CL     4.60837   1.31663  -5.26663 IONS  169  -1.00000
  170  170 CL   CL     4.60837   1.31663   1.31663 IONS  170  -1.00000
  171  171 CL   CL     4.60837   1.31663   7.90000 IONS  171  -1.00000
  172  172 CL   CL     4.60837   4.60837  -1.97500 IONS  172  -1.00000
  173  173 CL   CL     4.60837   4.60837   4.60837 IONS  173  -1.00000
  174  174 CL   CL     4.60837   4.60837  -8.55837 IONS  174  -1.00000
  175  175 CL   CL     4.60837   7.90000  -5.26663 IONS  175  -1.00000
  176  176 CL   CL     4.60837   7.90000   1.31663 IONS  176  -1.00000
  177  177 CL   CL     4.60837   7.90000   7.90000 IONS  177  -1.00000
  178  178 CL   CL     4.60837  -8.55837  -1.97500 IONS  178  -1.00000
  179  179 CL   CL     4.60837  -8.55837   4.60837 IONS  179  -1.00000
  180  180 CL   CL     4.60837  -8.55837  -8.55837 IONS  180  -1.00000
  181  181 CL   CL     7.90000  -5.26663  -1.97500 IONS  181  -1.00000
  182  182 CL   CL     7.90000  -5.26663   4.60837 IONS  182  -1.00000
  183  183 CL   CL     7.90000  -5.26663  -8.55837 IONS  183  -1.00000
  184  184 CL   CL     7.90000  -1.97500  -5.26663 IONS  184  -1.00000
  185  185 CL   CL     7.90000  -1.97500   1.31663 IONS  185  -1.00000
  186  186 CL   CL     7.90000  -1.97500   7.90000 IONS  186  -1.00000
  187  187 CL   CL     7.90000   1.31663  -1.97500 IONS  187  -1.00000
  188  188 CL   CL     7.90000   1.31663   4.60837 IONS  188  -1.00000
  189  189 CL   CL     7.90000   1.31663  -8.55837 IONS  189  -1.00000
  190  190 CL   CL     7.90000   4.60837  -5.26663 IONS  190  -1.00000
  191  191 CL   CL     7.90000   4.60837   1.31663 IONS  191  -1.00000
  192  192 CL   CL     7.90000   4.60837   7.90000 IONS  192  -1.00000
  193  193 CL   CL     7.90000   7.90000  -1.97500 IONS  193  -1.00000
  194  194 CL   CL     7.90000   7.90000   4.60837 IONS  194  -1.00000
  195  195 CL   CL     7.90000   7.90000  -8.55837 IONS  195  -1.00000
  196  196 CL   CL     7.90000  -8.55837  -5.26663 IONS  196  -1.00000
  197  197 CL   CL     7.90000  -8.55837   1.31663 IONS  197  -1.00000
  198  198 CL   CL     7.90000  -8.55837   7.90000 IONS  198  -1.00000
  199  199 CL   CL    -8.55837  -5.26663  -5.26663 IONS  199  -1.00000
  200  200 CL   CL    -8.55837  -5.26663   1.31663 IONS  200  -1.00000
  201  201 CL   CL    -8.55837  -5.26663   7.90000 IONS  201  -1.00000
  202  202 CL   CL    -8.55837  -1.97500  -1.97500 IONS  202  -1.00000
  203  203 CL   CL    -8.55837  -1.97500   4.60837 IONS  203  -1.00000
  204  204 CL   CL    -8.55837  -1.97500  -8.55837 IONS  204  -1.00000
  205  205 CL   CL    -8.55837   1.31663  -5.26663 IONS  205  -1.00000
  206  206 CL   CL    -8.55837   1.31663   1.31663 IONS  206  -1.00000
  207  207 CL   CL    -8.55837   1.31663   7.90000 IONS  207  -1.00000
  208  208 CL   CL    -8.55837   4.60837  -1.97500 IONS  208  -1.00000
  209  209 CL   CL    -8.55837   4.60837   4.60837 IONS  209  -1.00000
  210  210 CL   CL    -8.55837   4.60837  -8.55837 IONS  210  -1.00000
  211  211 CL   CL    -8.55837   7.90000  -5.26663 IONS  211  -1.00000
  212  212 CL   CL    -8.55837   7.90000   1.31663 IONS  212  -1.00000
  213  213 CL   CL    -8.55837   7.90000   7.90000 IONS  213  -1.00000
  214  214 CL   CL    -8.55837  -8.55837  -1.97500 IONS  214  -1.00000
  215  215 CL   CL    -8.55837  -8.55837   4.60837 IONS  215  -1.00000
  216  216 CL   CL    -8.55837  -8.55837  -8.55837 IONS  216  -1.00000


! images translation vector 
SET 6 19.75 
! Open and read the image transformation file for creating
! 26 image objects around the primary structure

CRYSTAL DEFINE CUBIC @6 @6 @6 90.0 90.0 90.0
CRYSTAL BUILD CUTOFF 18.0 NOPERATIONS 0
IMAGE BYGROUPS XCEN 0.0 YCEN 0.0 ZCEN 0.0 SELE ALL END

set tt 1
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!! Slow routines
FASTER OFF
! To obtain the correct Madelung Constant,
! the energy should be: -19036.56 kcal/mol
set sp slow
ENERGY IMGFRQ 1 INBFRQ 1 CUTNB 12.0 SWITCH VSWITCH  CTONNB 9.875 CTOFNB 9.875 -
       CUTIM 12.0 EWALD KAPPA 0.283544304 WMIN 0.1
set refval -19036.36787
@testcheck ?ener  @refval .000001 @testname_e_@tt_@sp
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!! Fast scalar routines
FASTER ON
! To obtain the correct Madelung Constant,
! the energy should be: -19036.56 kcal/mol
ENERGY IMGFRQ 1 INBFRQ 1 CUTNB 12.0 SWITCH VSWITCH  CTONNB 9.875 CTOFNB 9.875 -
       CUTIM 12.0 EWALD KAPPA 0.283544304 WMIN 0.1
set sp fast
@testcheck ?ener  @refval .000001 @testname_e_@tt_@sp
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

STOP
