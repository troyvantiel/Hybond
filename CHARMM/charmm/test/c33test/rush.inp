* testing the RUSH force field
* 1) test individual components of energy
* 2) do a steepest descent minimization
* 3) check minimized energy
* 4) turn rush off
***
* Olgun Guvench, Dec 9, 2005
*  

  if ?rush .ne. 1 then
     echo "Test NOT performed"
     stop
  endif
  if ?numnode .gt. 1 then
     echo "Not parallel: Test NOT performed"
     stop
  endif

  bomlev 1

  stream datadir.def

  set PDB 1le1
  set maxdiff 0.0001

  open unit 1 read form name @0top_rush_058.inp
  read rtf card unit 1
  close unit 1

  open unit 1 read form name @0par_rush_058.inp
  read param card unit 1
  close unit 1

  open unit 1 read form name @0par_rush_058_a.cmap
  read param append card unit 1
  close unit 1

  read sequ card
  * tripzip2 (pdb id 1le1)
  *
  12
  SER TRP THR TRP GLU ASN GLY
  LYS TRP THR TRP LYS

  gene @PDB first NTER last CT2

  read coor card
  * tripzip2 (pdb id 1le1)
  *
  223
    1    1 SER  N     -2.55900   9.05500   0.07700 1LE1 1      0.00000
    2    1 SER  HT1   -2.92700  10.01400   0.24300 1LE1 1      0.00000
    3    1 SER  HT2   -2.74500   8.77900  -0.90800 1LE1 1      0.00000
    4    1 SER  HT3   -1.53400   9.04100   0.25400 1LE1 1      0.00000
    5    1 SER  CA    -3.23100   8.10400   0.99100 1LE1 1      0.00000
    6    1 SER  HA    -3.03100   8.42800   2.00300 1LE1 1      0.00000
    7    1 SER  CB    -4.74900   8.12400   0.77000 1LE1 1      0.00000
    8    1 SER  HB1   -5.13200   9.16400   0.84400 1LE1 1      0.00000
    9    1 SER  HB2   -5.00100   7.71100  -0.23000 1LE1 1      0.00000
   10    1 SER  OG    -5.36700   7.33800   1.77500 1LE1 1      0.00000
   11    1 SER  HG1   -6.31100   7.38000   1.60100 1LE1 1      0.00000
   12    1 SER  HG2   -5.93500   7.96200   0.85300 1LE1 1      0.00000
   13    1 SER  C     -2.73300   6.69500   0.80100 1LE1 1      0.00000
   14    1 SER  O     -2.63900   6.19200  -0.31700 1LE1 1      0.00000
   15    2 TRP  N     -2.40500   6.01100   1.91300 1LE1 2      0.00000
   16    2 TRP  HN    -2.44800   6.42500   2.81800 1LE1 2      0.00000
   17    2 TRP  CA    -2.06000   4.60900   1.87600 1LE1 2      0.00000
   18    2 TRP  HA    -1.47900   4.40900   0.98700 1LE1 2      0.00000
   19    2 TRP  CB    -1.18400   4.22600   3.08600 1LE1 2      0.00000
   20    2 TRP  HB1   -1.69500   4.54000   4.02200 1LE1 2      0.00000
   21    2 TRP  HB2   -1.07200   3.12000   3.09900 1LE1 2      0.00000
   22    2 TRP  CG     0.21800   4.82500   3.05400 1LE1 2      0.00000
   23    2 TRP  CD1    0.69000   5.85200   3.81800 1LE1 2      0.00000
   24    2 TRP  HD1    0.09900   6.41500   4.53000 1LE1 2      0.00000
   25    2 TRP  NE1    2.03900   6.03800   3.57900 1LE1 2      0.00000
   26    2 TRP  HE1    2.58300   6.74000   3.98900 1LE1 2      0.00000
   27    2 TRP  CE2    2.47800   5.08700   2.66500 1LE1 2      0.00000
   28    2 TRP  CD2    1.35600   4.35000   2.27200 1LE1 2      0.00000
   29    2 TRP  CE3    1.48700   3.35500   1.32400 1LE1 2      0.00000
   30    2 TRP  HE3    0.62700   2.80000   0.98300 1LE1 2      0.00000
   31    2 TRP  CZ3    2.75400   3.06000   0.81700 1LE1 2      0.00000
   32    2 TRP  HZ3    2.87600   2.25900   0.09300 1LE1 2      0.00000
   33    2 TRP  CZ2    3.74200   4.80400   2.15900 1LE1 2      0.00000
   34    2 TRP  HZ2    4.62100   5.34900   2.47900 1LE1 2      0.00000
   35    2 TRP  CH2    3.87500   3.76400   1.24000 1LE1 2      0.00000
   36    2 TRP  HH2    4.85400   3.50200   0.84500 1LE1 2      0.00000
   37    2 TRP  C     -3.32900   3.75600   1.82500 1LE1 2      0.00000
   38    2 TRP  O     -4.24500   3.93600   2.62600 1LE1 2      0.00000
   39    3 THR  N     -3.40100   2.80200   0.85600 1LE1 3      0.00000
   40    3 THR  HN    -2.65900   2.69400   0.19900 1LE1 3      0.00000
   41    3 THR  CA    -4.48600   1.83400   0.70600 1LE1 3      0.00000
   42    3 THR  HA    -5.08700   1.81600   1.60600 1LE1 3      0.00000
   43    3 THR  CB    -5.39400   2.19300  -0.46700 1LE1 3      0.00000
   44    3 THR  HB    -4.80000   2.23800  -1.40100 1LE1 3      0.00000
   45    3 THR  OG1   -5.96100   3.47400  -0.23900 1LE1 3      0.00000
   46    3 THR  HG11  -6.35600   3.73700  -1.07400 1LE1 3      0.00000
   47    3 THR  HG12  -6.10200   2.76400  -1.25800 1LE1 3      0.00000
   48    3 THR  CG2   -6.55100   1.19900  -0.65400 1LE1 3      0.00000
   49    3 THR  HG21  -7.18800   1.50600  -1.51000 1LE1 3      0.00000
   50    3 THR  HG22  -6.15500   0.18100  -0.85300 1LE1 3      0.00000
   51    3 THR  HG23  -7.17900   1.16300   0.26100 1LE1 3      0.00000
   52    3 THR  C     -3.86000   0.44800   0.55300 1LE1 3      0.00000
   53    3 THR  O     -2.73200   0.30900   0.07900 1LE1 3      0.00000
   54    4 TRP  N     -4.57100  -0.60900   1.02000 1LE1 4      0.00000
   55    4 TRP  HN    -5.48400  -0.48400   1.40000 1LE1 4      0.00000
   56    4 TRP  CA    -4.07200  -1.97200   1.06400 1LE1 4      0.00000
   57    4 TRP  HA    -3.00300  -1.94500   1.22100 1LE1 4      0.00000
   58    4 TRP  CB    -4.72000  -2.76100   2.22500 1LE1 4      0.00000
   59    4 TRP  HB1   -4.41500  -2.29100   3.18500 1LE1 4      0.00000
   60    4 TRP  HB2   -5.82400  -2.66900   2.13000 1LE1 4      0.00000
   61    4 TRP  CG    -4.40100  -4.24400   2.29400 1LE1 4      0.00000
   62    4 TRP  CD1   -5.17200  -5.24500   1.78900 1LE1 4      0.00000
   63    4 TRP  HD1   -6.08700  -5.09200   1.22800 1LE1 4      0.00000
   64    4 TRP  NE1   -4.63900  -6.47200   2.13000 1LE1 4      0.00000
   65    4 TRP  HE1   -5.04400  -7.33300   1.90200 1LE1 4      0.00000
   66    4 TRP  CE2   -3.48800  -6.27700   2.88400 1LE1 4      0.00000
   67    4 TRP  CD2   -3.29000  -4.89600   2.97700 1LE1 4      0.00000
   68    4 TRP  CE3   -2.19000  -4.40600   3.64800 1LE1 4      0.00000
   69    4 TRP  HE3   -2.00800  -3.34500   3.70500 1LE1 4      0.00000
   70    4 TRP  CZ3   -1.30200  -5.30100   4.24600 1LE1 4      0.00000
   71    4 TRP  HZ3   -0.42800  -4.92100   4.76900 1LE1 4      0.00000
   72    4 TRP  CZ2   -2.62100  -7.17400   3.49300 1LE1 4      0.00000
   73    4 TRP  HZ2   -2.78200  -8.24400   3.44500 1LE1 4      0.00000
   74    4 TRP  CH2   -1.52300  -6.67100   4.18900 1LE1 4      0.00000
   75    4 TRP  HH2   -0.82700  -7.34800   4.68100 1LE1 4      0.00000
   76    4 TRP  C     -4.33100  -2.72800  -0.21900 1LE1 4      0.00000
   77    4 TRP  O     -5.45600  -2.80900  -0.71400 1LE1 4      0.00000
   78    5 GLU  N     -3.25600  -3.34500  -0.75800 1LE1 5      0.00000
   79    5 GLU  HN    -2.35300  -3.27800  -0.34100 1LE1 5      0.00000
   80    5 GLU  CA    -3.33400  -4.14600  -1.94600 1LE1 5      0.00000
   81    5 GLU  HA    -4.36100  -4.46300  -2.06700 1LE1 5      0.00000
   82    5 GLU  CB    -2.93200  -3.30400  -3.17900 1LE1 5      0.00000
   83    5 GLU  HB1   -3.57300  -2.39500  -3.20700 1LE1 5      0.00000
   84    5 GLU  HB2   -1.87800  -2.97300  -3.05800 1LE1 5      0.00000
   85    5 GLU  CG    -3.07300  -4.03500  -4.51700 1LE1 5      0.00000
   86    5 GLU  HG1   -2.41200  -4.92700  -4.54800 1LE1 5      0.00000
   87    5 GLU  HG2   -4.12700  -4.36200  -4.65100 1LE1 5      0.00000
   88    5 GLU  CD    -2.69900  -3.07900  -5.64400 1LE1 5      0.00000
   89    5 GLU  OE1   -3.63400  -2.58100  -6.32600 1LE1 5      0.00000
   90    5 GLU  OE2   -1.47800  -2.83700  -5.83700 1LE1 5      0.00000
   91    5 GLU  C     -2.42200  -5.35700  -1.74500 1LE1 5      0.00000
   92    5 GLU  O     -1.23300  -5.21400  -1.46200 1LE1 5      0.00000
   93    6 ASN  N     -2.99800  -6.57800  -1.86400 1LE1 6      0.00000
   94    6 ASN  HN    -3.97700  -6.63400  -2.04400 1LE1 6      0.00000
   95    6 ASN  CA    -2.35200  -7.88000  -1.83000 1LE1 6      0.00000
   96    6 ASN  HA    -3.07400  -8.56900  -1.40700 1LE1 6      0.00000
   97    6 ASN  CB    -2.06900  -8.36400  -3.27400 1LE1 6      0.00000
   98    6 ASN  HB1   -1.30100  -7.71000  -3.73800 1LE1 6      0.00000
   99    6 ASN  HB2   -1.68200  -9.40400  -3.24900 1LE1 6      0.00000
  100    6 ASN  CG    -3.33900  -8.32600  -4.14600 1LE1 6      0.00000
  101    6 ASN  OD1   -4.45600  -8.06200  -3.69300 1LE1 6      0.00000
  102    6 ASN  ND2   -3.15100  -8.60600  -5.46700 1LE1 6      0.00000
  103    6 ASN  HD21  -3.92800  -8.60100  -6.09500 1LE1 6      0.00000
  104    6 ASN  HD22  -2.23400  -8.81700  -5.80700 1LE1 6      0.00000
  105    6 ASN  C     -1.09800  -7.99100  -0.95800 1LE1 6      0.00000
  106    6 ASN  O      0.01100  -8.19300  -1.45400 1LE1 6      0.00000
  107    7 GLY  N     -1.26000  -7.91400   0.38600 1LE1 7      0.00000
  108    7 GLY  HN    -2.15400  -7.75500   0.79800 1LE1 7      0.00000
  109    7 GLY  CA    -0.16300  -8.09600   1.31400 1LE1 7      0.00000
  110    7 GLY  HA1    0.49900  -8.82300   0.86900 1LE1 7      0.00000
  111    7 GLY  HA2   -0.59900  -8.43100   2.24400 1LE1 7      0.00000
  112    7 GLY  C      0.64200  -6.83800   1.59900 1LE1 7      0.00000
  113    7 GLY  O      1.55900  -6.88700   2.41900 1LE1 7      0.00000
  114    8 LYS  N      0.33800  -5.69300   0.93500 1LE1 8      0.00000
  115    8 LYS  HN    -0.41900  -5.64300   0.28800 1LE1 8      0.00000
  116    8 LYS  CA     1.13900  -4.48900   1.07100 1LE1 8      0.00000
  117    8 LYS  HA     1.68900  -4.54000   2.00100 1LE1 8      0.00000
  118    8 LYS  CB     2.13800  -4.37500  -0.10400 1LE1 8      0.00000
  119    8 LYS  HB1    2.25600  -5.37500  -0.57700 1LE1 8      0.00000
  120    8 LYS  HB2    1.70800  -3.68900  -0.86500 1LE1 8      0.00000
  121    8 LYS  CG     3.53100  -3.88000   0.30800 1LE1 8      0.00000
  122    8 LYS  HG1    4.07300  -3.54100  -0.60300 1LE1 8      0.00000
  123    8 LYS  HG2    3.41800  -3.00500   0.98500 1LE1 8      0.00000
  124    8 LYS  CD     4.38500  -4.95900   0.99100 1LE1 8      0.00000
  125    8 LYS  HD1    3.82600  -5.39600   1.84700 1LE1 8      0.00000
  126    8 LYS  HD2    4.58600  -5.76800   0.25600 1LE1 8      0.00000
  127    8 LYS  CE     5.71500  -4.38800   1.49300 1LE1 8      0.00000
  128    8 LYS  HE1    6.19700  -3.79000   0.69000 1LE1 8      0.00000
  129    8 LYS  HE2    5.55900  -3.74600   2.38500 1LE1 8      0.00000
  130    8 LYS  NZ     6.65700  -5.46800   1.85700 1LE1 8      0.00000
  131    8 LYS  HZ1    7.55300  -5.05200   2.18200 1LE1 8      0.00000
  132    8 LYS  HZ2    6.24600  -6.04500   2.61800 1LE1 8      0.00000
  133    8 LYS  HZ3    6.83500  -6.06700   1.02600 1LE1 8      0.00000
  134    8 LYS  C      0.27700  -3.23100   1.10700 1LE1 8      0.00000
  135    8 LYS  O     -0.92500  -3.25700   0.84500 1LE1 8      0.00000
  136    9 TRP  N      0.90900  -2.08000   1.43400 1LE1 9      0.00000
  137    9 TRP  HN     1.87200  -2.08000   1.69300 1LE1 9      0.00000
  138    9 TRP  CA     0.30600  -0.77000   1.32400 1LE1 9      0.00000
  139    9 TRP  HA    -0.76400  -0.85700   1.20900 1LE1 9      0.00000
  140    9 TRP  CB     0.57600   0.09500   2.58000 1LE1 9      0.00000
  141    9 TRP  HB1    1.67100   0.14300   2.75600 1LE1 9      0.00000
  142    9 TRP  HB2    0.20600   1.12400   2.37900 1LE1 9      0.00000
  143    9 TRP  CG    -0.10700  -0.40000   3.85200 1LE1 9      0.00000
  144    9 TRP  CD1    0.48000  -1.08000   4.87600 1LE1 9      0.00000
  145    9 TRP  HD1    1.52200  -1.37600   4.90300 1LE1 9      0.00000
  146    9 TRP  NE1   -0.44200  -1.31900   5.87700 1LE1 9      0.00000
  147    9 TRP  HE1   -0.24900  -1.80400   6.70400 1LE1 9      0.00000
  148    9 TRP  CE2   -1.65800  -0.74500   5.52700 1LE1 9      0.00000
  149    9 TRP  CD2   -1.49100  -0.17700   4.26000 1LE1 9      0.00000
  150    9 TRP  CE3   -2.54700   0.47800   3.66000 1LE1 9      0.00000
  151    9 TRP  HE3   -2.43200   0.93900   2.69200 1LE1 9      0.00000
  152    9 TRP  CZ3   -3.76400   0.57400   4.33700 1LE1 9      0.00000
  153    9 TRP  HZ3   -4.59400   1.10500   3.87800 1LE1 9      0.00000
  154    9 TRP  CZ2   -2.86700  -0.65700   6.20600 1LE1 9      0.00000
  155    9 TRP  HZ2   -3.00100  -1.08400   7.19300 1LE1 9      0.00000
  156    9 TRP  CH2   -3.92400   0.01800   5.60000 1LE1 9      0.00000
  157    9 TRP  HH2   -4.87800   0.11800   6.11400 1LE1 9      0.00000
  158    9 TRP  C      0.88900  -0.10700   0.08100 1LE1 9      0.00000
  159    9 TRP  O      2.09300  -0.19000  -0.16000 1LE1 9      0.00000
  160   10 THR  N      0.03400   0.56000  -0.74200 1LE1 10     0.00000
  161   10 THR  HN    -0.94600   0.58100  -0.56100 1LE1 10     0.00000
  162   10 THR  CA     0.47100   1.36700  -1.87200 1LE1 10     0.00000
  163   10 THR  HA     1.54700   1.48000  -1.81200 1LE1 10     0.00000
  164   10 THR  CB     0.20000   0.72700  -3.23500 1LE1 10     0.00000
  165   10 THR  HB     0.69500  -0.26800  -3.26200 1LE1 10     0.00000
  166   10 THR  OG1    0.77100   1.52300  -4.25700 1LE1 10     0.00000
  167   10 THR  HG11   0.76500   0.97800  -5.04700 1LE1 10     0.00000
  168   10 THR  HG12   0.21500   0.41200  -4.39600 1LE1 10     0.00000
  169   10 THR  CG2   -1.29000   0.52400  -3.55400 1LE1 10     0.00000
  170   10 THR  HG21  -1.40800   0.04500  -4.54900 1LE1 10     0.00000
  171   10 THR  HG22  -1.76200  -0.12800  -2.78800 1LE1 10     0.00000
  172   10 THR  HG23  -1.81700   1.50100  -3.56400 1LE1 10     0.00000
  173   10 THR  C     -0.10900   2.77100  -1.72900 1LE1 10     0.00000
  174   10 THR  O     -1.17000   2.96600  -1.13600 1LE1 10     0.00000
  175   11 TRP  N      0.63200   3.79400  -2.22100 1LE1 11     0.00000
  176   11 TRP  HN     1.49000   3.62300  -2.69900 1LE1 11     0.00000
  177   11 TRP  CA     0.29000   5.19500  -2.05900 1LE1 11     0.00000
  178   11 TRP  HA    -0.25600   5.30900  -1.13400 1LE1 11     0.00000
  179   11 TRP  CB     1.57400   6.06000  -1.95000 1LE1 11     0.00000
  180   11 TRP  HB1    2.17800   5.67300  -1.10000 1LE1 11     0.00000
  181   11 TRP  HB2    2.16500   5.92800  -2.88100 1LE1 11     0.00000
  182   11 TRP  CG     1.37500   7.54800  -1.73100 1LE1 11     0.00000
  183   11 TRP  CD1    1.53600   8.49900  -2.69100 1LE1 11     0.00000
  184   11 TRP  HD1    1.80500   8.29100  -3.72000 1LE1 11     0.00000
  185   11 TRP  NE1    1.31100   9.75100  -2.15900 1LE1 11     0.00000
  186   11 TRP  HE1    1.39200  10.58700  -2.66000 1LE1 11     0.00000
  187   11 TRP  CE2    0.97900   9.62800  -0.81600 1LE1 11     0.00000
  188   11 TRP  CD2    1.01200   8.26300  -0.51000 1LE1 11     0.00000
  189   11 TRP  CE3    0.71000   7.84400   0.77100 1LE1 11     0.00000
  190   11 TRP  HE3    0.70400   6.79600   1.02700 1LE1 11     0.00000
  191   11 TRP  CZ3    0.38900   8.79600   1.74200 1LE1 11     0.00000
  192   11 TRP  HZ3    0.15100   8.47700   2.75300 1LE1 11     0.00000
  193   11 TRP  CZ2    0.65700  10.57900   0.14300 1LE1 11     0.00000
  194   11 TRP  HZ2    0.63600  11.63700  -0.09000 1LE1 11     0.00000
  195   11 TRP  CH2    0.36600  10.15100   1.43500 1LE1 11     0.00000
  196   11 TRP  HH2    0.12000  10.87600   2.20900 1LE1 11     0.00000
  197   11 TRP  C     -0.61500   5.64100  -3.19800 1LE1 11     0.00000
  198   11 TRP  O     -0.17100   5.87900  -4.32100 1LE1 11     0.00000
  199   12 LYS  N     -1.93400   5.74200  -2.90100 1LE1 12     0.00000
  200   12 LYS  HN    -2.25600   5.54600  -1.97800 1LE1 12     0.00000
  201   12 LYS  CA    -2.98300   6.09900  -3.83400 1LE1 12     0.00000
  202   12 LYS  HA    -2.62700   5.99600  -4.84900 1LE1 12     0.00000
  203   12 LYS  CB    -4.24400   5.22600  -3.63000 1LE1 12     0.00000
  204   12 LYS  HB1   -4.60000   5.35900  -2.58500 1LE1 12     0.00000
  205   12 LYS  HB2   -5.04500   5.58200  -4.31300 1LE1 12     0.00000
  206   12 LYS  CG    -4.01300   3.72100  -3.88300 1LE1 12     0.00000
  207   12 LYS  HG1   -3.18000   3.38600  -3.22600 1LE1 12     0.00000
  208   12 LYS  HG2   -4.92600   3.15700  -3.59400 1LE1 12     0.00000
  209   12 LYS  CD    -3.66000   3.37800  -5.34000 1LE1 12     0.00000
  210   12 LYS  HD1   -2.83800   4.05100  -5.67000 1LE1 12     0.00000
  211   12 LYS  HD2   -3.29000   2.33100  -5.39300 1LE1 12     0.00000
  212   12 LYS  CE    -4.84900   3.52500  -6.29700 1LE1 12     0.00000
  213   12 LYS  HE1   -5.58100   2.70400  -6.15100 1LE1 12     0.00000
  214   12 LYS  HE2   -5.35200   4.50200  -6.13000 1LE1 12     0.00000
  215   12 LYS  NZ    -4.39400   3.50100  -7.70400 1LE1 12     0.00000
  216   12 LYS  HZ1   -5.21300   3.61300  -8.33500 1LE1 12     0.00000
  217   12 LYS  HZ2   -3.72300   4.27900  -7.86500 1LE1 12     0.00000
  218   12 LYS  HZ3   -3.92600   2.59400  -7.90200 1LE1 12     0.00000
  219   12 LYS  C     -3.36400   7.57300  -3.62000 1LE1 12     0.00000
  220   12 LYS  O     -3.58900   8.03700  -2.49800 1LE1 12     0.00000
  221   12 LYS  NT    -3.41400   8.32300  -4.76400 1LE1 12     0.00000
  222   12 LYS  HT1   -3.64800   9.29400  -4.71500 1LE1 12     0.00000
  223   12 LYS  HT2   -3.21500   7.90000  -5.64800 1LE1 12     0.00000
  

! print out default parameters
  rush

  skipe all excl bond angl urey dihe impr rrep rpho rhbn rbdo rbac raro cmap
  energy
  format (f12.5)
  calc ediff abs( ?ener - 266.51111 )
  if @ediff .gt. @maxdiff goto makeerror

! test reading of custom parameters
  rush PHOB 0.00070  HBND -5.0  BDON 0.05  BACC 0.05 -
       KARO 1.0       CARO 6.0  DRMX 0.75

  energy
  calc ediff abs( ?ener - 266.09129 )
  if @ediff .gt. @maxdiff goto makeerror

  test first step 0.001

  skipe all excl rrep 
  energy
  calc ediff abs( ?ener - 107.66840 )
  if @ediff .gt. @maxdiff goto makeerror

  skipe all excl rpho 
  energy
  calc ediff abs( ?ener - 71.03688 )
  if @ediff .gt. @maxdiff goto makeerror

  skipe all excl rhbn 
  energy
  calc ediff abs( ?ener - ( -29.72573 ) )
  if @ediff .gt. @maxdiff goto makeerror

  skipe all excl rbdo 
  energy
  calc ediff abs( ?ener - 5.49530 )
  if @ediff .gt. @maxdiff goto makeerror

  skipe all excl rbac 
  energy
  calc ediff abs( ?ener - 2.54768 )
  if @ediff .gt. @maxdiff goto makeerror

  skipe all excl raro 
  energy
  calc ediff abs( ?ener - ( -0.59331 ) )
  if @ediff .gt. @maxdiff goto makeerror

  skipe all excl bond angl urey dihe impr rrep rpho rhbn rbdo rbac raro cmap
  energy
  calc ediff abs( ?ener - 266.09129 )
  if @ediff .gt. @maxdiff goto makeerror

  minimize sd nstep 100 tolgrd 0.1 nprint 100
  energy
  calc ediff abs( ?ener - 246.36486 )
  if @ediff .gt. @maxdiff goto makeerror

  rush off

  stop

  label makeerror

  write title unit 6
  * @foo
  *
