     Combining Cartesian and IC interpolation with sidechain shrinking.

            By Stefan Fischer & Fabian Ille, Oct. 16-2001.
             Last modification: S.Fischer, June 29-2006

============================================================================

Abstract: A method for generating an initial path for CPR.
**********************************************************
This approach has been described in detail in Proteins 59, p.534-544 (2005).


The initial path (i.e., a series of transition intermediates) that is to
be refined by CPR is generated by interpolation between the Internal
Coordinates (IC) of the reactant and product end-states
(rather than the default interpolation in Cartesian coordinates).
Interpolation in IC describes well the torsional transitions
between rotameric states of the sidechains. However, when IC-interpolation is
applied to the backbone-torsion angles, it can lead to severe disruption of
the backbone fold. In contrast, Cartesian interpolation approximately preserves
the backbone fold in most cases (if the protein remains compact during the
transition), but often leads to extreme deformation of the sidechains.
Therefore, the two interpolation methods are combined here:
First, the backbone atoms are interpolated in Cartesian coordinates
so as to preserve the backbone fold, and then the sidechain atoms are
built onto the interpolated backbone, using IC that are interpolated between
the values of the end-states.

The initial path build by this "combined interpolation" can be further
improved, so as to avoid unrealistic events such as bond-crossing
or ring-penetration. These can be effectively avoided by shrinking all
the sidechains in each intermediate point of the initial path.
This is achieved by reducing all bond lengths of the sidechains
(for ex. to half the original size) before building them onto the backbone.
At first glance, this approach would seem to be unphysical and
would result in energetically unfavorable paths. However, the minimization
process applied to the path-points during the CPR procedure rapidly
restores the shrunken sidechains to their normal size, while undesirable
events no longer occur in the resulting path.

============================================================================

vector.pl
*********

For both the combined interpolation and the shrinking, a PERL script called
"vector.pl" is called from the CHARMM-script (see below).

vector.pl reads two IC tables from CHARMM and calculates the shortest change
between each pair of torsion-angles in these IC-tables, for ex. -120 --> +120 :
delta(angle) = 120 (and not 240).
It writes out the resulting delta(angles) in an IC table, which can then
be read into CHARMM. The usage of the program is displayed when executing it
without any parameter or with the parameter -h.


============================================================================

The CHARMM-scripts:
*******************

comb_interpol.inp
-----------------
Is the main CHARMM input-file.
Calls - user_def.str
      - vector.pl
      - mini_interpol.str  (optional)
      - make_traj.str      (optional)

user_def.str
------------
Here, the user must define all necessary settings.


mini_interpol.str
-----------------
Optional, use only if CPR cannot deal with un-minimized initial intermediates.
If requested, it is called at the end of comb_interpol.inp.
Does a quick and constrained minimization of each frame.


make_traj.inp
-------------
Creates a CHARMM trajectory from the interpolated frames
for viewing in VMD.

An example of the resulting initial path (4 intermediates, shrinking to 50%)
is available under ./frames/ . It is in the format of a CHARMM dcd
(viewable by VMD):  interpol_comb_4_steps.dcd
                    interpol_comb_4_steps.dcd.pdb  (the reactant structure).

============================================================================

Notes :
*******

If there are no fixed atoms, then the product state is "COOR ORIENTed" upon
the reactant state.

When doing CPR on the so-obtained initial path, to avoid that many of
the initial intermediate path-points are deleted right away by CPR,
use a larger value of INTERpol for a ~500 CPR-cycles, for ex.:

        CPR NCYCLE 500 INTER 10 ...

============================================================================
